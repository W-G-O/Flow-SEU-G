{"episode_reward_max": -97.35338639759378, "episode_reward_min": -128.89994782824718, "episode_reward_mean": -110.25362251577992, "episode_len_mean": 485.5, "episodes_this_iter": 4, "policy_reward_min": {"cav": 6.53868099837752, "tl": -11.311022364890187}, "policy_reward_max": {"cav": 7.0106320264966415, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 6.841144117175371, "tl": -9.757897219412937}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 20.58921550532565, "mean_processing_ms": 6.1547993511893, "mean_inference_ms": 0.9778060384145886}, "off_policy_estimator": {}, "info": {"num_steps_trained": 211200, "num_steps_sampled": 17600, "sample_time_ms": 54676.994, "load_time_ms": 244.982, "grad_time_ms": 21288.326, "update_time_ms": 1873.203, "learner": {"cav": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 7.566125392913818, "policy_loss": -0.003998773172497749, "vf_loss": 7.569833278656006, "vf_explained_var": -0.004645235370844603, "kl": 0.00145887047983706, "entropy": 1.433344841003418, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0229675080627203, "policy_loss": -0.00018000483396463096, "vf_loss": 0.023089516907930374, "vf_explained_var": 0.007403326220810413, "kl": 0.00028998652123846114, "entropy": 1.386020302772522, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 17600, "episodes_total": 4, "training_iteration": 1, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_17-57-59", "timestamp": 1714557479, "time_this_iter_s": 78.24225378036499, "time_total_s": 78.24225378036499, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218abe60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 78.24225378036499, "timesteps_since_restore": 17600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.34867256637169, "ram_util_percent": 58.5637168141593}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -97.35338639759378, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -352.1126577222727, "episode_len_mean": 2393.909090909091, "episodes_this_iter": 7, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 344.8413965467018, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 190.72929510111092, "tl": -45.23682940194869}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 20.30513028605995, "mean_processing_ms": 4.531857198231237, "mean_inference_ms": 0.96677828974403}, "off_policy_estimator": {}, "info": {"num_steps_trained": 422400, "num_steps_sampled": 35200, "sample_time_ms": 56050.642, "load_time_ms": 168.783, "grad_time_ms": 20600.788, "update_time_ms": 938.483, "learner": {"cav": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.03402328491211, "policy_loss": -0.0013497358886525035, "vf_loss": 9.035300254821777, "vf_explained_var": -0.004969385452568531, "kl": 0.0007164602866396308, "entropy": 1.4307600259780884, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02704538218677044, "policy_loss": -0.00017893502081278712, "vf_loss": 0.02717943675816059, "vf_explained_var": 0.006661823019385338, "kl": 0.000448844424681738, "entropy": 1.3848326206207275, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 35200, "episodes_total": 11, "training_iteration": 2, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_17-59-17", "timestamp": 1714557557, "time_this_iter_s": 77.46470236778259, "time_total_s": 155.70695614814758, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f605f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 155.70695614814758, "timesteps_since_restore": 35200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.88, "ram_util_percent": 73.41636363636367}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -97.35338639759378, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -366.9383231533987, "episode_len_mean": 2486.0833333333335, "episodes_this_iter": 1, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 344.8413965467018, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 197.20404902684615, "tl": -47.01186434835378}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 20.28373346238806, "mean_processing_ms": 4.542449779587114, "mean_inference_ms": 0.9653977270504162}, "off_policy_estimator": {}, "info": {"num_steps_trained": 633600, "num_steps_sampled": 52800, "sample_time_ms": 53687.236, "load_time_ms": 147.487, "grad_time_ms": 20695.528, "update_time_ms": 626.939, "learner": {"cav": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 14.546707153320312, "policy_loss": -0.0016766212647780776, "vf_loss": 14.548314094543457, "vf_explained_var": -0.0013834194978699088, "kl": 0.001362970913760364, "entropy": 1.4350873231887817, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01872946135699749, "policy_loss": -0.0001824781356845051, "vf_loss": 0.018869172781705856, "vf_explained_var": 0.014566724188625813, "kl": 0.0008552870131097734, "entropy": 1.3817678689956665, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 52800, "episodes_total": 12, "training_iteration": 3, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-00-27", "timestamp": 1714557627, "time_this_iter_s": 69.98413133621216, "time_total_s": 225.69108748435974, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e6ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 225.69108748435974, "timesteps_since_restore": 52800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.549, "ram_util_percent": 76.20999999999998}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -97.35338639759378, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -366.1240983113315, "episode_len_mean": 2891.65, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 455.59757168793453, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 272.62352729600946, "tl": -53.22896880061159}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.989659320263986, "mean_processing_ms": 4.154336011240245, "mean_inference_ms": 0.9610381152634538}, "off_policy_estimator": {}, "info": {"num_steps_trained": 844800, "num_steps_sampled": 70400, "sample_time_ms": 54547.366, "load_time_ms": 135.86, "grad_time_ms": 20680.842, "update_time_ms": 471.319, "learner": {"cav": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 25.1970272064209, "policy_loss": -0.0035106665454804897, "vf_loss": 25.200498580932617, "vf_explained_var": -0.00028803054010495543, "kl": 0.0015974142588675022, "entropy": 1.4394696950912476, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03728349506855011, "policy_loss": -0.0002290237316628918, "vf_loss": 0.037491943687200546, "vf_explained_var": 0.01946282759308815, "kl": 0.0008227979997172952, "entropy": 1.3813542127609253, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 70400, "episodes_total": 20, "training_iteration": 4, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-01-45", "timestamp": 1714557705, "time_this_iter_s": 77.89939379692078, "time_total_s": 303.5904812812805, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f60dd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 303.5904812812805, "timesteps_since_restore": 70400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.06576576576576, "ram_util_percent": 76.68018018018022}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -97.35338639759378, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -339.08426750546283, "episode_len_mean": 3049.3703703703704, "episodes_this_iter": 7, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 492.67794756307745, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 319.6182440205785, "tl": -54.89187596050333}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.810782106440296, "mean_processing_ms": 4.05723673602838, "mean_inference_ms": 0.9568002504712717}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1056000, "num_steps_sampled": 88000, "sample_time_ms": 55110.472, "load_time_ms": 127.678, "grad_time_ms": 20634.954, "update_time_ms": 377.803, "learner": {"cav": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 45.120845794677734, "policy_loss": -0.0008505533332936466, "vf_loss": 45.121681213378906, "vf_explained_var": 0.0005770539864897728, "kl": 0.0012430589413270354, "entropy": 1.4444384574890137, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04393409565091133, "policy_loss": -0.0002977189142256975, "vf_loss": 0.04420632869005203, "vf_explained_var": 0.03712327033281326, "kl": 0.0020383878145366907, "entropy": 1.375216007232666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 88000, "episodes_total": 27, "training_iteration": 5, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-03-03", "timestamp": 1714557783, "time_this_iter_s": 77.94465780258179, "time_total_s": 381.5351390838623, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218abd40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 381.5351390838623, "timesteps_since_restore": 88000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.566071428571426, "ram_util_percent": 76.61964285714286}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -97.35338639759378, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -335.4581734554518, "episode_len_mean": 3065.464285714286, "episodes_this_iter": 1, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 492.67794756307745, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 324.2245829893074, "tl": -54.97356303706318}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.795299740253217, "mean_processing_ms": 4.0685284959188035, "mean_inference_ms": 0.9556970565956936}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1267200, "num_steps_sampled": 105600, "sample_time_ms": 53605.576, "load_time_ms": 122.307, "grad_time_ms": 20597.311, "update_time_ms": 315.474, "learner": {"cav": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 44.72305679321289, "policy_loss": -0.0030078559648245573, "vf_loss": 44.726051330566406, "vf_explained_var": 0.0002594098332338035, "kl": 0.0023794148582965136, "entropy": 1.4623702764511108, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 0.016880322247743607, "policy_loss": -0.0008666077628731728, "vf_loss": 0.017691437155008316, "vf_explained_var": 0.10886474698781967, "kl": 0.008878943510353565, "entropy": 1.3472659587860107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 105600, "episodes_total": 28, "training_iteration": 6, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-04-09", "timestamp": 1714557849, "time_this_iter_s": 66.62403273582458, "time_total_s": 448.1591718196869, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21823050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 448.1591718196869, "timesteps_since_restore": 105600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.29157894736842, "ram_util_percent": 76.53052631578947}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -97.35338639759378, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -302.85946342433994, "episode_len_mean": 3162.027777777778, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 492.67794756307745, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 352.8462685996178, "tl": -54.64214433532977}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.59425491886235, "mean_processing_ms": 3.982537295305814, "mean_inference_ms": 0.9493854544446635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1278336, "num_steps_sampled": 123200, "sample_time_ms": 54283.928, "load_time_ms": 118.644, "grad_time_ms": 20528.703, "update_time_ms": 270.932, "learner": {"tl": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 0.061507973819971085, "policy_loss": -0.0002612804528325796, "vf_loss": 0.061763424426317215, "vf_explained_var": 0.11563145369291306, "kl": 0.0018659417983144522, "entropy": 1.3446149826049805, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 54.52421188354492, "policy_loss": -0.0010636219521984458, "vf_loss": 54.5252799987793, "vf_explained_var": 0.00021586884395219386, "kl": 0.0008937314269132912, "entropy": 1.455837607383728, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 123200, "episodes_total": 36, "training_iteration": 7, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-05-28", "timestamp": 1714557928, "time_this_iter_s": 78.60074520111084, "time_total_s": 526.7599170207977, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e60e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 526.7599170207977, "timesteps_since_restore": 123200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.79107142857142, "ram_util_percent": 76.60535714285716}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -76.28494833242367, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -279.06219817775565, "episode_len_mean": 3203.243902439024, "episodes_this_iter": 5, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 493.0369714421824, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 366.1789979697113, "tl": -53.77009967895555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.46395937634897, "mean_processing_ms": 3.9512655782027912, "mean_inference_ms": 0.9454368834013965}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1489536, "num_steps_sampled": 140800, "sample_time_ms": 54135.722, "load_time_ms": 115.703, "grad_time_ms": 20449.472, "update_time_ms": 237.523, "learner": {"cav": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 76.37598419189453, "policy_loss": 0.0005738910404033959, "vf_loss": 76.37540435791016, "vf_explained_var": 0.0003038662252947688, "kl": 0.00077649368904531, "entropy": 1.4493474960327148, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04717247188091278, "policy_loss": -0.0003809079935308546, "vf_loss": 0.04754854738712311, "vf_explained_var": 0.2438749521970749, "kl": 0.0030974370893090963, "entropy": 1.3343251943588257, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 140800, "episodes_total": 41, "training_iteration": 8, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-06-41", "timestamp": 1714558001, "time_this_iter_s": 73.12008810043335, "time_total_s": 599.8800051212311, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc9e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 599.8800051212311, "timesteps_since_restore": 140800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.63173076923077, "ram_util_percent": 76.60673076923078}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -70.71453947498956, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -266.63205174926975, "episode_len_mean": 3223.4772727272725, "episodes_this_iter": 3, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 493.0369714421824, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 373.4542415344165, "tl": -53.34052444030718}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.421505875094606, "mean_processing_ms": 3.9391477342653305, "mean_inference_ms": 0.9427065950544258}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1700736, "num_steps_sampled": 158400, "sample_time_ms": 53308.939, "load_time_ms": 116.224, "grad_time_ms": 20425.15, "update_time_ms": 211.559, "learner": {"cav": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 63.29225540161133, "policy_loss": -0.00019487681856844574, "vf_loss": 63.292457580566406, "vf_explained_var": 0.00015364559658337384, "kl": 0.000838501553516835, "entropy": 1.455127239227295, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 0.034845758229494095, "policy_loss": -0.00016243985737673938, "vf_loss": 0.03500733524560928, "vf_explained_var": 0.33200469613075256, "kl": 0.0011061944533139467, "entropy": 1.318171739578247, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 158400, "episodes_total": 44, "training_iteration": 9, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-07-48", "timestamp": 1714558068, "time_this_iter_s": 67.0779275894165, "time_total_s": 666.9579327106476, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e6830>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 666.9579327106476, "timesteps_since_restore": 158400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.01770833333333, "ram_util_percent": 76.58437500000001}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -18.52039130557297, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -238.14316302936317, "episode_len_mean": 3266.019230769231, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 509.97304549642877, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 386.6013038718245, "tl": -52.06203890843235}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.262555825018026, "mean_processing_ms": 3.902636527425709, "mean_inference_ms": 0.9363227016820548}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1708672, "num_steps_sampled": 176000, "sample_time_ms": 53631.17, "load_time_ms": 114.502, "grad_time_ms": 20388.383, "update_time_ms": 190.734, "learner": {"tl": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08626886457204819, "policy_loss": -7.982434908626601e-05, "vf_loss": 0.0863485261797905, "vf_explained_var": 0.30360108613967896, "kl": 0.00044815483852289617, "entropy": 1.3123035430908203, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 67.90730285644531, "policy_loss": -0.0003979121975135058, "vf_loss": 67.90769958496094, "vf_explained_var": 4.4450644054450095e-05, "kl": 0.0003144385409541428, "entropy": 1.4567627906799316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 176000, "episodes_total": 52, "training_iteration": 10, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-09-05", "timestamp": 1714558145, "time_this_iter_s": 76.72109341621399, "time_total_s": 743.6790261268616, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dcb00>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 743.6790261268616, "timesteps_since_restore": 176000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 37.94770642201835, "ram_util_percent": 76.69449541284406}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": -18.52039130557297, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -238.1431630293632, "episode_len_mean": 3266.019230769231, "episodes_this_iter": 0, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 509.97304549642877, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 386.6013038718246, "tl": -52.06203890843234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.262555825018026, "mean_processing_ms": 3.902636527425709, "mean_inference_ms": 0.9363227016820547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1919872, "num_steps_sampled": 193600, "sample_time_ms": 52349.218, "load_time_ms": 99.455, "grad_time_ms": 20259.222, "update_time_ms": 3.788, "learner": {"cav": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 95.68508911132812, "policy_loss": -0.0007905566017143428, "vf_loss": 95.68587493896484, "vf_explained_var": 9.156828309642151e-05, "kl": 0.00032037103665061295, "entropy": 1.4410266876220703, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 0.005186086054891348, "policy_loss": -0.0017406184924766421, "vf_loss": 0.006923172157257795, "vf_explained_var": 0.7741327881813049, "kl": 0.018089881166815758, "entropy": 1.2274008989334106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 193600, "episodes_total": 52, "training_iteration": 11, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-10-07", "timestamp": 1714558207, "time_this_iter_s": 61.982645988464355, "time_total_s": 805.6616721153259, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e6320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 805.6616721153259, "timesteps_since_restore": 193600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.96067415730337, "ram_util_percent": 76.5932584269663}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 3.8905829117266553, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -211.33028680172856, "episode_len_mean": 3297.2166666666667, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 397.3107609850907, "tl": -50.72008731556831}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 19.111367341033308, "mean_processing_ms": 3.8613418293445045, "mean_inference_ms": 0.9305784929371679}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1932800, "num_steps_sampled": 211200, "sample_time_ms": 51702.094, "load_time_ms": 99.809, "grad_time_ms": 20294.984, "update_time_ms": 3.785, "learner": {"tl": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09623637050390244, "policy_loss": -0.0006771434564143419, "vf_loss": 0.09691208600997925, "vf_explained_var": 0.37445268034935, "kl": 0.007265176624059677, "entropy": 1.1957632303237915, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 71.85994720458984, "policy_loss": -0.0001706557668512687, "vf_loss": 71.86012268066406, "vf_explained_var": 8.8977933046408e-05, "kl": 5.628694634651765e-05, "entropy": 1.44496488571167, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 211200, "episodes_total": 60, "training_iteration": 12, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-11-18", "timestamp": 1714558278, "time_this_iter_s": 71.35265278816223, "time_total_s": 877.0143249034882, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dce60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 877.0143249034882, "timesteps_since_restore": 211200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.25346534653465, "ram_util_percent": 76.76435643564355}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 91.57308581152103, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -180.42781482531257, "episode_len_mean": 3321.073529411765, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 405.9192276130594, "tl": -48.86225353653104}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.978775068964154, "mean_processing_ms": 3.842074178901877, "mean_inference_ms": 0.9250633527555414}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1938176, "num_steps_sampled": 228800, "sample_time_ms": 52285.858, "load_time_ms": 98.95, "grad_time_ms": 20152.554, "update_time_ms": 3.758, "learner": {"tl": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09928406029939651, "policy_loss": -0.0004573810438159853, "vf_loss": 0.09974092990159988, "vf_explained_var": 0.49473655223846436, "kl": 0.005110397469252348, "entropy": 1.1551443338394165, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 86.49356842041016, "policy_loss": -0.0010626574512571096, "vf_loss": 86.49462890625, "vf_explained_var": 0.0001382685877615586, "kl": 0.0001027510006679222, "entropy": 1.4473390579223633, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 228800, "episodes_total": 68, "training_iteration": 13, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-12-33", "timestamp": 1714558353, "time_this_iter_s": 74.38819289207458, "time_total_s": 951.4025177955627, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e6710>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 951.4025177955627, "timesteps_since_restore": 228800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.90467289719626, "ram_util_percent": 76.71121495327101}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 91.57308581152103, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -180.42781482531257, "episode_len_mean": 3321.073529411765, "episodes_this_iter": 0, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 405.9192276130593, "tl": -48.86225353653104}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.978775068964154, "mean_processing_ms": 3.842074178901878, "mean_inference_ms": 0.9250633527555415}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2149376, "num_steps_sampled": 246400, "sample_time_ms": 50667.132, "load_time_ms": 98.542, "grad_time_ms": 20116.888, "update_time_ms": 3.688, "learner": {"cav": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 70.98741912841797, "policy_loss": -0.00042180102900601923, "vf_loss": 70.98783874511719, "vf_explained_var": 7.398577145067975e-05, "kl": 6.06467729085125e-05, "entropy": 1.440666675567627, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.003711996367201209, "policy_loss": -0.0011223455658182502, "vf_loss": 0.004833762533962727, "vf_explained_var": 0.9191906452178955, "kl": 0.011903931386768818, "entropy": 1.1081297397613525, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 246400, "episodes_total": 68, "training_iteration": 14, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-13-34", "timestamp": 1714558414, "time_this_iter_s": 61.350181579589844, "time_total_s": 1012.7526993751526, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1012.7526993751526, "timesteps_since_restore": 246400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.093103448275855, "ram_util_percent": 76.60689655172413}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 93.62265222461555, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -155.3743496413945, "episode_len_mean": 3339.907894736842, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 412.345458735809, "tl": -47.309984031433736}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.85335589716907, "mean_processing_ms": 3.8175880870921213, "mean_inference_ms": 0.9205611562508366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2159616, "num_steps_sampled": 264000, "sample_time_ms": 49969.427, "load_time_ms": 99.998, "grad_time_ms": 20081.222, "update_time_ms": 3.727, "learner": {"tl": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11010091751813889, "policy_loss": -0.0002365593536524102, "vf_loss": 0.11033732444047928, "vf_explained_var": 0.5986468195915222, "kl": 0.0035020371433347464, "entropy": 1.0874273777008057, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 55.3636360168457, "policy_loss": -0.001912980922497809, "vf_loss": 55.36553955078125, "vf_explained_var": 1.91204253496835e-05, "kl": 0.0006060019368305802, "entropy": 1.429286241531372, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 264000, "episodes_total": 76, "training_iteration": 15, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-14-45", "timestamp": 1714558485, "time_this_iter_s": 70.62713718414307, "time_total_s": 1083.3798365592957, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e6cb0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1083.3798365592957, "timesteps_since_restore": 264000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.06831683168317, "ram_util_percent": 76.80990099009901}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -140.35196669039283, "episode_len_mean": 3349.7901234567903, "episodes_this_iter": 5, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 415.7402745391811, "tl": -46.341020102464604}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.775645591557005, "mean_processing_ms": 3.807503394264748, "mean_inference_ms": 0.9181119446177421}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2370816, "num_steps_sampled": 281600, "sample_time_ms": 50174.815, "load_time_ms": 99.977, "grad_time_ms": 20025.948, "update_time_ms": 3.733, "learner": {"cav": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 111.58719635009766, "policy_loss": -0.00035665486939251423, "vf_loss": 111.58753204345703, "vf_explained_var": 3.823527731583454e-05, "kl": 0.0004259622364770621, "entropy": 1.409192442893982, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.071875661611557, "policy_loss": -7.651921623619273e-05, "vf_loss": 0.07195216417312622, "vf_explained_var": 0.7005986571311951, "kl": 0.000685282691847533, "entropy": 1.0748194456100464, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 281600, "episodes_total": 81, "training_iteration": 16, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-15-53", "timestamp": 1714558553, "time_this_iter_s": 68.11785674095154, "time_total_s": 1151.4976933002472, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1151.4976933002472, "timesteps_since_restore": 281600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.18350515463917, "ram_util_percent": 76.84742268041236}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -131.94848814274823, "episode_len_mean": 3355.154761904762, "episodes_this_iter": 3, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 417.87321027112046, "tl": -45.818474867822516}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.740341324605748, "mean_processing_ms": 3.800696799641429, "mean_inference_ms": 0.9165146999010281}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2582016, "num_steps_sampled": 299200, "sample_time_ms": 48901.687, "load_time_ms": 100.173, "grad_time_ms": 20053.379, "update_time_ms": 3.747, "learner": {"cav": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 61.82664108276367, "policy_loss": 0.0003739927487913519, "vf_loss": 61.826263427734375, "vf_explained_var": 1.893880653369706e-05, "kl": 7.938713679322973e-05, "entropy": 1.418041706085205, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03783658891916275, "policy_loss": -9.59949757088907e-05, "vf_loss": 0.03793258219957352, "vf_explained_var": 0.6911801099777222, "kl": 0.0005083752330392599, "entropy": 1.0696732997894287, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 299200, "episodes_total": 84, "training_iteration": 17, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-16-59", "timestamp": 1714558619, "time_this_iter_s": 66.14664649963379, "time_total_s": 1217.644339799881, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1217.644339799881, "timesteps_since_restore": 299200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.70531914893617, "ram_util_percent": 76.7468085106383}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -112.55399835505028, "episode_len_mean": 3367.75, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 422.7721231446404, "tl": -44.61051012497439}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.63610511684166, "mean_processing_ms": 3.7851376519743827, "mean_inference_ms": 0.9131165679509108}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2590592, "num_steps_sampled": 316800, "sample_time_ms": 48569.124, "load_time_ms": 100.435, "grad_time_ms": 20054.892, "update_time_ms": 3.746, "learner": {"tl": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10885673761367798, "policy_loss": -0.0001259455893887207, "vf_loss": 0.10898268967866898, "vf_explained_var": 0.8132582306861877, "kl": 0.001291370135731995, "entropy": 1.0530346632003784, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 62.2297248840332, "policy_loss": 7.150934106903151e-05, "vf_loss": 62.229652404785156, "vf_explained_var": 2.4618497263872996e-05, "kl": 3.893117536790669e-05, "entropy": 1.4216980934143066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 316800, "episodes_total": 92, "training_iteration": 18, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-18-09", "timestamp": 1714558689, "time_this_iter_s": 69.81502389907837, "time_total_s": 1287.4593636989594, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e3b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1287.4593636989594, "timesteps_since_restore": 316800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 39.806, "ram_util_percent": 76.865}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -112.55399835505028, "episode_len_mean": 3367.75, "episodes_this_iter": 0, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 422.7721231446405, "tl": -44.61051012497438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.636105116841655, "mean_processing_ms": 3.785137651974384, "mean_inference_ms": 0.9131165679509109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2801792, "num_steps_sampled": 334400, "sample_time_ms": 47912.438, "load_time_ms": 97.829, "grad_time_ms": 20075.385, "update_time_ms": 3.763, "learner": {"cav": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 72.68209838867188, "policy_loss": 6.821146962465718e-05, "vf_loss": 72.6820297241211, "vf_explained_var": 1.8072600141749717e-05, "kl": 4.9058238801080734e-05, "entropy": 1.4284974336624146, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.008038612082600594, "policy_loss": -0.0001763120963005349, "vf_loss": 0.008214922621846199, "vf_explained_var": 0.9735537171363831, "kl": 0.00241158832795918, "entropy": 1.0389939546585083, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 334400, "episodes_total": 92, "training_iteration": 19, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-19-09", "timestamp": 1714558749, "time_this_iter_s": 60.6912739276886, "time_total_s": 1348.150637626648, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1348.150637626648, "timesteps_since_restore": 334400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 38.58850574712645, "ram_util_percent": 76.70344827586207}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -563.4422454943848, "episode_reward_mean": -96.14656439463833, "episode_len_mean": 3378.33, "episodes_this_iter": 8, "policy_reward_min": {"cav": 6.53868099837752, "tl": -67.34769559372445}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -8.694694107582148}, "policy_reward_mean": {"cav": 426.38153886495274, "tl": -43.54400860496612}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.538254945182327, "mean_processing_ms": 3.767404295481826, "mean_inference_ms": 0.910376561235924}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2815872, "num_steps_sampled": 352000, "sample_time_ms": 47248.955, "load_time_ms": 97.471, "grad_time_ms": 20107.667, "update_time_ms": 3.801, "learner": {"tl": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09964413940906525, "policy_loss": -0.00010764194303192198, "vf_loss": 0.099751777946949, "vf_explained_var": 0.8110001683235168, "kl": 0.0008652819087728858, "entropy": 1.0404233932495117, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 49.766048431396484, "policy_loss": -0.0011310558766126633, "vf_loss": 49.767173767089844, "vf_explained_var": 1.0695782293623779e-05, "kl": 0.00029399548657238483, "entropy": 1.4248251914978027, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 352000, "episodes_total": 100, "training_iteration": 20, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-20-20", "timestamp": 1714558820, "time_this_iter_s": 70.40411877632141, "time_total_s": 1418.5547564029694, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1418.5547564029694, "timesteps_since_restore": 352000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.061, "ram_util_percent": 76.91899999999998}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -530.0206428957848, "episode_reward_mean": -63.414926996293474, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 268.42634220993364, "tl": -66.53724875880987}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -28.77147724234496}, "policy_reward_mean": {"cav": 452.72233905052053, "tl": -43.011438837234735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.298532362653866, "mean_processing_ms": 3.6695760883840323, "mean_inference_ms": 0.9029530564470412}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3027072, "num_steps_sampled": 369600, "sample_time_ms": 48256.389, "load_time_ms": 97.486, "grad_time_ms": 20108.397, "update_time_ms": 3.808, "learner": {"cav": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 79.37076568603516, "policy_loss": -0.001631296006962657, "vf_loss": 79.37239837646484, "vf_explained_var": 1.763193722581491e-05, "kl": 0.0001325274060945958, "entropy": 1.4342482089996338, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10730468481779099, "policy_loss": -0.00018330587772652507, "vf_loss": 0.1074879989027977, "vf_explained_var": 0.8635156154632568, "kl": 0.0017462753457948565, "entropy": 1.0318717956542969, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 369600, "episodes_total": 108, "training_iteration": 21, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-21-32", "timestamp": 1714558892, "time_this_iter_s": 72.06531167030334, "time_total_s": 1490.6200680732727, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1490.6200680732727, "timesteps_since_restore": 369600, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.507766990291266, "ram_util_percent": 76.92330097087375}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -530.0206428957848, "episode_reward_mean": -63.41492699629346, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 268.42634220993364, "tl": -66.53724875880987}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -28.77147724234496}, "policy_reward_mean": {"cav": 452.72233905052053, "tl": -43.011438837234735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.298532362653862, "mean_processing_ms": 3.669576088384033, "mean_inference_ms": 0.902953056447041}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3238272, "num_steps_sampled": 387200, "sample_time_ms": 47191.394, "load_time_ms": 97.338, "grad_time_ms": 20143.431, "update_time_ms": 3.796, "learner": {"cav": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 60.73569869995117, "policy_loss": -0.0007493935991078615, "vf_loss": 60.7364501953125, "vf_explained_var": 5.048137609264813e-06, "kl": 0.0004918434424325824, "entropy": 1.42560613155365, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009073786437511444, "policy_loss": -0.00028466523508541286, "vf_loss": 0.009358450770378113, "vf_explained_var": 0.978196382522583, "kl": 0.002652902388945222, "entropy": 1.0106595754623413, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 387200, "episodes_total": 108, "training_iteration": 22, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-22-33", "timestamp": 1714558953, "time_this_iter_s": 61.05217933654785, "time_total_s": 1551.6722474098206, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc830>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1551.6722474098206, "timesteps_since_restore": 387200, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.73678160919539, "ram_util_percent": 76.91034482758621}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.2562412647092, "episode_reward_min": -416.2447143779669, "episode_reward_mean": -21.364362600188407, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 331.9912095130332, "tl": -62.966230698531554}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -28.77147724234496}, "policy_reward_mean": {"cav": 462.719616557849, "tl": -40.34033159650338}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 18.09609699920738, "mean_processing_ms": 3.66642601474326, "mean_inference_ms": 0.8966488655218363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3449472, "num_steps_sampled": 404800, "sample_time_ms": 46670.207, "load_time_ms": 97.676, "grad_time_ms": 20205.087, "update_time_ms": 3.799, "learner": {"cav": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 65.71733856201172, "policy_loss": 0.0002796775661408901, "vf_loss": 65.71707153320312, "vf_explained_var": 2.5591541543690255e-06, "kl": 0.0001433702273061499, "entropy": 1.4205399751663208, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10521544516086578, "policy_loss": -0.0007783925975672901, "vf_loss": 0.1059938371181488, "vf_explained_var": 0.876714289188385, "kl": 0.008189346641302109, "entropy": 0.9680813550949097, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 404800, "episodes_total": 116, "training_iteration": 23, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-23-43", "timestamp": 1714559023, "time_this_iter_s": 69.79488611221313, "time_total_s": 1621.4671335220337, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1621.4671335220337, "timesteps_since_restore": 404800, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.17979797979798, "ram_util_percent": 77.04949494949497}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -259.06141348734843, "episode_reward_mean": 12.220456095029084, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 430.15066671717375, "tl": -58.98646472299317}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 465.95317331670077, "tl": -37.811059768472965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.913075545683657, "mean_processing_ms": 3.652908193761781, "mean_inference_ms": 0.8907561579494626}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3660672, "num_steps_sampled": 422400, "sample_time_ms": 48016.977, "load_time_ms": 97.502, "grad_time_ms": 20147.595, "update_time_ms": 3.789, "learner": {"cav": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 78.34175872802734, "policy_loss": -0.0002638965379446745, "vf_loss": 78.34203338623047, "vf_explained_var": 4.207742222206434e-06, "kl": 0.00012689824507106096, "entropy": 1.4106698036193848, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10774097591638565, "policy_loss": -0.0004114351759199053, "vf_loss": 0.10815241187810898, "vf_explained_var": 0.8790498971939087, "kl": 0.002298392355442047, "entropy": 0.9357808828353882, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 422400, "episodes_total": 124, "training_iteration": 24, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-24-57", "timestamp": 1714559097, "time_this_iter_s": 74.24466037750244, "time_total_s": 1695.7117938995361, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1695.7117938995361, "timesteps_since_restore": 422400, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 36.883962264150945, "ram_util_percent": 77.07641509433964}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -259.06141348734843, "episode_reward_mean": 12.220456095029078, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 430.15066671717375, "tl": -58.98646472299317}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 465.9531733167007, "tl": -37.811059768472965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.91307554568366, "mean_processing_ms": 3.6529081937617813, "mean_inference_ms": 0.8907561579494625}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3871872, "num_steps_sampled": 440000, "sample_time_ms": 47004.355, "load_time_ms": 96.012, "grad_time_ms": 20201.126, "update_time_ms": 3.749, "learner": {"cav": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 37.64620590209961, "policy_loss": -0.000839051092043519, "vf_loss": 37.64704895019531, "vf_explained_var": 1.3822186701872852e-06, "kl": 0.0010821983451023698, "entropy": 1.416098713874817, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00795700028538704, "policy_loss": -2.8239452149136923e-05, "vf_loss": 0.007985238917171955, "vf_explained_var": 0.8202815055847168, "kl": 0.00028573296731337905, "entropy": 0.9263263940811157, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 440000, "episodes_total": 124, "training_iteration": 25, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-25-58", "timestamp": 1714559158, "time_this_iter_s": 61.017520904541016, "time_total_s": 1756.7293148040771, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f605f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1756.7293148040771, "timesteps_since_restore": 440000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 38.679310344827584, "ram_util_percent": 77.0011494252874}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -216.81258326421377, "episode_reward_mean": 31.677913686367233, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -54.729566082847946}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 461.16466845657465, "tl": -35.79056289751767}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.75832322588205, "mean_processing_ms": 3.639997536864683, "mean_inference_ms": 0.8863313791286942}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4083072, "num_steps_sampled": 457600, "sample_time_ms": 47153.534, "load_time_ms": 96.58, "grad_time_ms": 20240.964, "update_time_ms": 3.716, "learner": {"cav": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 54.07661437988281, "policy_loss": -0.0009899844881147146, "vf_loss": 54.07761001586914, "vf_explained_var": 2.100354095091461e-06, "kl": 0.0011143545852974057, "entropy": 1.4442870616912842, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15038001537322998, "policy_loss": -0.00010073539306176826, "vf_loss": 0.1504807323217392, "vf_explained_var": 0.8494726419448853, "kl": 0.0013255971716716886, "entropy": 0.935005247592926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 457600, "episodes_total": 132, "training_iteration": 26, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-27-08", "timestamp": 1714559228, "time_this_iter_s": 70.01800203323364, "time_total_s": 1826.7473168373108, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dcc20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1826.7473168373108, "timesteps_since_restore": 457600, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 39.771, "ram_util_percent": 77.14300000000003}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -216.81258326421377, "episode_reward_mean": 31.677913686367237, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -54.729566082847946}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 461.1646684565747, "tl": -35.79056289751767}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.75832322588205, "mean_processing_ms": 3.6399975368646835, "mean_inference_ms": 0.8863313791286939}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4294272, "num_steps_sampled": 475200, "sample_time_ms": 46617.465, "load_time_ms": 96.778, "grad_time_ms": 20240.698, "update_time_ms": 3.687, "learner": {"cav": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 56.63679504394531, "policy_loss": -0.0011146010365337133, "vf_loss": 56.637908935546875, "vf_explained_var": 1.5705003306720755e-06, "kl": 0.00034036903525702655, "entropy": 1.4618768692016602, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.008896571584045887, "policy_loss": -0.00010903618385782465, "vf_loss": 0.009005608037114143, "vf_explained_var": 0.9858177900314331, "kl": 0.0017136594979092479, "entropy": 0.9436733722686768, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 475200, "episodes_total": 132, "training_iteration": 27, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-28-09", "timestamp": 1714559289, "time_this_iter_s": 60.783809185028076, "time_total_s": 1887.5311260223389, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187eef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1887.5311260223389, "timesteps_since_restore": 475200, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 38.41149425287356, "ram_util_percent": 77.0896551724138}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 50.36441102236292, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -49.443442212392156}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 461.0266148562642, "tl": -34.221850319492184}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.624778540571597, "mean_processing_ms": 3.6233756187417936, "mean_inference_ms": 0.8832714133067046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4309632, "num_steps_sampled": 492800, "sample_time_ms": 46622.481, "load_time_ms": 96.549, "grad_time_ms": 20297.391, "update_time_ms": 3.719, "learner": {"tl": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10814973711967468, "policy_loss": -0.0003159418993163854, "vf_loss": 0.10846568644046783, "vf_explained_var": 0.8707987070083618, "kl": 0.004278127104043961, "entropy": 0.9588143825531006, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 50.87717819213867, "policy_loss": -0.0004137804207857698, "vf_loss": 50.877586364746094, "vf_explained_var": 1.8477439311936905e-07, "kl": 0.0008645326015539467, "entropy": 1.4809460639953613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 492800, "episodes_total": 140, "training_iteration": 28, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-29-19", "timestamp": 1714559359, "time_this_iter_s": 70.43729615211487, "time_total_s": 1957.9684221744537, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1957.9684221744537, "timesteps_since_restore": 492800, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 39.714851485148515, "ram_util_percent": 77.26930693069306}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 65.41549474983252, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -46.04578463287487}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.9080132504491, "tl": -32.957709875051826}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.502899494840236, "mean_processing_ms": 3.615036003419033, "mean_inference_ms": 0.8811087192296455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4520832, "num_steps_sampled": 510400, "sample_time_ms": 47538.921, "load_time_ms": 97.169, "grad_time_ms": 20219.789, "update_time_ms": 3.699, "learner": {"cav": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 83.34537506103516, "policy_loss": 0.000818477594293654, "vf_loss": 83.34456634521484, "vf_explained_var": 8.902488843887113e-07, "kl": 7.857495074858889e-05, "entropy": 1.47834312915802, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1011875793337822, "policy_loss": -0.0001947368582477793, "vf_loss": 0.101382315158844, "vf_explained_var": 0.9351031184196472, "kl": 0.0028514207806438208, "entropy": 0.9674736857414246, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 510400, "episodes_total": 148, "training_iteration": 29, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-30-28", "timestamp": 1714559428, "time_this_iter_s": 69.08544898033142, "time_total_s": 2027.0538711547852, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f605f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2027.0538711547852, "timesteps_since_restore": 510400, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 40.30204081632653, "ram_util_percent": 77.32959183673469}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 139.0952250676533, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 65.4154947498325, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -46.04578463287487}, "policy_reward_max": {"cav": 510.45896689393106, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.90801325044924, "tl": -32.957709875051826}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.502899494840236, "mean_processing_ms": 3.6150360034190316, "mean_inference_ms": 0.8811087192296456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4732032, "num_steps_sampled": 528000, "sample_time_ms": 46565.443, "load_time_ms": 97.064, "grad_time_ms": 20195.237, "update_time_ms": 3.706, "learner": {"cav": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 60.6383056640625, "policy_loss": -0.001550499233417213, "vf_loss": 60.63985824584961, "vf_explained_var": 5.31985392626666e-07, "kl": 0.0008546000462956727, "entropy": 1.4567770957946777, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.011928918771445751, "policy_loss": -3.798940088017844e-05, "vf_loss": 0.011966908350586891, "vf_explained_var": 0.9877320528030396, "kl": 0.0005935199442319572, "entropy": 0.9577847719192505, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 528000, "episodes_total": 148, "training_iteration": 30, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-31-29", "timestamp": 1714559489, "time_this_iter_s": 60.42182898521423, "time_total_s": 2087.4757001399994, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218885f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2087.4757001399994, "timesteps_since_restore": 528000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.906976744186046, "ram_util_percent": 77.27558139534884}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 145.50122547184884, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 77.56015900095345, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -43.116818886768826}, "policy_reward_max": {"cav": 510.32610656521797, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.249951471465, "tl": -31.890816039209774}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.400963753364266, "mean_processing_ms": 3.607164688180809, "mean_inference_ms": 0.8797825917774417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4744320, "num_steps_sampled": 545600, "sample_time_ms": 46280.788, "load_time_ms": 97.258, "grad_time_ms": 20223.609, "update_time_ms": 3.692, "learner": {"tl": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0984344333410263, "policy_loss": -0.00041207188041880727, "vf_loss": 0.09884648770093918, "vf_explained_var": 0.9398829340934753, "kl": 0.00676960963755846, "entropy": 0.9518278241157532, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 51.5320930480957, "policy_loss": -0.00047702714800834656, "vf_loss": 51.53256607055664, "vf_explained_var": 1.6205012798309326e-07, "kl": 0.0009034436079673469, "entropy": 1.4628478288650513, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 545600, "episodes_total": 156, "training_iteration": 31, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-32-38", "timestamp": 1714559558, "time_this_iter_s": 69.50300979614258, "time_total_s": 2156.978709936142, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2156.978709936142, "timesteps_since_restore": 545600, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 39.95757575757575, "ram_util_percent": 77.43030303030302}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 145.50122547184884, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 84.79845025043272, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -37.178176598431925}, "policy_reward_max": {"cav": 510.32610656521797, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.26002162046854, "tl": -31.28846428083682}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.313120070266866, "mean_processing_ms": 3.6028537112915258, "mean_inference_ms": 0.8789771600805755}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4955520, "num_steps_sampled": 563200, "sample_time_ms": 47171.017, "load_time_ms": 97.224, "grad_time_ms": 20137.076, "update_time_ms": 3.718, "learner": {"cav": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 114.3614730834961, "policy_loss": 0.00013044799561612308, "vf_loss": 114.3613510131836, "vf_explained_var": 3.5067398584942566e-07, "kl": 0.0003575800801627338, "entropy": 1.4669418334960938, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10308469831943512, "policy_loss": -0.00011333277507219464, "vf_loss": 0.10319803655147552, "vf_explained_var": 0.9273359179496765, "kl": 0.00047052293666638434, "entropy": 0.960096001625061, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 563200, "episodes_total": 164, "training_iteration": 32, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-33-48", "timestamp": 1714559628, "time_this_iter_s": 69.08906769752502, "time_total_s": 2226.067777633667, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2226.067777633667, "timesteps_since_restore": 563200, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 39.93333333333334, "ram_util_percent": 77.46464646464645}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 145.50122547184884, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 84.79845025043272, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -37.178176598431925}, "policy_reward_max": {"cav": 510.32610656521797, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.2600216204685, "tl": -31.28846428083682}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.313120070266862, "mean_processing_ms": 3.6028537112915258, "mean_inference_ms": 0.8789771600805752}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5166720, "num_steps_sampled": 580800, "sample_time_ms": 46251.6, "load_time_ms": 96.813, "grad_time_ms": 20187.665, "update_time_ms": 3.73, "learner": {"cav": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 61.77067565917969, "policy_loss": -0.000496898777782917, "vf_loss": 61.77116775512695, "vf_explained_var": 2.8610230629055877e-07, "kl": 0.0002614915429148823, "entropy": 1.4648281335830688, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.015190781094133854, "policy_loss": -9.53240851231385e-06, "vf_loss": 0.015200313180685043, "vf_explained_var": 0.9632356762886047, "kl": 0.0003263904945924878, "entropy": 0.9561314582824707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 580800, "episodes_total": 164, "training_iteration": 33, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-34-49", "timestamp": 1714559689, "time_this_iter_s": 61.10465884208679, "time_total_s": 2287.172436475754, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218883b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2287.172436475754, "timesteps_since_restore": 580800, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.909195402298856, "ram_util_percent": 77.30114942528732}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 145.50122547184884, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 88.24257700232552, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.21894116305456}, "policy_reward_max": {"cav": 510.3111589404074, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.3200663654206, "tl": -31.006457446925143}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.2358667120783, "mean_processing_ms": 3.595565594750495, "mean_inference_ms": 0.8786294826831574}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5175936, "num_steps_sampled": 598400, "sample_time_ms": 45730.847, "load_time_ms": 97.538, "grad_time_ms": 20179.172, "update_time_ms": 3.751, "learner": {"tl": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10940514504909515, "policy_loss": -0.00041803359636105597, "vf_loss": 0.10982317477464676, "vf_explained_var": 0.9455415606498718, "kl": 0.006173110567033291, "entropy": 0.9617569446563721, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 70.83048248291016, "policy_loss": 6.88266009092331e-05, "vf_loss": 70.83041381835938, "vf_explained_var": 2.077884175832878e-07, "kl": 0.00026975804939866066, "entropy": 1.4603127241134644, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 598400, "episodes_total": 172, "training_iteration": 34, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-35-58", "timestamp": 1714559758, "time_this_iter_s": 68.95586156845093, "time_total_s": 2356.1282980442047, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187eef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2356.1282980442047, "timesteps_since_restore": 598400, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 40.067676767676765, "ram_util_percent": 77.52323232323232}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 145.50122547184884, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 88.24257700232552, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.21894116305456}, "policy_reward_max": {"cav": 510.3111589404074, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.32006636542064, "tl": -31.006457446925143}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.235866712078302, "mean_processing_ms": 3.5955655947504948, "mean_inference_ms": 0.8786294826831577}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5387136, "num_steps_sampled": 616000, "sample_time_ms": 45743.689, "load_time_ms": 98.054, "grad_time_ms": 19827.709, "update_time_ms": 3.731, "learner": {"cav": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 86.38014221191406, "policy_loss": -0.00045425331336446106, "vf_loss": 86.38059997558594, "vf_explained_var": 5.7341178916203717e-08, "kl": 0.00016890345432329923, "entropy": 1.4600152969360352, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.012846258468925953, "policy_loss": -0.00015937212447170168, "vf_loss": 0.013005631044507027, "vf_explained_var": 0.9897748231887817, "kl": 0.000787953904364258, "entropy": 0.9349890351295471, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 616000, "episodes_total": 172, "training_iteration": 35, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-36-55", "timestamp": 1714559815, "time_this_iter_s": 57.63566589355469, "time_total_s": 2413.7639639377594, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f605f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2413.7639639377594, "timesteps_since_restore": 616000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 42.7609756097561, "ram_util_percent": 77.75}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 146.83362578888054, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 90.63306803100903, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -33.75457799943847}, "policy_reward_max": {"cav": 510.3111589404074, "tl": -27.21343702320394}, "policy_reward_mean": {"cav": 460.55874704953766, "tl": -30.827139918211255}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.17026753511193, "mean_processing_ms": 3.58716911654524, "mean_inference_ms": 0.8786594592401904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5402752, "num_steps_sampled": 633600, "sample_time_ms": 45788.682, "load_time_ms": 98.026, "grad_time_ms": 19854.103, "update_time_ms": 3.745, "learner": {"tl": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0936831384897232, "policy_loss": -0.0003839572018478066, "vf_loss": 0.09406708925962448, "vf_explained_var": 0.9278264045715332, "kl": 0.003336307592689991, "entropy": 0.9360548257827759, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 54.98456954956055, "policy_loss": -0.0017357433680444956, "vf_loss": 54.98630142211914, "vf_explained_var": 7.572721472115518e-08, "kl": 0.002302716951817274, "entropy": 1.451521873474121, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 633600, "episodes_total": 180, "training_iteration": 36, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-38-06", "timestamp": 1714559886, "time_this_iter_s": 70.72910284996033, "time_total_s": 2484.4930667877197, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2484.4930667877197, "timesteps_since_restore": 633600, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 40.41386138613861, "ram_util_percent": 78.53267326732674}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 88.19914214258147, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -33.75457799943847}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 456.7018262158265, "tl": -30.70855700610432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.110506185017385, "mean_processing_ms": 3.5842316813926813, "mean_inference_ms": 0.878656158224769}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5412480, "num_steps_sampled": 651200, "sample_time_ms": 46704.556, "load_time_ms": 97.811, "grad_time_ms": 19799.602, "update_time_ms": 3.758, "learner": {"tl": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12547320127487183, "policy_loss": -0.00011432849714765325, "vf_loss": 0.12558753788471222, "vf_explained_var": 0.9497673511505127, "kl": 0.0008932987693697214, "entropy": 0.9241032004356384, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 71.83441162109375, "policy_loss": -0.0005476043443195522, "vf_loss": 71.83495330810547, "vf_explained_var": 3.607649645687161e-08, "kl": 0.0001311326486757025, "entropy": 1.4554957151412964, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 651200, "episodes_total": 188, "training_iteration": 37, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-39-15", "timestamp": 1714559955, "time_this_iter_s": 69.39713883399963, "time_total_s": 2553.8902056217194, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ea70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2553.8902056217194, "timesteps_since_restore": 651200, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 40.07474747474747, "ram_util_percent": 78.50606060606059}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 88.19914214258144, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -33.75457799943847}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 456.7018262158266, "tl": -30.70855700610432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.110506185017385, "mean_processing_ms": 3.5842316813926813, "mean_inference_ms": 0.8786561582247692}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5623680, "num_steps_sampled": 668800, "sample_time_ms": 45705.08, "load_time_ms": 97.984, "grad_time_ms": 19755.334, "update_time_ms": 3.732, "learner": {"cav": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 74.49179077148438, "policy_loss": 0.0008223505574278533, "vf_loss": 74.49097442626953, "vf_explained_var": 4.0905149489844916e-08, "kl": 0.0001336560962954536, "entropy": 1.449520230293274, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01969277113676071, "policy_loss": -8.388367859879509e-05, "vf_loss": 0.019776655361056328, "vf_explained_var": 0.9869337677955627, "kl": 0.0004590461030602455, "entropy": 0.9116453528404236, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 668800, "episodes_total": 188, "training_iteration": 38, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-40-15", "timestamp": 1714560015, "time_this_iter_s": 59.99127221107483, "time_total_s": 2613.881477832794, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2613.881477832794, "timesteps_since_restore": 668800, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 39.09882352941177, "ram_util_percent": 78.36705882352942}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 88.4475105745589, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -33.75457799943847}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 455.92642977188416, "tl": -30.6232432664443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.059633367155687, "mean_processing_ms": 3.5806792917156063, "mean_inference_ms": 0.8787420268922342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5636352, "num_steps_sampled": 686400, "sample_time_ms": 45744.567, "load_time_ms": 97.52, "grad_time_ms": 19829.299, "update_time_ms": 3.725, "learner": {"tl": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09815485030412674, "policy_loss": -0.00014634212129749358, "vf_loss": 0.09830119460821152, "vf_explained_var": 0.9572305679321289, "kl": 0.0021929307840764523, "entropy": 0.9141038060188293, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 55.432987213134766, "policy_loss": -0.0012444020248949528, "vf_loss": 55.43423080444336, "vf_explained_var": 3.612402821318028e-09, "kl": 0.0004062230873387307, "entropy": 1.4334489107131958, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 686400, "episodes_total": 196, "training_iteration": 39, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-41-26", "timestamp": 1714560086, "time_this_iter_s": 70.21476173400879, "time_total_s": 2684.096239566803, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2684.096239566803, "timesteps_since_restore": 686400, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 40.832, "ram_util_percent": 78.05799999999999}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 87.24259644717078, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 454.7381349098192, "tl": -30.624628205221263}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.014679984524086, "mean_processing_ms": 3.5798099395310343, "mean_inference_ms": 0.8786936313321148}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5847552, "num_steps_sampled": 704000, "sample_time_ms": 46686.958, "load_time_ms": 97.571, "grad_time_ms": 19814.662, "update_time_ms": 3.739, "learner": {"cav": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 98.95301055908203, "policy_loss": -0.001183061278425157, "vf_loss": 98.9542007446289, "vf_explained_var": -3.921358349145976e-09, "kl": 0.0014420136576518416, "entropy": 1.397316336631775, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10473162680864334, "policy_loss": -6.0317372117424384e-05, "vf_loss": 0.10479194670915604, "vf_explained_var": 0.9527836441993713, "kl": 0.00034549678093753755, "entropy": 0.9261792898178101, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 704000, "episodes_total": 204, "training_iteration": 40, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-42-35", "timestamp": 1714560155, "time_this_iter_s": 69.70075845718384, "time_total_s": 2753.796998023987, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888f80>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2753.796998023987, "timesteps_since_restore": 704000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 39.625, "ram_util_percent": 77.855}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 87.2425964471708, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 454.73813490981934, "tl": -30.624628205221256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 17.01467998452409, "mean_processing_ms": 3.579809939531034, "mean_inference_ms": 0.878693631332115}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6058752, "num_steps_sampled": 721600, "sample_time_ms": 45809.819, "load_time_ms": 97.899, "grad_time_ms": 19820.432, "update_time_ms": 3.772, "learner": {"cav": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 69.809814453125, "policy_loss": -0.0007323551108129323, "vf_loss": 69.81053924560547, "vf_explained_var": 9.16994569166718e-09, "kl": 0.0006553918938152492, "entropy": 1.4052369594573975, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01905863918364048, "policy_loss": -0.001054313383065164, "vf_loss": 0.02011295221745968, "vf_explained_var": 0.9858005046844482, "kl": 0.015384428203105927, "entropy": 0.9636844396591187, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 721600, "episodes_total": 204, "training_iteration": 41, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-43-36", "timestamp": 1714560216, "time_this_iter_s": 60.792689085006714, "time_total_s": 2814.5896871089935, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2814.5896871089935, "timesteps_since_restore": 721600, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.82183908045977, "ram_util_percent": 77.81379310344825}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 85.94146061939585, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 454.28210740714536, "tl": -30.69505389897964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.97403590243373, "mean_processing_ms": 3.575482473767739, "mean_inference_ms": 0.8786995318160706}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6068224, "num_steps_sampled": 739200, "sample_time_ms": 45798.969, "load_time_ms": 97.922, "grad_time_ms": 19849.428, "update_time_ms": 3.746, "learner": {"tl": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10572578012943268, "policy_loss": -5.208015500102192e-05, "vf_loss": 0.10577786713838577, "vf_explained_var": 0.962007999420166, "kl": 0.0007787775248289108, "entropy": 0.9559838175773621, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 69.5048599243164, "policy_loss": -0.0025432773400098085, "vf_loss": 69.50740051269531, "vf_explained_var": 8.860149947054197e-09, "kl": 0.000882798049133271, "entropy": 1.3962116241455078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 739200, "episodes_total": 212, "training_iteration": 42, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-44-45", "timestamp": 1714560285, "time_this_iter_s": 69.26978158950806, "time_total_s": 2883.8594686985016, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21818b00>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2883.8594686985016, "timesteps_since_restore": 739200, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 40.199999999999996, "ram_util_percent": 77.94591836734693}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 147.18601262397732, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 85.94146061939585, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 454.2821074071453, "tl": -30.69505389897964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.97403590243373, "mean_processing_ms": 3.5754824737677393, "mean_inference_ms": 0.8786995318160704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6279424, "num_steps_sampled": 756800, "sample_time_ms": 45709.709, "load_time_ms": 97.876, "grad_time_ms": 19746.966, "update_time_ms": 3.752, "learner": {"cav": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 134.9380645751953, "policy_loss": -0.00017430416482966393, "vf_loss": 134.938232421875, "vf_explained_var": 9.934107758624577e-09, "kl": 0.0005826827837154269, "entropy": 1.3799189329147339, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01236810628324747, "policy_loss": -0.000634519848972559, "vf_loss": 0.013002623803913593, "vf_explained_var": 0.9874952435493469, "kl": 0.0061117555014789104, "entropy": 0.9695167541503906, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 756800, "episodes_total": 212, "training_iteration": 43, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-45-45", "timestamp": 1714560345, "time_this_iter_s": 59.185492515563965, "time_total_s": 2943.0449612140656, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc8c0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2943.0449612140656, "timesteps_since_restore": 756800, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 38.595294117647065, "ram_util_percent": 77.82705882352938}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -155.75527707962308, "episode_reward_mean": 86.08413277150181, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.29965891363372, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 453.3339855964487, "tl": -30.604154402079438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.936753715967576, "mean_processing_ms": 3.5687570279920466, "mean_inference_ms": 0.8786471165619268}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6490624, "num_steps_sampled": 774400, "sample_time_ms": 45794.895, "load_time_ms": 97.368, "grad_time_ms": 19605.181, "update_time_ms": 3.735, "learner": {"cav": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 86.74462127685547, "policy_loss": -0.00040872584213502705, "vf_loss": 86.74503326416016, "vf_explained_var": -9.494545594179726e-09, "kl": 0.0014248363440856338, "entropy": 1.4110687971115112, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10829247534275055, "policy_loss": -0.00017119811673182994, "vf_loss": 0.10846368968486786, "vf_explained_var": 0.9465368986129761, "kl": 0.0017162126023322344, "entropy": 0.9633978009223938, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 774400, "episodes_total": 220, "training_iteration": 44, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-46-53", "timestamp": 1714560413, "time_this_iter_s": 68.38560819625854, "time_total_s": 3011.430569410324, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f610e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3011.430569410324, "timesteps_since_restore": 774400, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 42.10721649484536, "ram_util_percent": 78.1381443298969}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.99680481243293, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 458.49096496921806, "tl": -30.541180013065958}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.90366421707778, "mean_processing_ms": 3.5649143431870733, "mean_inference_ms": 0.8784040898985797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6498048, "num_steps_sampled": 792000, "sample_time_ms": 46690.188, "load_time_ms": 96.961, "grad_time_ms": 19871.264, "update_time_ms": 3.731, "learner": {"tl": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1038198173046112, "policy_loss": -4.0107315726345405e-05, "vf_loss": 0.10385991632938385, "vf_explained_var": 0.9670221209526062, "kl": 0.0006339308456517756, "entropy": 0.956278383731842, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 65.15849304199219, "policy_loss": -0.0010070664575323462, "vf_loss": 65.15950012207031, "vf_explained_var": -7.193663886795321e-09, "kl": 0.00013860530452802777, "entropy": 1.4011272192001343, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 792000, "episodes_total": 228, "training_iteration": 45, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-48-02", "timestamp": 1714560482, "time_this_iter_s": 69.24473762512207, "time_total_s": 3080.675307035446, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3080.675307035446, "timesteps_since_restore": 792000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 39.723232323232324, "ram_util_percent": 78.03030303030303}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.99680481243293, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 458.49096496921794, "tl": -30.541180013065958}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.90366421707778, "mean_processing_ms": 3.5649143431870733, "mean_inference_ms": 0.8784040898985799}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6709248, "num_steps_sampled": 809600, "sample_time_ms": 45653.136, "load_time_ms": 96.671, "grad_time_ms": 19835.655, "update_time_ms": 3.817, "learner": {"cav": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 98.33100128173828, "policy_loss": -0.0026455954648554325, "vf_loss": 98.33365631103516, "vf_explained_var": -7.774518806513697e-09, "kl": 0.002052063588052988, "entropy": 1.3754386901855469, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.019342904910445213, "policy_loss": -0.0003270063316449523, "vf_loss": 0.0196699108928442, "vf_explained_var": 0.9895421266555786, "kl": 0.00542101263999939, "entropy": 0.9539943337440491, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 809600, "episodes_total": 228, "training_iteration": 46, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-49-02", "timestamp": 1714560542, "time_this_iter_s": 59.998374223709106, "time_total_s": 3140.6736812591553, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218189e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3140.6736812591553, "timesteps_since_restore": 809600, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.591860465116284, "ram_util_percent": 77.90348837209304}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 92.00533974696957, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 458.4870778454109, "tl": -30.54014484153732}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.874151279062232, "mean_processing_ms": 3.5628754589265896, "mean_inference_ms": 0.8779836695535519}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6722560, "num_steps_sampled": 827200, "sample_time_ms": 45700.065, "load_time_ms": 97.376, "grad_time_ms": 19895.96, "update_time_ms": 3.836, "learner": {"tl": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10548413544893265, "policy_loss": -0.00031853647669777274, "vf_loss": 0.10580267012119293, "vf_explained_var": 0.9584906101226807, "kl": 0.004257843364030123, "entropy": 0.9723350405693054, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 65.20755004882812, "policy_loss": 0.0002702190831769258, "vf_loss": 65.207275390625, "vf_explained_var": -1.2035552998668209e-08, "kl": 0.0002920146507676691, "entropy": 1.3679578304290771, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 827200, "episodes_total": 236, "training_iteration": 47, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-50-13", "timestamp": 1714560613, "time_this_iter_s": 70.47706508636475, "time_total_s": 3211.15074634552, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3211.15074634552, "timesteps_since_restore": 827200, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 39.869, "ram_util_percent": 78.09600000000002}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.99741166212608, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 458.1691252261601, "tl": -30.51430946367002}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.84741049914854, "mean_processing_ms": 3.563111932513909, "mean_inference_ms": 0.8773847274256034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6933760, "num_steps_sampled": 844800, "sample_time_ms": 46667.519, "load_time_ms": 97.111, "grad_time_ms": 19869.543, "update_time_ms": 3.832, "learner": {"cav": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 117.38772583007812, "policy_loss": 0.000648274552077055, "vf_loss": 117.38707733154297, "vf_explained_var": 3.0829989672298552e-09, "kl": 0.0005549404886551201, "entropy": 1.3719933032989502, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10695227980613708, "policy_loss": -6.410931382561103e-05, "vf_loss": 0.10701639950275421, "vf_explained_var": 0.9593001008033752, "kl": 0.0007518849452026188, "entropy": 0.9600831270217896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 844800, "episodes_total": 244, "training_iteration": 48, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-51-22", "timestamp": 1714560682, "time_this_iter_s": 69.39982795715332, "time_total_s": 3280.5505743026733, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3280.5505743026733, "timesteps_since_restore": 844800, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 39.86363636363637, "ram_util_percent": 78.12323232323232}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.99741166212607, "episode_len_mean": 3500.0, "episodes_this_iter": 0, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 458.1691252261601, "tl": -30.51430946367002}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.84741049914854, "mean_processing_ms": 3.563111932513909, "mean_inference_ms": 0.8773847274256034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7144960, "num_steps_sampled": 862400, "sample_time_ms": 45713.819, "load_time_ms": 97.329, "grad_time_ms": 19866.587, "update_time_ms": 3.829, "learner": {"cav": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 65.44144439697266, "policy_loss": -0.00043889679363928735, "vf_loss": 65.44188690185547, "vf_explained_var": -3.2511624503683834e-09, "kl": 0.000530538207385689, "entropy": 1.3953348398208618, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0200535599142313, "policy_loss": -0.0003065817872993648, "vf_loss": 0.02036014199256897, "vf_explained_var": 0.9891536235809326, "kl": 0.002212410792708397, "entropy": 0.9373393654823303, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 862400, "episodes_total": 244, "training_iteration": 49, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-52-23", "timestamp": 1714560743, "time_this_iter_s": 60.65059781074524, "time_total_s": 3341.2011721134186, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dce60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3341.2011721134186, "timesteps_since_restore": 862400, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 38.341379310344834, "ram_util_percent": 78.1}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 92.47594730658388, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 457.9037822081763, "tl": -30.452319575133224}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.822011959894507, "mean_processing_ms": 3.56085679060358, "mean_inference_ms": 0.8768814648485322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7155712, "num_steps_sampled": 880000, "sample_time_ms": 45654.604, "load_time_ms": 97.769, "grad_time_ms": 19892.388, "update_time_ms": 3.824, "learner": {"tl": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11377746611833572, "policy_loss": -6.17746845819056e-05, "vf_loss": 0.11383923888206482, "vf_explained_var": 0.9649317860603333, "kl": 0.0011560041457414627, "entropy": 0.9406630396842957, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 73.17163848876953, "policy_loss": 5.46329356438946e-05, "vf_loss": 73.17157745361328, "vf_explained_var": -1.773947744254656e-08, "kl": 0.00012975235586054623, "entropy": 1.4071303606033325, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 880000, "episodes_total": 252, "training_iteration": 50, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-53-32", "timestamp": 1714560812, "time_this_iter_s": 69.3732545375824, "time_total_s": 3410.574426651001, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218883b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3410.574426651001, "timesteps_since_restore": 880000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.86767676767676, "ram_util_percent": 78.23131313131314}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 92.00214469518997, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 457.553570528802, "tl": -30.462618819468194}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.80723523871819, "mean_processing_ms": 3.5605355198579622, "mean_inference_ms": 0.8767508196269787}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7366912, "num_steps_sampled": 897600, "sample_time_ms": 46404.569, "load_time_ms": 97.332, "grad_time_ms": 19857.082, "update_time_ms": 3.794, "learner": {"cav": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 102.13041687011719, "policy_loss": -0.0006655751494690776, "vf_loss": 102.1310806274414, "vf_explained_var": 1.7588256184808415e-08, "kl": 0.0012104071211069822, "entropy": 1.376948356628418, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06656250357627869, "policy_loss": -0.00018726680718827993, "vf_loss": 0.06674976646900177, "vf_explained_var": 0.9600554704666138, "kl": 0.0020205064211040735, "entropy": 0.9351527690887451, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 897600, "episodes_total": 256, "training_iteration": 51, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-54-40", "timestamp": 1714560880, "time_this_iter_s": 67.93433547019958, "time_total_s": 3478.5087621212006, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3478.5087621212006, "timesteps_since_restore": 897600, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 37.13711340206186, "ram_util_percent": 78.2}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.51672036486397, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 457.0397850920057, "tl": -30.460255393929}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.798745294634863, "mean_processing_ms": 3.558618651010637, "mean_inference_ms": 0.8764031381194849}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7578112, "num_steps_sampled": 915200, "sample_time_ms": 46108.004, "load_time_ms": 97.703, "grad_time_ms": 19900.807, "update_time_ms": 3.814, "learner": {"cav": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 68.89764404296875, "policy_loss": -0.00042475262307561934, "vf_loss": 68.89806365966797, "vf_explained_var": -1.079454214902853e-08, "kl": 0.00015553683624602854, "entropy": 1.3723500967025757, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06827137619256973, "policy_loss": -0.0004254468367435038, "vf_loss": 0.06869681924581528, "vf_explained_var": 0.9582449793815613, "kl": 0.006118657533079386, "entropy": 0.9279616475105286, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 915200, "episodes_total": 260, "training_iteration": 52, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-55-47", "timestamp": 1714560947, "time_this_iter_s": 66.74694013595581, "time_total_s": 3545.2557022571564, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc680>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3545.2557022571564, "timesteps_since_restore": 915200, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 39.78842105263158, "ram_util_percent": 78.36421052631579}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.27853487523868, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.920381964787598}, "policy_reward_mean": {"cav": 455.97802256773883, "tl": -30.391623974375513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.776393514618466, "mean_processing_ms": 3.5562080540475085, "mean_inference_ms": 0.8760104152331583}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7587840, "num_steps_sampled": 932800, "sample_time_ms": 47101.383, "load_time_ms": 97.859, "grad_time_ms": 19926.457, "update_time_ms": 3.807, "learner": {"tl": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11409106850624084, "policy_loss": -0.0001320831652265042, "vf_loss": 0.11422314494848251, "vf_explained_var": 0.9668813347816467, "kl": 0.0013636488001793623, "entropy": 0.921995222568512, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 91.3574447631836, "policy_loss": 0.0006948497029952705, "vf_loss": 91.35675048828125, "vf_explained_var": -2.0391063060287706e-08, "kl": 0.00025465257931500673, "entropy": 1.359744668006897, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 932800, "episodes_total": 268, "training_iteration": 53, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-56-56", "timestamp": 1714561016, "time_this_iter_s": 69.37612080574036, "time_total_s": 3614.6318230628967, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc950>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3614.6318230628967, "timesteps_since_restore": 932800, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 40.09191919191919, "ram_util_percent": 78.32929292929292}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.45832853577818, "episode_len_mean": 3500.0, "episodes_this_iter": 2, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.21265459726226, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 455.8298899803469, "tl": -30.364296787047873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.768610434754486, "mean_processing_ms": 3.5560345904802624, "mean_inference_ms": 0.875821225355496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7799040, "num_steps_sampled": 950400, "sample_time_ms": 46709.479, "load_time_ms": 98.219, "grad_time_ms": 20084.674, "update_time_ms": 3.811, "learner": {"cav": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 100.17610168457031, "policy_loss": 0.0016424314817413688, "vf_loss": 100.17445373535156, "vf_explained_var": -5.418604231977042e-09, "kl": 0.0004121129459235817, "entropy": 1.346610426902771, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.043928634375333786, "policy_loss": -0.0001706888433545828, "vf_loss": 0.04409932345151901, "vf_explained_var": 0.9814009070396423, "kl": 0.001865194528363645, "entropy": 0.9288038611412048, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 950400, "episodes_total": 270, "training_iteration": 54, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-58-02", "timestamp": 1714561082, "time_this_iter_s": 66.05077886581421, "time_total_s": 3680.682601928711, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3680.682601928711, "timesteps_since_restore": 950400, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 36.45744680851063, "ram_util_percent": 78.22765957446808}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": -147.2888057355968, "episode_reward_mean": 91.16220048611967, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 249.34899589708377, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 455.2013933670763, "tl": -30.336599406746874}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.75548743044557, "mean_processing_ms": 3.555904212594216, "mean_inference_ms": 0.8755284712799898}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7811328, "num_steps_sampled": 968000, "sample_time_ms": 46648.825, "load_time_ms": 98.339, "grad_time_ms": 20122.713, "update_time_ms": 3.84, "learner": {"tl": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09407104551792145, "policy_loss": -0.00021621155610773712, "vf_loss": 0.09428725391626358, "vf_explained_var": 0.9706812500953674, "kl": 0.0013632860500365496, "entropy": 0.9434882402420044, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 76.24750518798828, "policy_loss": -0.0017537263920530677, "vf_loss": 76.24925994873047, "vf_explained_var": -9.313225746154785e-09, "kl": 0.0018468418857082725, "entropy": 1.3333314657211304, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 968000, "episodes_total": 276, "training_iteration": 55, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_18-59-12", "timestamp": 1714561152, "time_this_iter_s": 69.02020382881165, "time_total_s": 3749.7028057575226, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20d6ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3749.7028057575226, "timesteps_since_restore": 968000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 39.394949494949486, "ram_util_percent": 78.72929292929294}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 45.6764398379441, "episode_reward_mean": 93.01037036047677, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 432.5037170945645, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 457.00832288425386, "tl": -30.33316271031523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.735783787992307, "mean_processing_ms": 3.55629960315077, "mean_inference_ms": 0.8749397647780923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7818752, "num_steps_sampled": 985600, "sample_time_ms": 47876.341, "load_time_ms": 98.676, "grad_time_ms": 20078.681, "update_time_ms": 3.759, "learner": {"tl": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1107320711016655, "policy_loss": -0.00087243557209149, "vf_loss": 0.11160451918840408, "vf_explained_var": 0.9617809057235718, "kl": 0.013439005240797997, "entropy": 0.9402157068252563, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 107.81295776367188, "policy_loss": -0.0008081361884251237, "vf_loss": 107.81376647949219, "vf_explained_var": -1.0276662854025176e-09, "kl": 8.87658097781241e-05, "entropy": 1.3322571516036987, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 985600, "episodes_total": 284, "training_iteration": 56, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-00-23", "timestamp": 1714561223, "time_this_iter_s": 71.83549761772156, "time_total_s": 3821.538303375244, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dce60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3821.538303375244, "timesteps_since_restore": 985600, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 40.44607843137255, "ram_util_percent": 78.79019607843138}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 45.6764398379441, "episode_reward_mean": 92.94001381931443, "episode_len_mean": 3500.0, "episodes_this_iter": 1, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.83922602134356, "tl": -30.32493435016957}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.731541233683433, "mean_processing_ms": 3.556177552639423, "mean_inference_ms": 0.8747743111554648}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8029952, "num_steps_sampled": 1003200, "sample_time_ms": 47561.363, "load_time_ms": 97.718, "grad_time_ms": 20051.354, "update_time_ms": 3.737, "learner": {"cav": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 104.46177673339844, "policy_loss": -9.064319601748139e-05, "vf_loss": 104.46186828613281, "vf_explained_var": 6.478765857131918e-10, "kl": 0.0007209364557638764, "entropy": 1.306485652923584, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04247177764773369, "policy_loss": -1.4896753782522865e-05, "vf_loss": 0.04248667508363724, "vf_explained_var": 0.9832364916801453, "kl": 0.00026881927624344826, "entropy": 0.9382296204566956, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1003200, "episodes_total": 285, "training_iteration": 57, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-01-30", "timestamp": 1714561290, "time_this_iter_s": 67.04162502288818, "time_total_s": 3888.5799283981323, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815d40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3888.5799283981323, "timesteps_since_restore": 1003200, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 35.45729166666667, "ram_util_percent": 78.45416666666667}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 45.6764398379441, "episode_reward_mean": 93.24476110846962, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.9976678492275, "tl": -30.312742228396978}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.716683946252036, "mean_processing_ms": 3.555007708397723, "mean_inference_ms": 0.8743762654039198}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8039296, "num_steps_sampled": 1020800, "sample_time_ms": 47444.661, "load_time_ms": 97.698, "grad_time_ms": 20054.057, "update_time_ms": 3.761, "learner": {"tl": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10746446996927261, "policy_loss": -0.00011441100650699809, "vf_loss": 0.10757888108491898, "vf_explained_var": 0.9684470891952515, "kl": 0.0007163096452131867, "entropy": 0.955027163028717, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 104.94013977050781, "policy_loss": -0.0008656890713609755, "vf_loss": 104.94100189208984, "vf_explained_var": -2.449505931423346e-09, "kl": 0.0002932021743617952, "entropy": 1.3007307052612305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1020800, "episodes_total": 292, "training_iteration": 58, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-02-39", "timestamp": 1714561359, "time_this_iter_s": 68.2593183517456, "time_total_s": 3956.839246749878, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e4b90>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3956.839246749878, "timesteps_since_restore": 1020800, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 39.49278350515464, "ram_util_percent": 78.48247422680411}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 45.6764398379441, "episode_reward_mean": 93.57132195576837, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.1296798454802}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 457.1500912643179, "tl": -30.298230775712945}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.702086079365046, "mean_processing_ms": 3.5545194846621064, "mean_inference_ms": 0.8745671545381054}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8045056, "num_steps_sampled": 1038400, "sample_time_ms": 48429.049, "load_time_ms": 97.968, "grad_time_ms": 19981.777, "update_time_ms": 3.756, "learner": {"tl": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06699705123901367, "policy_loss": -0.0003015033435076475, "vf_loss": 0.06729855388402939, "vf_explained_var": 0.9617067575454712, "kl": 0.0011501931585371494, "entropy": 0.9831180572509766, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 131.36404418945312, "policy_loss": -0.0003255970077589154, "vf_loss": 131.36436462402344, "vf_explained_var": -1.0596381549987655e-08, "kl": 0.0005672420957125723, "entropy": 1.3201693296432495, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1038400, "episodes_total": 296, "training_iteration": 59, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-03-48", "timestamp": 1714561428, "time_this_iter_s": 69.77505540847778, "time_total_s": 4026.6143021583557, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217759e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4026.6143021583557, "timesteps_since_restore": 1038400, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.761, "ram_util_percent": 78.391}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 51.613009180430964, "episode_reward_mean": 94.76280123187838, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.42820995098066, "tl": -33.55690799567928}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.8348722049164, "tl": -30.172672581086946}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.69428117394651, "mean_processing_ms": 3.5527551855454225, "mean_inference_ms": 0.873514012685919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8056320, "num_steps_sampled": 1056000, "sample_time_ms": 48821.88, "load_time_ms": 99.115, "grad_time_ms": 19955.059, "update_time_ms": 3.736, "learner": {"tl": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0938536524772644, "policy_loss": -0.00014609900244977325, "vf_loss": 0.09399974346160889, "vf_explained_var": 0.9672256708145142, "kl": 0.0007822373881936073, "entropy": 0.993261992931366, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 111.25546264648438, "policy_loss": -0.001249164342880249, "vf_loss": 111.2567138671875, "vf_explained_var": 2.031976586991391e-09, "kl": 0.0009813972283154726, "entropy": 1.307291030883789, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1056000, "episodes_total": 301, "training_iteration": 60, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-05-02", "timestamp": 1714561502, "time_this_iter_s": 73.04502892494202, "time_total_s": 4099.659331083298, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20d6ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4099.659331083298, "timesteps_since_restore": 1056000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 35.91346153846154, "ram_util_percent": 78.51250000000002}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 54.26607643603991, "episode_reward_mean": 94.903109937649, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.99363308051164, "tl": -30.17421026190564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.680638557588107, "mean_processing_ms": 3.5515605268675703, "mean_inference_ms": 0.8729583358415293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8063360, "num_steps_sampled": 1073600, "sample_time_ms": 48994.511, "load_time_ms": 99.28, "grad_time_ms": 19920.537, "update_time_ms": 3.799, "learner": {"tl": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11130370944738388, "policy_loss": -0.000515974941663444, "vf_loss": 0.11181967705488205, "vf_explained_var": 0.961803138256073, "kl": 0.007065868936479092, "entropy": 1.0110936164855957, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 119.22374725341797, "policy_loss": -0.0013822597684338689, "vf_loss": 119.22515106201172, "vf_explained_var": -2.167441559564054e-09, "kl": 0.0006819191039539874, "entropy": 1.2929295301437378, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1073600, "episodes_total": 308, "training_iteration": 61, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-06-11", "timestamp": 1714561571, "time_this_iter_s": 69.32227182388306, "time_total_s": 4168.981602907181, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815830>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4168.981602907181, "timesteps_since_restore": 1073600, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 38.98888888888889, "ram_util_percent": 78.57070707070709}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 156.82113503164118, "episode_reward_min": 56.21562950340102, "episode_reward_mean": 95.46150690948335, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 457.1667442476579, "tl": -30.142103111514963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.669538929356438, "mean_processing_ms": 3.5508542643366985, "mean_inference_ms": 0.873051628640398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8070912, "num_steps_sampled": 1091200, "sample_time_ms": 49070.232, "load_time_ms": 99.139, "grad_time_ms": 19830.903, "update_time_ms": 3.785, "learner": {"tl": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05952338129281998, "policy_loss": -0.000752080581150949, "vf_loss": 0.06027545779943466, "vf_explained_var": 0.972395122051239, "kl": 0.011425762437283993, "entropy": 0.9725238084793091, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 117.96623229980469, "policy_loss": -0.0006061957101337612, "vf_loss": 117.96683502197266, "vf_explained_var": 2.8286949671496586e-08, "kl": 0.0001033938315231353, "entropy": 1.3004579544067383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1091200, "episodes_total": 311, "training_iteration": 62, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-07-18", "timestamp": 1714561638, "time_this_iter_s": 66.60497450828552, "time_total_s": 4235.586577415466, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4235.586577415466, "timesteps_since_restore": 1091200, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 37.01157894736842, "ram_util_percent": 78.55263157894741}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 56.21562950340102, "episode_reward_mean": 94.65085231715139, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.65983512601883, "tl": -30.167415234072674}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.66034707419967, "mean_processing_ms": 3.5518347097116645, "mean_inference_ms": 0.8720030224330177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8080640, "num_steps_sampled": 1108800, "sample_time_ms": 49464.733, "load_time_ms": 100.43, "grad_time_ms": 19830.755, "update_time_ms": 3.766, "learner": {"tl": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10600043088197708, "policy_loss": -2.647334804350976e-05, "vf_loss": 0.10602691024541855, "vf_explained_var": 0.9640077352523804, "kl": 0.00015387868916150182, "entropy": 0.9736652374267578, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 112.91661834716797, "policy_loss": -0.0005966247408650815, "vf_loss": 112.9172134399414, "vf_explained_var": 2.2743877892139608e-08, "kl": 0.0002398895303485915, "entropy": 1.2962613105773926, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1108800, "episodes_total": 317, "training_iteration": 63, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-08-31", "timestamp": 1714561711, "time_this_iter_s": 73.33611011505127, "time_total_s": 4308.922687530518, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4308.922687530518, "timesteps_since_restore": 1108800, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 36.51634615384616, "ram_util_percent": 78.58557692307694}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 56.21562950340102, "episode_reward_mean": 93.60182620917827, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.3688569646715, "tl": -30.230585896291473}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.64932812723044, "mean_processing_ms": 3.5518665304961754, "mean_inference_ms": 0.8714174822072632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8291840, "num_steps_sampled": 1126400, "sample_time_ms": 49852.47, "load_time_ms": 100.167, "grad_time_ms": 19801.557, "update_time_ms": 3.773, "learner": {"cav": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 132.67295837402344, "policy_loss": -0.0010437433375045657, "vf_loss": 132.6739959716797, "vf_explained_var": 2.3841858265427618e-08, "kl": 0.00037891368265263736, "entropy": 1.2874079942703247, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08949007093906403, "policy_loss": 1.8914540760306409e-06, "vf_loss": 0.089488185942173, "vf_explained_var": 0.9580735564231873, "kl": 1.676052124821581e-05, "entropy": 0.9714204668998718, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1126400, "episodes_total": 322, "training_iteration": 64, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-09-41", "timestamp": 1714561781, "time_this_iter_s": 69.63222336769104, "time_total_s": 4378.554910898209, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e4170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4378.554910898209, "timesteps_since_restore": 1126400, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.723, "ram_util_percent": 78.661}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 56.21562950340102, "episode_reward_mean": 93.50261596803422, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.6351110690893, "tl": -30.26104125842162}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.641424633500044, "mean_processing_ms": 3.5510890566402584, "mean_inference_ms": 0.871198650851369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8302208, "num_steps_sampled": 1144000, "sample_time_ms": 49858.503, "load_time_ms": 100.227, "grad_time_ms": 19788.665, "update_time_ms": 3.765, "learner": {"tl": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08184339106082916, "policy_loss": -8.395584882237017e-05, "vf_loss": 0.0819273293018341, "vf_explained_var": 0.9690757989883423, "kl": 0.0008744321530684829, "entropy": 0.9612887501716614, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 107.15913391113281, "policy_loss": 0.0007369322702288628, "vf_loss": 107.15839385986328, "vf_explained_var": -6.622738357719982e-09, "kl": 0.0002242702030343935, "entropy": 1.2737144231796265, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1144000, "episodes_total": 326, "training_iteration": 65, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-10-49", "timestamp": 1714561849, "time_this_iter_s": 68.95279169082642, "time_total_s": 4447.507702589035, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4447.507702589035, "timesteps_since_restore": 1144000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 37.142857142857146, "ram_util_percent": 78.65306122448979}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 92.37593767227975, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.5503126855713, "tl": -30.347864584441304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.629143074869447, "mean_processing_ms": 3.551595284961107, "mean_inference_ms": 0.8704383881523495}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8309888, "num_steps_sampled": 1161600, "sample_time_ms": 49996.354, "load_time_ms": 99.826, "grad_time_ms": 19786.616, "update_time_ms": 3.786, "learner": {"tl": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12342913448810577, "policy_loss": -0.000502630602568388, "vf_loss": 0.12393175810575485, "vf_explained_var": 0.9562764763832092, "kl": 0.007849659770727158, "entropy": 0.9751503467559814, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 99.88147735595703, "policy_loss": 0.0011110820341855288, "vf_loss": 99.88038635253906, "vf_explained_var": 5.9604645663569045e-09, "kl": 0.0004024445079267025, "entropy": 1.2907301187515259, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1161600, "episodes_total": 333, "training_iteration": 66, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-12-03", "timestamp": 1714561923, "time_this_iter_s": 73.19085597991943, "time_total_s": 4520.6985585689545, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f613b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4520.6985585689545, "timesteps_since_restore": 1161600, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 38.177142857142854, "ram_util_percent": 78.81142857142856}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 92.37769551021447, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.81363267338367, "tl": -30.36966143026443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.617734941840514, "mean_processing_ms": 3.5516088291095382, "mean_inference_ms": 0.8702852149751719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8521088, "num_steps_sampled": 1179200, "sample_time_ms": 50211.846, "load_time_ms": 99.986, "grad_time_ms": 19741.748, "update_time_ms": 3.825, "learner": {"cav": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 134.74964904785156, "policy_loss": -0.0002595417608972639, "vf_loss": 134.74990844726562, "vf_explained_var": 9.785837029596678e-09, "kl": 0.0002991158689837903, "entropy": 1.2918016910552979, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08077449351549149, "policy_loss": -0.00011681650357786566, "vf_loss": 0.08089129626750946, "vf_explained_var": 0.9664015173912048, "kl": 0.0011193481041118503, "entropy": 0.9690508246421814, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1179200, "episodes_total": 337, "training_iteration": 67, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-13-11", "timestamp": 1714561991, "time_this_iter_s": 68.7503182888031, "time_total_s": 4589.448876857758, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4589.448876857758, "timesteps_since_restore": 1179200, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 36.59489795918367, "ram_util_percent": 78.68061224489797}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 92.52221011818692, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.5684848954932, "tl": -30.33718956477584}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.61140709296634, "mean_processing_ms": 3.550111321019053, "mean_inference_ms": 0.8695926812942502}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8531584, "num_steps_sampled": 1196800, "sample_time_ms": 50597.116, "load_time_ms": 100.257, "grad_time_ms": 19763.203, "update_time_ms": 3.819, "learner": {"tl": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10218316316604614, "policy_loss": -2.5590152290533297e-05, "vf_loss": 0.10220874845981598, "vf_explained_var": 0.9659873843193054, "kl": 0.00022881908807903528, "entropy": 0.9774199724197388, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 94.85548400878906, "policy_loss": 0.00022641278337687254, "vf_loss": 94.85525512695312, "vf_explained_var": 1.889903344931554e-08, "kl": 6.871514779049903e-05, "entropy": 1.3005937337875366, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1196800, "episodes_total": 342, "training_iteration": 68, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-14-24", "timestamp": 1714562064, "time_this_iter_s": 72.32702589035034, "time_total_s": 4661.775902748108, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4661.775902748108, "timesteps_since_restore": 1196800, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 35.991262135922334, "ram_util_percent": 78.70291262135923}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 92.49586302445468, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.0905166244821, "tl": -30.299554466669232}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.599881243974, "mean_processing_ms": 3.5492360065245454, "mean_inference_ms": 0.868538035567802}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8538496, "num_steps_sampled": 1214400, "sample_time_ms": 50845.597, "load_time_ms": 99.96, "grad_time_ms": 19755.274, "update_time_ms": 4.011, "learner": {"tl": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09559373557567596, "policy_loss": -0.0009342603152617812, "vf_loss": 0.09652798622846603, "vf_explained_var": 0.9600819945335388, "kl": 0.01298762671649456, "entropy": 0.988777220249176, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 112.77474975585938, "policy_loss": -0.0012275673216208816, "vf_loss": 112.77597045898438, "vf_explained_var": 1.3245476715439963e-08, "kl": 0.0002597658021841198, "entropy": 1.3052797317504883, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1214400, "episodes_total": 347, "training_iteration": 69, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-15-36", "timestamp": 1714562136, "time_this_iter_s": 72.17952847480774, "time_total_s": 4733.955431222916, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218885f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4733.955431222916, "timesteps_since_restore": 1214400, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.86601941747573, "ram_util_percent": 78.77281553398059}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 92.22520806279773, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.5577102439667, "tl": -30.361041848431025}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.59533682819646, "mean_processing_ms": 3.5494088217442017, "mean_inference_ms": 0.8686035744572643}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8749696, "num_steps_sampled": 1232000, "sample_time_ms": 50765.499, "load_time_ms": 98.595, "grad_time_ms": 19747.492, "update_time_ms": 4.041, "learner": {"cav": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 120.1588134765625, "policy_loss": -0.001081905560567975, "vf_loss": 120.15989685058594, "vf_explained_var": 2.6745674119865726e-08, "kl": 0.0003389479825273156, "entropy": 1.3212486505508423, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0849616751074791, "policy_loss": -0.00016330039943568408, "vf_loss": 0.08512497693300247, "vf_explained_var": 0.9657741189002991, "kl": 0.0015326905995607376, "entropy": 1.0109055042266846, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1232000, "episodes_total": 351, "training_iteration": 70, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-16-48", "timestamp": 1714562208, "time_this_iter_s": 72.15079712867737, "time_total_s": 4806.106228351593, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4806.106228351593, "timesteps_since_restore": 1232000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 35.45145631067961, "ram_util_percent": 78.79223300970874}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 91.30410646133278, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.47442295579515, "tl": -30.430859707872173}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.583768046848608, "mean_processing_ms": 3.548760289152901, "mean_inference_ms": 0.8678766025860238}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8757888, "num_steps_sampled": 1249600, "sample_time_ms": 51357.643, "load_time_ms": 98.499, "grad_time_ms": 19762.033, "update_time_ms": 3.969, "learner": {"tl": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12901023030281067, "policy_loss": -0.00021040583669673651, "vf_loss": 0.1292206346988678, "vf_explained_var": 0.9498530030250549, "kl": 0.002956449519842863, "entropy": 0.9867996573448181, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 107.20166778564453, "policy_loss": 4.5690685510635376e-05, "vf_loss": 107.20162200927734, "vf_explained_var": 2.7939677238464355e-08, "kl": 0.0007613606285303831, "entropy": 1.3167612552642822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1249600, "episodes_total": 358, "training_iteration": 71, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-18-04", "timestamp": 1714562284, "time_this_iter_s": 75.38184714317322, "time_total_s": 4881.488075494766, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217d2cb0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4881.488075494766, "timesteps_since_restore": 1249600, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 36.123364485981305, "ram_util_percent": 78.84485981308408}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 91.28766373439471, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.7331970135813, "tl": -30.453794439932498}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.57605011139102, "mean_processing_ms": 3.5491538528137045, "mean_inference_ms": 0.8677233689172112}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8969088, "num_steps_sampled": 1267200, "sample_time_ms": 51117.382, "load_time_ms": 98.696, "grad_time_ms": 19780.743, "update_time_ms": 3.999, "learner": {"cav": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 134.7273712158203, "policy_loss": -0.0005105488235130906, "vf_loss": 134.7279052734375, "vf_explained_var": 1.3359661821255031e-08, "kl": 0.0008456928189843893, "entropy": 1.3422929048538208, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06545191258192062, "policy_loss": -0.0003460975713096559, "vf_loss": 0.06579800695180893, "vf_explained_var": 0.967663049697876, "kl": 0.002743769669905305, "entropy": 0.9921854138374329, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1267200, "episodes_total": 361, "training_iteration": 72, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-19-08", "timestamp": 1714562348, "time_this_iter_s": 64.39028263092041, "time_total_s": 4945.878358125687, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4945.878358125687, "timesteps_since_restore": 1267200, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 38.67173913043478, "ram_util_percent": 78.81956521739129}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 155.1120755352273, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 90.34557901656031, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 510.22010285915, "tl": -26.84163382677247}, "policy_reward_mean": {"cav": 456.4929196128196, "tl": -30.512278383021865}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.568936190849815, "mean_processing_ms": 3.5480043722569685, "mean_inference_ms": 0.8667857466873251}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8978688, "num_steps_sampled": 1284800, "sample_time_ms": 51114.906, "load_time_ms": 97.443, "grad_time_ms": 19787.714, "update_time_ms": 4.009, "learner": {"tl": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1223822608590126, "policy_loss": -0.000356378557626158, "vf_loss": 0.12273863703012466, "vf_explained_var": 0.9519540667533875, "kl": 0.002624423010274768, "entropy": 0.9919756054878235, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 121.20674133300781, "policy_loss": 0.0006385326269082725, "vf_loss": 121.20610809326172, "vf_explained_var": 1.907348590179936e-08, "kl": 3.3147229260066524e-05, "entropy": 1.3482285737991333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1284800, "episodes_total": 367, "training_iteration": 73, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-20-21", "timestamp": 1714562421, "time_this_iter_s": 73.3650872707367, "time_total_s": 5019.243445396423, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217d2200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5019.243445396423, "timesteps_since_restore": 1284800, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 36.322857142857146, "ram_util_percent": 78.86}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 150.29641586387436, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 90.01938819966304, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 500.1076794419349, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.3975253080327, "tl": -30.531511425697722}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.558471339907964, "mean_processing_ms": 3.548220001007924, "mean_inference_ms": 0.8659026058156611}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8984448, "num_steps_sampled": 1302400, "sample_time_ms": 51380.303, "load_time_ms": 97.235, "grad_time_ms": 19799.463, "update_time_ms": 4.13, "learner": {"tl": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13105465471744537, "policy_loss": -0.00021274335449561477, "vf_loss": 0.13126738369464874, "vf_explained_var": 0.9414374232292175, "kl": 0.0012043968308717012, "entropy": 0.9737530946731567, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 146.45675659179688, "policy_loss": 0.0003148893592879176, "vf_loss": 146.4564666748047, "vf_explained_var": 2.781550101360608e-08, "kl": 0.00010705428576329723, "entropy": 1.3565250635147095, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1302400, "episodes_total": 374, "training_iteration": 74, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-21-34", "timestamp": 1714562494, "time_this_iter_s": 72.4047520160675, "time_total_s": 5091.648197412491, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5091.648197412491, "timesteps_since_restore": 1302400, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 36.77766990291262, "ram_util_percent": 78.8932038834951}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 150.29641586387436, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 90.4682181704641, "episode_len_mean": 3500.0, "episodes_this_iter": 2, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 500.1076794419349, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.64849456910423, "tl": -30.515023033220242}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.55229694945802, "mean_processing_ms": 3.547871557919697, "mean_inference_ms": 0.865797571086455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8992896, "num_steps_sampled": 1320000, "sample_time_ms": 51101.231, "load_time_ms": 97.332, "grad_time_ms": 19768.959, "update_time_ms": 4.127, "learner": {"tl": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05617376044392586, "policy_loss": -0.00018346375145483762, "vf_loss": 0.05635722354054451, "vf_explained_var": 0.9731568694114685, "kl": 0.002890627132728696, "entropy": 0.9507744312286377, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 120.59815216064453, "policy_loss": -0.00020759688050020486, "vf_loss": 120.59835052490234, "vf_explained_var": 3.2511625391862253e-08, "kl": 0.0001172341508208774, "entropy": 1.3470925092697144, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1320000, "episodes_total": 376, "training_iteration": 75, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-22-40", "timestamp": 1714562560, "time_this_iter_s": 65.85993218421936, "time_total_s": 5157.50812959671, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217d2c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5157.50812959671, "timesteps_since_restore": 1320000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 36.68404255319149, "ram_util_percent": 78.8478723404255}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.7991473538496, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 90.3699758721314, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.42820995098066, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 500.1076794419349, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.6252283840406, "tl": -30.52127104265932}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.546062483101885, "mean_processing_ms": 3.5467132821638603, "mean_inference_ms": 0.8648469658876953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9001856, "num_steps_sampled": 1337600, "sample_time_ms": 50567.449, "load_time_ms": 97.295, "grad_time_ms": 19772.994, "update_time_ms": 4.263, "learner": {"tl": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12587016820907593, "policy_loss": -6.559610483236611e-05, "vf_loss": 0.12593576312065125, "vf_explained_var": 0.9554982781410217, "kl": 0.00031538918847218156, "entropy": 0.9578074216842651, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 102.15316009521484, "policy_loss": -0.0013749509816989303, "vf_loss": 102.15453338623047, "vf_explained_var": 2.72478377638663e-08, "kl": 0.0004227797326166183, "entropy": 1.3387031555175781, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1337600, "episodes_total": 382, "training_iteration": 76, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-23-48", "timestamp": 1714562628, "time_this_iter_s": 67.8956413269043, "time_total_s": 5225.4037709236145, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ef80>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5225.4037709236145, "timesteps_since_restore": 1337600, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 39.077319587628864, "ram_util_percent": 78.95876288659794}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.7991473538496, "episode_reward_min": 45.62400429540685, "episode_reward_mean": 89.6301526586285, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.2686498159875}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.21838680615167, "tl": -30.549019512293818}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.535666995415667, "mean_processing_ms": 3.5447590066802968, "mean_inference_ms": 0.864001406812477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9007616, "num_steps_sampled": 1355200, "sample_time_ms": 50657.114, "load_time_ms": 97.838, "grad_time_ms": 19771.464, "update_time_ms": 4.234, "learner": {"tl": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10762333124876022, "policy_loss": -0.00011321472265990451, "vf_loss": 0.10773655027151108, "vf_explained_var": 0.9348294734954834, "kl": 0.00175485759973526, "entropy": 0.9693464636802673, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 163.9999542236328, "policy_loss": -0.0007897848845459521, "vf_loss": 164.00074768066406, "vf_explained_var": 2.3841858265427618e-08, "kl": 5.140250868862495e-05, "entropy": 1.3407598733901978, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1355200, "episodes_total": 387, "training_iteration": 77, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-24-57", "timestamp": 1714562697, "time_this_iter_s": 69.63789916038513, "time_total_s": 5295.041670084, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217d2d40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5295.041670084, "timesteps_since_restore": 1355200, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 37.143434343434336, "ram_util_percent": 78.96666666666667}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.7991473538496, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 88.92921216682535, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.811782038337, "tl": -30.65688082262619}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.52837139935422, "mean_processing_ms": 3.545146175745445, "mean_inference_ms": 0.8636715271500269}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9218816, "num_steps_sampled": 1372800, "sample_time_ms": 50721.293, "load_time_ms": 97.811, "grad_time_ms": 19764.447, "update_time_ms": 4.244, "learner": {"cav": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 121.80174255371094, "policy_loss": 0.00010190429748035967, "vf_loss": 121.8016586303711, "vf_explained_var": 4.0252487565339834e-08, "kl": 0.00035046529956161976, "entropy": 1.3458590507507324, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11023787409067154, "policy_loss": -5.5065589549485594e-05, "vf_loss": 0.1102929413318634, "vf_explained_var": 0.9547321200370789, "kl": 0.00040682480903342366, "entropy": 0.9581637382507324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1372800, "episodes_total": 392, "training_iteration": 78, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-26-10", "timestamp": 1714562770, "time_this_iter_s": 72.9027988910675, "time_total_s": 5367.944468975067, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5367.944468975067, "timesteps_since_restore": 1372800, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.74519230769231, "ram_util_percent": 79.01057692307693}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.7991473538496, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 88.21427538145383, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.5710542660514, "tl": -30.696398240383346}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.522991198065657, "mean_processing_ms": 3.5450055614933653, "mean_inference_ms": 0.8627219964553815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9225984, "num_steps_sampled": 1390400, "sample_time_ms": 50255.915, "load_time_ms": 97.64, "grad_time_ms": 19795.311, "update_time_ms": 4.046, "learner": {"tl": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13257549703121185, "policy_loss": -0.0007860244368202984, "vf_loss": 0.13336151838302612, "vf_explained_var": 0.9497407674789429, "kl": 0.005414525978267193, "entropy": 1.009116768836975, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 115.6662826538086, "policy_loss": -0.001178050646558404, "vf_loss": 115.66746520996094, "vf_explained_var": 1.915863556689601e-08, "kl": 0.0005842415848746896, "entropy": 1.358519434928894, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1390400, "episodes_total": 398, "training_iteration": 79, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-27-18", "timestamp": 1714562838, "time_this_iter_s": 67.83017301559448, "time_total_s": 5435.774641990662, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217d2440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5435.774641990662, "timesteps_since_restore": 1390400, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 39.085567010309276, "ram_util_percent": 79.10824742268042}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.7991473538496, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 88.21830838581644, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.0317983387993, "tl": -30.73445749608213}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.5171889173784, "mean_processing_ms": 3.544709741680303, "mean_inference_ms": 0.862919002472226}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9233024, "num_steps_sampled": 1408000, "sample_time_ms": 50009.603, "load_time_ms": 98.099, "grad_time_ms": 19758.234, "update_time_ms": 4.003, "learner": {"tl": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07562202215194702, "policy_loss": -0.00013313510862644762, "vf_loss": 0.07575515657663345, "vf_explained_var": 0.953877866268158, "kl": 0.002110061701387167, "entropy": 1.0028783082962036, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 138.36891174316406, "policy_loss": -0.0014696167781949043, "vf_loss": 138.37037658691406, "vf_explained_var": 2.0590695370970025e-08, "kl": 0.0010210521286353469, "entropy": 1.3589071035385132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1408000, "episodes_total": 401, "training_iteration": 80, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-28-27", "timestamp": 1714562907, "time_this_iter_s": 69.3231794834137, "time_total_s": 5505.097821474075, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5505.097821474075, "timesteps_since_restore": 1408000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 35.80505050505051, "ram_util_percent": 79.11111111111111}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 88.9202087796234, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.8100777536066, "tl": -30.657489081165508}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.506908239052404, "mean_processing_ms": 3.5433793623694343, "mean_inference_ms": 0.8616312213197794}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9240960, "num_steps_sampled": 1425600, "sample_time_ms": 49733.395, "load_time_ms": 98.142, "grad_time_ms": 19778.111, "update_time_ms": 4.002, "learner": {"tl": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1498613804578781, "policy_loss": -0.00012540383613668382, "vf_loss": 0.14998677372932434, "vf_explained_var": 0.9363503456115723, "kl": 0.0009740264504216611, "entropy": 1.0210646390914917, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 133.6999969482422, "policy_loss": -0.0007863445789553225, "vf_loss": 133.7007598876953, "vf_explained_var": 1.1536382515942023e-08, "kl": 0.0006787603488191962, "entropy": 1.3332912921905518, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1425600, "episodes_total": 408, "training_iteration": 81, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-29-40", "timestamp": 1714562980, "time_this_iter_s": 72.82093667984009, "time_total_s": 5577.918758153915, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5577.918758153915, "timesteps_since_restore": 1425600, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 37.142307692307696, "ram_util_percent": 79.09711538461539}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 88.83927468416665, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.516164505833, "tl": -30.639740818472433}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.503088682226572, "mean_processing_ms": 3.5430809506015346, "mean_inference_ms": 0.860525899179472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9246976, "num_steps_sampled": 1443200, "sample_time_ms": 50275.538, "load_time_ms": 98.394, "grad_time_ms": 19764.017, "update_time_ms": 3.986, "learner": {"tl": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10866548120975494, "policy_loss": -4.225261363899335e-05, "vf_loss": 0.1087077409029007, "vf_explained_var": 0.9433481097221375, "kl": 0.0002698479511309415, "entropy": 1.0109167098999023, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 141.4951934814453, "policy_loss": 0.0006036276463419199, "vf_loss": 141.49461364746094, "vf_explained_var": 3.2972781838225274e-08, "kl": 0.00030704058008268476, "entropy": 1.3256398439407349, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1443200, "episodes_total": 413, "training_iteration": 82, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-30-50", "timestamp": 1714563050, "time_this_iter_s": 69.67368483543396, "time_total_s": 5647.592442989349, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61710>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5647.592442989349, "timesteps_since_restore": 1443200, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 36.95151515151515, "ram_util_percent": 79.09292929292931}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 89.65039002274646, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.2338018507255, "tl": -30.63195098566517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.499159547801394, "mean_processing_ms": 3.5432688923439395, "mean_inference_ms": 0.8608883753796595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9254272, "num_steps_sampled": 1460800, "sample_time_ms": 49354.737, "load_time_ms": 98.583, "grad_time_ms": 19715.836, "update_time_ms": 4.035, "learner": {"tl": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07387170195579529, "policy_loss": -9.072860120795667e-05, "vf_loss": 0.07396242767572403, "vf_explained_var": 0.9605893492698669, "kl": 0.0006790209445171058, "entropy": 1.0303621292114258, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 137.9539337158203, "policy_loss": -0.002861569169908762, "vf_loss": 137.956787109375, "vf_explained_var": 3.8690735948421207e-08, "kl": 0.0009109909296967089, "entropy": 1.3296390771865845, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1460800, "episodes_total": 416, "training_iteration": 83, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-31-54", "timestamp": 1714563114, "time_this_iter_s": 63.677937030792236, "time_total_s": 5711.270380020142, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218153b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5711.270380020142, "timesteps_since_restore": 1460800, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 38.95384615384615, "ram_util_percent": 79.13846153846153}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 89.77431674893387, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.60154314138094, "tl": -30.56893553270417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.49441994296608, "mean_processing_ms": 3.541975451278739, "mean_inference_ms": 0.8601317450066693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9261568, "num_steps_sampled": 1478400, "sample_time_ms": 48916.855, "load_time_ms": 98.655, "grad_time_ms": 19719.169, "update_time_ms": 3.887, "learner": {"tl": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13119953870773315, "policy_loss": -3.4839096770156175e-05, "vf_loss": 0.13123437762260437, "vf_explained_var": 0.9284271597862244, "kl": 0.000618308549746871, "entropy": 1.0228694677352905, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 142.32391357421875, "policy_loss": -0.00017076678341254592, "vf_loss": 142.32406616210938, "vf_explained_var": 3.1370866793167806e-08, "kl": 0.00010582136746961623, "entropy": 1.327733039855957, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1478400, "episodes_total": 422, "training_iteration": 84, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-33-02", "timestamp": 1714563182, "time_this_iter_s": 68.0577437877655, "time_total_s": 5779.328123807907, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f610e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5779.328123807907, "timesteps_since_restore": 1478400, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 38.91752577319588, "ram_util_percent": 79.13195876288661}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 91.63139249662021, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.06147847482094, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.49519986192644, "tl": -30.4053172804424}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.483823811874945, "mean_processing_ms": 3.5412049825825935, "mean_inference_ms": 0.858566474277202}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9266944, "num_steps_sampled": 1496000, "sample_time_ms": 49577.067, "load_time_ms": 98.613, "grad_time_ms": 19695.695, "update_time_ms": 4.1, "learner": {"tl": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.146852508187294, "policy_loss": -0.0003342253912705928, "vf_loss": 0.14718672633171082, "vf_explained_var": 0.9164522886276245, "kl": 0.004892885684967041, "entropy": 0.9979814887046814, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 146.04486083984375, "policy_loss": -0.0003653656458482146, "vf_loss": 146.04522705078125, "vf_explained_var": 2.1287373641598606e-08, "kl": 0.0003979943285230547, "entropy": 1.308301329612732, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1496000, "episodes_total": 429, "training_iteration": 85, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-34-14", "timestamp": 1714563254, "time_this_iter_s": 72.22998023033142, "time_total_s": 5851.5581040382385, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218884d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5851.5581040382385, "timesteps_since_restore": 1496000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 36.705825242718454, "ram_util_percent": 79.12427184466023}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 92.18447467660437, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.2138243475186, "tl": -30.41911247257643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.48030074413456, "mean_processing_ms": 3.5418669482405702, "mean_inference_ms": 0.858924385149754}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9274240, "num_steps_sampled": 1513600, "sample_time_ms": 49256.674, "load_time_ms": 99.38, "grad_time_ms": 19696.351, "update_time_ms": 4.093, "learner": {"tl": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08212617039680481, "policy_loss": -9.295000927522779e-05, "vf_loss": 0.08221912384033203, "vf_explained_var": 0.9571224451065063, "kl": 0.0004712141235359013, "entropy": 1.0103933811187744, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 147.6576690673828, "policy_loss": 0.0008004187257029116, "vf_loss": 147.6568603515625, "vf_explained_var": 1.0456955301663129e-08, "kl": 0.00014405939145945013, "entropy": 1.310497522354126, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1513600, "episodes_total": 432, "training_iteration": 86, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-35-19", "timestamp": 1714563319, "time_this_iter_s": 64.70458889007568, "time_total_s": 5916.262692928314, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5916.262692928314, "timesteps_since_restore": 1513600, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 38.50645161290323, "ram_util_percent": 79.14193548387097}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 90.8007521116272, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.52058743750524, "tl": -30.47665294382341}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.47643255474674, "mean_processing_ms": 3.5399717921861797, "mean_inference_ms": 0.8579803392058354}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9282560, "num_steps_sampled": 1531200, "sample_time_ms": 48920.282, "load_time_ms": 98.8, "grad_time_ms": 19719.136, "update_time_ms": 4.05, "learner": {"tl": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12182564288377762, "policy_loss": -9.520848834654316e-05, "vf_loss": 0.12192085385322571, "vf_explained_var": 0.939585268497467, "kl": 0.0016692242352291942, "entropy": 1.0265934467315674, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 124.86762237548828, "policy_loss": 5.660332317347638e-05, "vf_loss": 124.86756896972656, "vf_explained_var": 4.58497284583359e-09, "kl": 0.0004214534710627049, "entropy": 1.2950232028961182, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1531200, "episodes_total": 437, "training_iteration": 87, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-36-25", "timestamp": 1714563385, "time_this_iter_s": 66.49261474609375, "time_total_s": 5982.755307674408, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f60dd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5982.755307674408, "timesteps_since_restore": 1531200, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 39.638297872340424, "ram_util_percent": 79.26170212765958}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 90.0379103635164, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.99911843069816, "tl": -30.58010067226539}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.46819758070727, "mean_processing_ms": 3.539761809278712, "mean_inference_ms": 0.8578601949216135}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9287552, "num_steps_sampled": 1548800, "sample_time_ms": 48571.718, "load_time_ms": 98.779, "grad_time_ms": 19670.722, "update_time_ms": 4.031, "learner": {"tl": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11254625767469406, "policy_loss": -0.0001999692467506975, "vf_loss": 0.1127462238073349, "vf_explained_var": 0.9122667908668518, "kl": 0.001630942802876234, "entropy": 1.0395121574401855, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 150.07073974609375, "policy_loss": 0.00108581711538136, "vf_loss": 150.0696563720703, "vf_explained_var": 4.2793079302327897e-08, "kl": 6.377050885930657e-05, "entropy": 1.2948862314224243, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1548800, "episodes_total": 442, "training_iteration": 88, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-37-34", "timestamp": 1714563454, "time_this_iter_s": 68.93508243560791, "time_total_s": 6051.690390110016, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6051.690390110016, "timesteps_since_restore": 1548800, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 37.18484848484849, "ram_util_percent": 79.3131313131313}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 89.60158770995486, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.1878728479826, "tl": -30.632190428169245}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.463104123137082, "mean_processing_ms": 3.539590891915218, "mean_inference_ms": 0.856948859207704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9294720, "num_steps_sampled": 1566400, "sample_time_ms": 49012.842, "load_time_ms": 99.332, "grad_time_ms": 19643.958, "update_time_ms": 4.424, "learner": {"tl": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13882628083229065, "policy_loss": -9.20485399547033e-05, "vf_loss": 0.13891832530498505, "vf_explained_var": 0.9217830896377563, "kl": 0.00037292568595148623, "entropy": 1.047215223312378, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 154.21751403808594, "policy_loss": -0.0001776505814632401, "vf_loss": 154.2176971435547, "vf_explained_var": 4.6832219879888726e-08, "kl": 0.0004187145095784217, "entropy": 1.3092199563980103, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1566400, "episodes_total": 448, "training_iteration": 89, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-38-46", "timestamp": 1714563526, "time_this_iter_s": 71.98187112808228, "time_total_s": 6123.672261238098, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6123.672261238098, "timesteps_since_restore": 1566400, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 36.65392156862745, "ram_util_percent": 79.26666666666667}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 149.7116203641968, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 89.56129559743717, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.53819932843834, "tl": -30.58140864425033}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.459665146986694, "mean_processing_ms": 3.5389878513520983, "mean_inference_ms": 0.8559492250201808}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9301248, "num_steps_sampled": 1584000, "sample_time_ms": 48635.385, "load_time_ms": 99.605, "grad_time_ms": 19658.709, "update_time_ms": 4.711, "learner": {"tl": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11512651294469833, "policy_loss": -0.0003050682134926319, "vf_loss": 0.11543157696723938, "vf_explained_var": 0.939743161201477, "kl": 0.002034842735156417, "entropy": 1.0136128664016724, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 156.6596221923828, "policy_loss": -0.002090663881972432, "vf_loss": 156.66171264648438, "vf_explained_var": 3.3892838757765276e-08, "kl": 0.0006205033278092742, "entropy": 1.3303370475769043, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1584000, "episodes_total": 453, "training_iteration": 90, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-39-52", "timestamp": 1714563592, "time_this_iter_s": 65.6997983455658, "time_total_s": 6189.372059583664, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6189.372059583664, "timesteps_since_restore": 1584000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 39.27446808510638, "ram_util_percent": 79.35957446808509}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 90.71070542547761, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.4757923641814, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.1954781741067, "tl": -30.54039772905265}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.45557105776205, "mean_processing_ms": 3.5391047181861164, "mean_inference_ms": 0.8558574050359795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9308032, "num_steps_sampled": 1601600, "sample_time_ms": 47809.664, "load_time_ms": 99.707, "grad_time_ms": 19611.098, "update_time_ms": 4.746, "learner": {"tl": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0781455859541893, "policy_loss": -0.00018349979654885828, "vf_loss": 0.07832908630371094, "vf_explained_var": 0.9463426470756531, "kl": 0.0016000731848180294, "entropy": 0.9951934814453125, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 147.71286010742188, "policy_loss": -0.001266650389879942, "vf_loss": 147.71414184570312, "vf_explained_var": 2.5866166097898713e-08, "kl": 0.0010694297961890697, "entropy": 1.3153798580169678, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1601600, "episodes_total": 456, "training_iteration": 91, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-40-56", "timestamp": 1714563656, "time_this_iter_s": 64.08705496788025, "time_total_s": 6253.459114551544, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218155f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6253.459114551544, "timesteps_since_restore": 1601600, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 38.59021739130434, "ram_util_percent": 79.32391304347823}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 91.72703517940383, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.6273286136788, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.1673725077801, "tl": -30.453361444031554}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.44772727408723, "mean_processing_ms": 3.537459334823444, "mean_inference_ms": 0.8546697756224185}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9519232, "num_steps_sampled": 1619200, "sample_time_ms": 48097.91, "load_time_ms": 99.379, "grad_time_ms": 19627.746, "update_time_ms": 4.714, "learner": {"cav": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 152.66744995117188, "policy_loss": 0.0010555546032264829, "vf_loss": 152.66636657714844, "vf_explained_var": 2.1287373641598606e-08, "kl": 0.00017789255070965737, "entropy": 1.306717872619629, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16033251583576202, "policy_loss": -2.297285755048506e-05, "vf_loss": 0.16035546362400055, "vf_explained_var": 0.916325032711029, "kl": 0.00046315081999637187, "entropy": 1.00291109085083, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1619200, "episodes_total": 463, "training_iteration": 92, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-42-09", "timestamp": 1714563729, "time_this_iter_s": 72.72019839286804, "time_total_s": 6326.179312944412, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f60dd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6326.179312944412, "timesteps_since_restore": 1619200, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 37.3747572815534, "ram_util_percent": 79.404854368932}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 91.69719284501421, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.6273286136788, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 456.79984314293944, "tl": -30.425220858160635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.442028150193025, "mean_processing_ms": 3.5373113758483106, "mean_inference_ms": 0.8542431338869624}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9524096, "num_steps_sampled": 1636800, "sample_time_ms": 48635.371, "load_time_ms": 99.002, "grad_time_ms": 19625.742, "update_time_ms": 4.668, "learner": {"tl": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11833517253398895, "policy_loss": -6.387392932083458e-05, "vf_loss": 0.11839904636144638, "vf_explained_var": 0.9203373789787292, "kl": 0.0009681481751613319, "entropy": 1.004588007926941, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 153.96884155273438, "policy_loss": -0.0017592065269127488, "vf_loss": 153.97059631347656, "vf_explained_var": 2.8233779758579658e-08, "kl": 0.0004545011033769697, "entropy": 1.3049789667129517, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1636800, "episodes_total": 468, "training_iteration": 93, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-43-18", "timestamp": 1714563798, "time_this_iter_s": 69.02656579017639, "time_total_s": 6395.205878734589, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6395.205878734589, "timesteps_since_restore": 1636800, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 37.22020202020202, "ram_util_percent": 79.40101010101009}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 91.89703932997121, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.6273286136788, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -26.550262923411186}, "policy_reward_mean": {"cav": 457.20498096871336, "tl": -30.442328469895376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.439750210920362, "mean_processing_ms": 3.5375060152506195, "mean_inference_ms": 0.8538397144309817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9531392, "num_steps_sampled": 1654400, "sample_time_ms": 48344.121, "load_time_ms": 98.83, "grad_time_ms": 19639.74, "update_time_ms": 4.845, "learner": {"tl": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10137881338596344, "policy_loss": -0.0002449409803375602, "vf_loss": 0.10162375867366791, "vf_explained_var": 0.9407729506492615, "kl": 0.004160480108112097, "entropy": 0.9861510992050171, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 150.2104034423828, "policy_loss": 0.0018314763437956572, "vf_loss": 150.2085723876953, "vf_explained_var": 3.0325171707090703e-08, "kl": 0.0005404636031016707, "entropy": 1.2832038402557373, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1654400, "episodes_total": 472, "training_iteration": 94, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-44-23", "timestamp": 1714563863, "time_this_iter_s": 65.28617334365845, "time_total_s": 6460.492052078247, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218150e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6460.492052078247, "timesteps_since_restore": 1654400, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 38.947311827956995, "ram_util_percent": 79.4064516129032}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 90.86810413815118, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.6273286136788, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.266058162763, "tl": -30.44982950205121}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.433553890237615, "mean_processing_ms": 3.536007263893647, "mean_inference_ms": 0.8524522323917607}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9538688, "num_steps_sampled": 1672000, "sample_time_ms": 48443.838, "load_time_ms": 98.481, "grad_time_ms": 19663.85, "update_time_ms": 4.652, "learner": {"tl": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14328427612781525, "policy_loss": -0.00015605738735757768, "vf_loss": 0.1434403508901596, "vf_explained_var": 0.9214781522750854, "kl": 0.001465060980990529, "entropy": 0.9699957370758057, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 125.66429901123047, "policy_loss": 0.000594098586589098, "vf_loss": 125.6636962890625, "vf_explained_var": 2.509669272399151e-08, "kl": 1.4764125808142126e-05, "entropy": 1.2806775569915771, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1672000, "episodes_total": 478, "training_iteration": 95, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-45-36", "timestamp": 1714563936, "time_this_iter_s": 73.45924973487854, "time_total_s": 6533.951301813126, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815680>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6533.951301813126, "timesteps_since_restore": 1672000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 36.388571428571424, "ram_util_percent": 79.42476190476191}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 91.37820135175065, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.6273286136788, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.5695618795867, "tl": -30.432613377319868}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.426954359293735, "mean_processing_ms": 3.535912238024129, "mean_inference_ms": 0.8523139308287202}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9544576, "num_steps_sampled": 1689600, "sample_time_ms": 48927.689, "load_time_ms": 98.104, "grad_time_ms": 19637.216, "update_time_ms": 4.493, "learner": {"tl": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11581379920244217, "policy_loss": -0.0005378750502131879, "vf_loss": 0.1163516715168953, "vf_explained_var": 0.9177429676055908, "kl": 0.008067877031862736, "entropy": 0.9378297924995422, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 154.39089965820312, "policy_loss": -0.00047421391354873776, "vf_loss": 154.39137268066406, "vf_explained_var": 9.070271644873173e-09, "kl": 0.0002786932745948434, "entropy": 1.2856601476669312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1689600, "episodes_total": 483, "training_iteration": 96, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-46-46", "timestamp": 1714564006, "time_this_iter_s": 69.270024061203, "time_total_s": 6603.221325874329, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815cb0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6603.221325874329, "timesteps_since_restore": 1689600, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 37.01616161616162, "ram_util_percent": 79.45959595959597}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 41.250181196884114, "episode_reward_mean": 92.06931592154619, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.6273286136788, "tl": -34.44758437579692}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 457.13953742195713, "tl": -30.422518458367765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.428544501316825, "mean_processing_ms": 3.5368775922064515, "mean_inference_ms": 0.8520693616284278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9552128, "num_steps_sampled": 1707200, "sample_time_ms": 48830.609, "load_time_ms": 98.0, "grad_time_ms": 19618.835, "update_time_ms": 4.545, "learner": {"tl": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10473345220088959, "policy_loss": -0.00022145264665596187, "vf_loss": 0.10495490580797195, "vf_explained_var": 0.9434499144554138, "kl": 0.0034824260510504246, "entropy": 0.9061657190322876, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 130.63095092773438, "policy_loss": -0.001261817174963653, "vf_loss": 130.6322021484375, "vf_explained_var": 1.2122978176876131e-08, "kl": 0.00029958190862089396, "entropy": 1.298701524734497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1707200, "episodes_total": 487, "training_iteration": 97, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-47-51", "timestamp": 1714564071, "time_this_iter_s": 65.33823204040527, "time_total_s": 6668.559557914734, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218885f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6668.559557914734, "timesteps_since_restore": 1707200, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 39.047311827956996, "ram_util_percent": 79.48064516129033}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": 30.98212928353916, "episode_reward_mean": 89.62756605556257, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.6273286136788, "tl": -36.465038315821516}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.31767163900287, "tl": -30.557508798620226}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.422553207207397, "mean_processing_ms": 3.535759831961439, "mean_inference_ms": 0.8510056663587163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9559552, "num_steps_sampled": 1724800, "sample_time_ms": 49342.099, "load_time_ms": 97.802, "grad_time_ms": 19619.198, "update_time_ms": 4.544, "learner": {"tl": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16117864847183228, "policy_loss": -1.484552967667696e-06, "vf_loss": 0.16118010878562927, "vf_explained_var": 0.9139906167984009, "kl": 5.976992906653322e-05, "entropy": 0.9116747975349426, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 132.35726928710938, "policy_loss": -0.0012787490850314498, "vf_loss": 132.35855102539062, "vf_explained_var": 1.644266056644028e-08, "kl": 3.811550050158985e-05, "entropy": 1.3039233684539795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1724800, "episodes_total": 493, "training_iteration": 98, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-49-05", "timestamp": 1714564145, "time_this_iter_s": 74.04693579673767, "time_total_s": 6742.606493711472, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6742.606493711472, "timesteps_since_restore": 1724800, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 36.45238095238095, "ram_util_percent": 79.50761904761906}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -19.235525311526818, "episode_reward_mean": 85.50212726025237, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.6273286136788, "tl": -38.74351002339045}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.5742477919112, "tl": -30.92267671097177}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.413886317168128, "mean_processing_ms": 3.535030034000999, "mean_inference_ms": 0.8503922408929402}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9770752, "num_steps_sampled": 1742400, "sample_time_ms": 49387.338, "load_time_ms": 97.414, "grad_time_ms": 19629.545, "update_time_ms": 4.153, "learner": {"cav": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 136.98426818847656, "policy_loss": -0.0011610492365434766, "vf_loss": 136.9854278564453, "vf_explained_var": 4.135832654128535e-08, "kl": 6.0396640037652105e-05, "entropy": 1.3015137910842896, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15346801280975342, "policy_loss": -0.000152098189573735, "vf_loss": 0.15362010896205902, "vf_explained_var": 0.9182738661766052, "kl": 0.0008721713093109429, "entropy": 0.936480700969696, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1742400, "episodes_total": 499, "training_iteration": 99, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-50-18", "timestamp": 1714564218, "time_this_iter_s": 72.53252291679382, "time_total_s": 6815.139016628265, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6815.139016628265, "timesteps_since_restore": 1742400, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 36.535576923076924, "ram_util_percent": 79.71153846153844}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -19.235525311526818, "episode_reward_mean": 81.89880454122319, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.6273286136788, "tl": -40.14243507150742}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 455.8361150319859, "tl": -31.16144254089709}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.41736098051707, "mean_processing_ms": 3.5352740549174695, "mean_inference_ms": 0.8495061196986904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9777920, "num_steps_sampled": 1760000, "sample_time_ms": 49274.243, "load_time_ms": 96.553, "grad_time_ms": 19630.619, "update_time_ms": 3.926, "learner": {"tl": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08513595908880234, "policy_loss": -0.0011126073077321053, "vf_loss": 0.08624857664108276, "vf_explained_var": 0.9514792561531067, "kl": 0.017518674954771996, "entropy": 0.8604909181594849, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 140.860595703125, "policy_loss": -0.0015410669147968292, "vf_loss": 140.86215209960938, "vf_explained_var": 2.0223003716068888e-08, "kl": 0.000218808141653426, "entropy": 1.3028011322021484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1760000, "episodes_total": 502, "training_iteration": 100, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-51-22", "timestamp": 1714564282, "time_this_iter_s": 64.56827688217163, "time_total_s": 6879.707293510437, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218157a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6879.707293510437, "timesteps_since_restore": 1760000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 38.95869565217391, "ram_util_percent": 79.66847826086958}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -38.908766709447406, "episode_reward_mean": 77.37018277529135, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.6273286136788, "tl": -41.16679741381268}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.4036439604801, "tl": -31.586121765432555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.411318466171135, "mean_processing_ms": 3.5348616425802875, "mean_inference_ms": 0.8497311787777783}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9785856, "num_steps_sampled": 1777600, "sample_time_ms": 49656.431, "load_time_ms": 96.381, "grad_time_ms": 19650.626, "update_time_ms": 3.888, "learner": {"tl": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16846011579036713, "policy_loss": -0.00026558589888736606, "vf_loss": 0.16872569918632507, "vf_explained_var": 0.9180289506912231, "kl": 0.003512932453304529, "entropy": 0.9013122916221619, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 141.2413787841797, "policy_loss": -0.002380459336563945, "vf_loss": 141.24374389648438, "vf_explained_var": 0.0, "kl": 0.00039951680810190737, "entropy": 1.3038872480392456, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1777600, "episodes_total": 507, "training_iteration": 101, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-52-30", "timestamp": 1714564350, "time_this_iter_s": 68.10764360427856, "time_total_s": 6947.814937114716, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20d6ef80>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6947.814937114716, "timesteps_since_restore": 1777600, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 39.36288659793814, "ram_util_percent": 79.62886597938144}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 63.153785450192146, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.6273286136788, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.15611222601655, "tl": -32.75019389798552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.407812993033584, "mean_processing_ms": 3.5345556595539858, "mean_inference_ms": 0.8486211224269438}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9997056, "num_steps_sampled": 1795200, "sample_time_ms": 49857.358, "load_time_ms": 95.988, "grad_time_ms": 19645.087, "update_time_ms": 3.906, "learner": {"cav": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 140.253662109375, "policy_loss": -0.0012980216415598989, "vf_loss": 140.2549591064453, "vf_explained_var": -1.4537718584506365e-08, "kl": 0.00017674932314548641, "entropy": 1.317289113998413, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20151714980602264, "policy_loss": -0.0003209352435078472, "vf_loss": 0.20183807611465454, "vf_explained_var": 0.8684882521629333, "kl": 0.0020281835459172726, "entropy": 0.8679758310317993, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1795200, "episodes_total": 514, "training_iteration": 102, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-53-45", "timestamp": 1714564425, "time_this_iter_s": 74.67325782775879, "time_total_s": 7022.488194942474, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e4d40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7022.488194942474, "timesteps_since_restore": 1795200, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 37.03644859813084, "ram_util_percent": 79.69719626168221}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 57.87726215674894, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.6273286136788, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.34652914847607, "tl": -33.20577224931075}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.40679630937166, "mean_processing_ms": 3.5346061575575125, "mean_inference_ms": 0.8482248327592121}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10005632, "num_steps_sampled": 1812800, "sample_time_ms": 49453.883, "load_time_ms": 96.112, "grad_time_ms": 19689.127, "update_time_ms": 3.921, "learner": {"tl": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10373002290725708, "policy_loss": -0.00013891827256884426, "vf_loss": 0.10386894643306732, "vf_explained_var": 0.9395751953125, "kl": 0.0006724708946421742, "entropy": 0.8420641422271729, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 118.61845397949219, "policy_loss": -0.0004731901572085917, "vf_loss": 118.61892700195312, "vf_explained_var": -8.89621531996454e-09, "kl": 6.96569331921637e-05, "entropy": 1.3221601247787476, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1812800, "episodes_total": 517, "training_iteration": 103, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-54-51", "timestamp": 1714564491, "time_this_iter_s": 65.43502950668335, "time_total_s": 7087.923224449158, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7087.923224449158, "timesteps_since_restore": 1812800, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 39.09569892473118, "ram_util_percent": 79.82258064516127}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 48.34897477741277, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.6273286136788, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.61146565819814, "tl": -34.021874240065635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.400403171195173, "mean_processing_ms": 3.5338605727300068, "mean_inference_ms": 0.8477102565438557}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10014336, "num_steps_sampled": 1830400, "sample_time_ms": 49874.947, "load_time_ms": 96.697, "grad_time_ms": 19676.008, "update_time_ms": 3.783, "learner": {"tl": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 0.19585415720939636, "policy_loss": -8.71734882821329e-05, "vf_loss": 0.19594134390354156, "vf_explained_var": 0.9112604856491089, "kl": 0.0006702293176203966, "entropy": 0.8648043274879456, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 119.54342651367188, "policy_loss": -0.0005969820194877684, "vf_loss": 119.54401397705078, "vf_explained_var": -6.1357723346588955e-09, "kl": 0.0006193164736032486, "entropy": 1.3322029113769531, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1830400, "episodes_total": 523, "training_iteration": 104, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-56-00", "timestamp": 1714564560, "time_this_iter_s": 69.36984610557556, "time_total_s": 7157.293070554733, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ef80>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7157.293070554733, "timesteps_since_restore": 1830400, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 39.55454545454545, "ram_util_percent": 79.85555555555553}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 36.8021209575711, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 500.15294743067216, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.61874467158503, "tl": -34.98471864283468}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.398389139036052, "mean_processing_ms": 3.5337860925450384, "mean_inference_ms": 0.8471095484120589}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10020608, "num_steps_sampled": 1848000, "sample_time_ms": 49859.467, "load_time_ms": 97.041, "grad_time_ms": 19669.642, "update_time_ms": 3.77, "learner": {"tl": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18740126490592957, "policy_loss": -0.0004259615088813007, "vf_loss": 0.1878272294998169, "vf_explained_var": 0.8953055739402771, "kl": 0.006257042288780212, "entropy": 0.9210051894187927, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 122.35899353027344, "policy_loss": -0.0024896415416151285, "vf_loss": 122.36148834228516, "vf_explained_var": 2.432842594046747e-09, "kl": 0.0001043090014718473, "entropy": 1.3233028650283813, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1848000, "episodes_total": 529, "training_iteration": 105, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-57-13", "timestamp": 1714564633, "time_this_iter_s": 73.24323177337646, "time_total_s": 7230.53630232811, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7230.53630232811, "timesteps_since_restore": 1848000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 37.06442307692308, "ram_util_percent": 79.8326923076923}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 32.48223776112113, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.1644926903553, "tl": -35.30685457743636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.40062244002244, "mean_processing_ms": 3.5334656164636855, "mean_inference_ms": 0.8468750808289782}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10028032, "num_steps_sampled": 1865600, "sample_time_ms": 49703.17, "load_time_ms": 96.463, "grad_time_ms": 19694.398, "update_time_ms": 3.774, "learner": {"tl": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10372181981801987, "policy_loss": -0.00019978392811026424, "vf_loss": 0.10392159968614578, "vf_explained_var": 0.9425833225250244, "kl": 0.0019335475517436862, "entropy": 0.9471755027770996, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 145.65965270996094, "policy_loss": -0.0012914467370137572, "vf_loss": 145.6609344482422, "vf_explained_var": -1.027666307606978e-08, "kl": 0.0005886702565476298, "entropy": 1.3041608333587646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1865600, "episodes_total": 532, "training_iteration": 106, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-58-21", "timestamp": 1714564701, "time_this_iter_s": 67.95123791694641, "time_total_s": 7298.487540245056, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7298.487540245056, "timesteps_since_restore": 1865600, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 37.04329896907216, "ram_util_percent": 79.81546391752576}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 31.05779402199479, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.6068578772772, "tl": -35.462421987940395}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39764746659428, "mean_processing_ms": 3.5339888713805867, "mean_inference_ms": 0.8461805575111954}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10036224, "num_steps_sampled": 1883200, "sample_time_ms": 49968.429, "load_time_ms": 96.658, "grad_time_ms": 19693.199, "update_time_ms": 3.769, "learner": {"tl": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18592283129692078, "policy_loss": -0.00010428211680846289, "vf_loss": 0.18602712452411652, "vf_explained_var": 0.910692572593689, "kl": 0.0013731725048273802, "entropy": 0.9715317487716675, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 138.63014221191406, "policy_loss": -0.0006020190194249153, "vf_loss": 138.6307373046875, "vf_explained_var": -7.450580596923828e-09, "kl": 0.0002276859595440328, "entropy": 1.3125042915344238, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1883200, "episodes_total": 538, "training_iteration": 107, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_19-59-29", "timestamp": 1714564769, "time_this_iter_s": 67.98292994499207, "time_total_s": 7366.470470190048, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f60dd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7366.470470190048, "timesteps_since_restore": 1883200, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 39.435051546391755, "ram_util_percent": 79.8824742268041}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 30.26018606269101, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.34932322703173, "tl": -35.50742809702858}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.399240055677517, "mean_processing_ms": 3.533723073577553, "mean_inference_ms": 0.8455908217976442}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10041472, "num_steps_sampled": 1900800, "sample_time_ms": 49751.877, "load_time_ms": 96.796, "grad_time_ms": 19695.245, "update_time_ms": 3.774, "learner": {"tl": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1516517549753189, "policy_loss": -0.0003038296417798847, "vf_loss": 0.15195558965206146, "vf_explained_var": 0.8942220211029053, "kl": 0.004929874092340469, "entropy": 0.9588374495506287, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 145.9375762939453, "policy_loss": -0.0006392744253389537, "vf_loss": 145.93821716308594, "vf_explained_var": -1.889903344931554e-08, "kl": 0.00034292275086045265, "entropy": 1.3192583322525024, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1900800, "episodes_total": 543, "training_iteration": 108, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-00-41", "timestamp": 1714564841, "time_this_iter_s": 71.90211296081543, "time_total_s": 7438.372583150864, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7438.372583150864, "timesteps_since_restore": 1900800, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 35.75533980582524, "ram_util_percent": 79.9029126213592}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 28.956586880143764, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.18081331564485, "tl": -35.602018869625255}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39636310606913, "mean_processing_ms": 3.533311590477874, "mean_inference_ms": 0.8453619978386281}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10252672, "num_steps_sampled": 1918400, "sample_time_ms": 49554.533, "load_time_ms": 97.437, "grad_time_ms": 19691.902, "update_time_ms": 3.789, "learner": {"cav": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 162.11085510253906, "policy_loss": -0.001205127453431487, "vf_loss": 162.112060546875, "vf_explained_var": -1.0643686820799303e-08, "kl": 0.000256713799899444, "entropy": 1.3041118383407593, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16114091873168945, "policy_loss": -0.00037939901812933385, "vf_loss": 0.161520317196846, "vf_explained_var": 0.9153164029121399, "kl": 0.005526128690689802, "entropy": 0.9326522350311279, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1918400, "episodes_total": 548, "training_iteration": 109, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-01-52", "timestamp": 1714564912, "time_this_iter_s": 70.53152966499329, "time_total_s": 7508.904112815857, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f610e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7508.904112815857, "timesteps_since_restore": 1918400, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 36.94752475247525, "ram_util_percent": 80.00396039603963}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 158.73900343665736, "episode_reward_min": -175.86472004425, "episode_reward_mean": 25.93836441135714, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.6077733631219, "tl": -35.88911741264723}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39221466908237, "mean_processing_ms": 3.5330180884045075, "mean_inference_ms": 0.8448573947917911}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10259840, "num_steps_sampled": 1936000, "sample_time_ms": 49791.493, "load_time_ms": 97.373, "grad_time_ms": 19679.386, "update_time_ms": 3.905, "learner": {"tl": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16813309490680695, "policy_loss": -9.340921678813174e-05, "vf_loss": 0.16822651028633118, "vf_explained_var": 0.9148863554000854, "kl": 0.0013141314266249537, "entropy": 0.953511655330658, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 130.5665283203125, "policy_loss": -0.0024770849850028753, "vf_loss": 130.56900024414062, "vf_explained_var": 1.1708054969972181e-08, "kl": 0.00010115797340404242, "entropy": 1.3109999895095825, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1936000, "episodes_total": 553, "training_iteration": 110, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-02-58", "timestamp": 1714564978, "time_this_iter_s": 66.81310415267944, "time_total_s": 7575.717216968536, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f613b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7575.717216968536, "timesteps_since_restore": 1936000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 39.665263157894735, "ram_util_percent": 80.12947368421052}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 138.6072389495808, "episode_reward_min": -175.86472004425, "episode_reward_mean": 21.055873360054353, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.5932578936561, "tl": -36.29478204446698}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.392738158387505, "mean_processing_ms": 3.5332153632059873, "mean_inference_ms": 0.8445729985726613}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10265856, "num_steps_sampled": 1953600, "sample_time_ms": 49851.301, "load_time_ms": 97.196, "grad_time_ms": 19647.584, "update_time_ms": 3.936, "learner": {"tl": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13293397426605225, "policy_loss": -0.00010888084943871945, "vf_loss": 0.1330428570508957, "vf_explained_var": 0.9079848527908325, "kl": 0.0006861595902591944, "entropy": 0.9790570735931396, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 160.40277099609375, "policy_loss": 0.00010445246152812615, "vf_loss": 160.4026641845703, "vf_explained_var": 0.0, "kl": 0.0001128569056163542, "entropy": 1.3029578924179077, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1953600, "episodes_total": 557, "training_iteration": 111, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-04-07", "timestamp": 1714565047, "time_this_iter_s": 68.38480281829834, "time_total_s": 7644.102019786835, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ef80>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7644.102019786835, "timesteps_since_restore": 1953600, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 37.34081632653061, "ram_util_percent": 80.18367346938776}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 138.6072389495808, "episode_reward_min": -175.86472004425, "episode_reward_mean": 13.706497862946849, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9979188275446, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.11740519483726, "tl": -36.867575610991025}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.395846734370235, "mean_processing_ms": 3.53356099647973, "mean_inference_ms": 0.8439179790432153}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10272640, "num_steps_sampled": 1971200, "sample_time_ms": 49739.665, "load_time_ms": 97.265, "grad_time_ms": 19629.391, "update_time_ms": 3.921, "learner": {"tl": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 0.23202729225158691, "policy_loss": -0.00028133869636803865, "vf_loss": 0.23230864107608795, "vf_explained_var": 0.8623472452163696, "kl": 0.0032075964845716953, "entropy": 1.0147114992141724, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 161.0521697998047, "policy_loss": -0.0005787144182249904, "vf_loss": 161.052734375, "vf_explained_var": -2.249231911832794e-09, "kl": 0.0001221605925820768, "entropy": 1.2973653078079224, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1971200, "episodes_total": 564, "training_iteration": 112, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-05-20", "timestamp": 1714565120, "time_this_iter_s": 73.37103176116943, "time_total_s": 7717.473051548004, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7717.473051548004, "timesteps_since_restore": 1971200, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 37.76346153846154, "ram_util_percent": 80.30673076923075}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 138.6072389495808, "episode_reward_min": -175.86472004425, "episode_reward_mean": 10.570994433308305, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.3295252551262, "tl": -37.14654423515165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39324786515016, "mean_processing_ms": 3.5334393090961704, "mean_inference_ms": 0.8433021388661356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10278400, "num_steps_sampled": 1988800, "sample_time_ms": 50034.083, "load_time_ms": 97.107, "grad_time_ms": 19595.199, "update_time_ms": 3.907, "learner": {"tl": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1627628654241562, "policy_loss": -0.0003006687911693007, "vf_loss": 0.16306352615356445, "vf_explained_var": 0.9069167971611023, "kl": 0.00398737657815218, "entropy": 1.0506881475448608, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 137.68576049804688, "policy_loss": -0.0008334461017511785, "vf_loss": 137.68658447265625, "vf_explained_var": 1.3245476937484568e-09, "kl": 8.697310840943828e-05, "entropy": 1.3022806644439697, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 1988800, "episodes_total": 569, "training_iteration": 113, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-06-28", "timestamp": 1714565188, "time_this_iter_s": 68.03608989715576, "time_total_s": 7785.50914144516, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7785.50914144516, "timesteps_since_restore": 1988800, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 38.61237113402063, "ram_util_percent": 80.31752577319585}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 138.6072389495808, "episode_reward_min": -175.86472004425, "episode_reward_mean": 9.139800067657577, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -27.139561732821143}, "policy_reward_mean": {"cav": 456.56928694493246, "tl": -37.28579057310636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.391581752720146, "mean_processing_ms": 3.533171047123673, "mean_inference_ms": 0.8432258499499649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10285312, "num_steps_sampled": 2006400, "sample_time_ms": 50082.692, "load_time_ms": 96.656, "grad_time_ms": 19592.298, "update_time_ms": 3.885, "learner": {"tl": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13818088173866272, "policy_loss": -0.00042168505024164915, "vf_loss": 0.13860256969928741, "vf_explained_var": 0.9167807698249817, "kl": 0.005250762682408094, "entropy": 1.0527547597885132, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 163.8056640625, "policy_loss": -0.000504168274346739, "vf_loss": 163.80616760253906, "vf_explained_var": 3.311369178859991e-09, "kl": 0.0002742354990914464, "entropy": 1.2900761365890503, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2006400, "episodes_total": 573, "training_iteration": 114, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-07-38", "timestamp": 1714565258, "time_this_iter_s": 69.8230459690094, "time_total_s": 7855.332187414169, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f610e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7855.332187414169, "timesteps_since_restore": 2006400, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 36.657, "ram_util_percent": 80.23199999999999}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 138.6072389495808, "episode_reward_min": -175.86472004425, "episode_reward_mean": 8.204883378322663, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -27.64399068594268}, "policy_reward_mean": {"cav": 456.6529662977043, "tl": -37.37067357661524}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.3906517144583, "mean_processing_ms": 3.5329837387114718, "mean_inference_ms": 0.8431843289887417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10291456, "num_steps_sampled": 2024000, "sample_time_ms": 50046.731, "load_time_ms": 96.439, "grad_time_ms": 19556.52, "update_time_ms": 3.892, "learner": {"tl": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16567960381507874, "policy_loss": -0.0011508034076541662, "vf_loss": 0.1668303906917572, "vf_explained_var": 0.8982700109481812, "kl": 0.014031141065061092, "entropy": 1.0706220865249634, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 140.51658630371094, "policy_loss": 0.0007157648797146976, "vf_loss": 140.51588439941406, "vf_explained_var": -8.692343733684993e-09, "kl": 0.00035737943835556507, "entropy": 1.2780662775039673, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2024000, "episodes_total": 578, "training_iteration": 115, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-08-51", "timestamp": 1714565331, "time_this_iter_s": 72.52569270133972, "time_total_s": 7927.857880115509, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ea70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7927.857880115509, "timesteps_since_restore": 2024000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 36.05436893203884, "ram_util_percent": 80.29999999999998}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 138.6072389495808, "episode_reward_min": -175.86472004425, "episode_reward_mean": 8.398625056258394, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -27.64399068594268}, "policy_reward_mean": {"cav": 456.9956691087701, "tl": -37.383087004376094}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.394458125885457, "mean_processing_ms": 3.5338043244770887, "mean_inference_ms": 0.8426772481604075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10502656, "num_steps_sampled": 2041600, "sample_time_ms": 50338.961, "load_time_ms": 96.332, "grad_time_ms": 19517.235, "update_time_ms": 3.889, "learner": {"cav": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 194.49520874023438, "policy_loss": -0.0016330264043062925, "vf_loss": 194.49684143066406, "vf_explained_var": -1.2957531714263837e-09, "kl": 0.0003851123037748039, "entropy": 1.2670396566390991, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13074931502342224, "policy_loss": -0.0001858241594163701, "vf_loss": 0.13093514740467072, "vf_explained_var": 0.9060074090957642, "kl": 0.0012142931809648871, "entropy": 1.0960090160369873, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2041600, "episodes_total": 582, "training_iteration": 116, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-10-01", "timestamp": 1714565401, "time_this_iter_s": 70.48006319999695, "time_total_s": 7998.337943315506, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7998.337943315506, "timesteps_since_restore": 2041600, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 36.13366336633664, "ram_util_percent": 80.3316831683168}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -175.86472004425, "episode_reward_mean": 6.436067561392937, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.5978100418257, "tl": -37.51347854003618}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.391294014065988, "mean_processing_ms": 3.5328857861578546, "mean_inference_ms": 0.8419354051439045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10508544, "num_steps_sampled": 2059200, "sample_time_ms": 50806.139, "load_time_ms": 96.08, "grad_time_ms": 19499.179, "update_time_ms": 3.886, "learner": {"tl": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 0.22665245831012726, "policy_loss": -7.617618393851444e-05, "vf_loss": 0.2267286628484726, "vf_explained_var": 0.8658468723297119, "kl": 0.000933649658691138, "entropy": 1.115618348121643, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 186.0131378173828, "policy_loss": -0.00021242318325676024, "vf_loss": 186.0133819580078, "vf_explained_var": 1.2957531048130022e-08, "kl": 7.396849105134606e-05, "entropy": 1.2638591527938843, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2059200, "episodes_total": 589, "training_iteration": 117, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-11-14", "timestamp": 1714565474, "time_this_iter_s": 72.46993827819824, "time_total_s": 8070.807881593704, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61710>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8070.807881593704, "timesteps_since_restore": 2059200, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 37.60679611650485, "ram_util_percent": 80.3621359223301}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -175.86472004425, "episode_reward_mean": 7.160321749616693, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.59424316402556, "tl": -37.452826784534146}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.390154566954298, "mean_processing_ms": 3.5329717708457418, "mean_inference_ms": 0.8415442779051471}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10513536, "num_steps_sampled": 2076800, "sample_time_ms": 50128.193, "load_time_ms": 96.672, "grad_time_ms": 19506.135, "update_time_ms": 3.882, "learner": {"tl": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14354096353054047, "policy_loss": -0.00011734080908354372, "vf_loss": 0.14365829527378082, "vf_explained_var": 0.8893864154815674, "kl": 0.0013109497958794236, "entropy": 1.0878047943115234, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 172.04598999023438, "policy_loss": -0.0028887095395475626, "vf_loss": 172.0488739013672, "vf_explained_var": 0.0, "kl": 0.0016114211175590754, "entropy": 1.2424042224884033, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2076800, "episodes_total": 593, "training_iteration": 118, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-12-19", "timestamp": 1714565539, "time_this_iter_s": 65.20048236846924, "time_total_s": 8136.0083639621735, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f605f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8136.0083639621735, "timesteps_since_restore": 2076800, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 39.06559139784946, "ram_util_percent": 80.35591397849458}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -175.86472004425, "episode_reward_mean": 9.818689463153225, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.4720588726954, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 457.15793126626, "tl": -37.278270150259004}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39501301198301, "mean_processing_ms": 3.533917692208421, "mean_inference_ms": 0.8413498557731535}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10520064, "num_steps_sampled": 2094400, "sample_time_ms": 50067.133, "load_time_ms": 95.755, "grad_time_ms": 19468.311, "update_time_ms": 3.856, "learner": {"tl": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16778172552585602, "policy_loss": -0.00019569469441194087, "vf_loss": 0.16797740757465363, "vf_explained_var": 0.8848984837532043, "kl": 0.001410628785379231, "entropy": 1.0625660419464111, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 185.9321746826172, "policy_loss": 0.0004379782185424119, "vf_loss": 185.9317169189453, "vf_explained_var": -5.843592720822244e-09, "kl": 0.0003753038472495973, "entropy": 1.2268551588058472, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2094400, "episodes_total": 598, "training_iteration": 119, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-13-28", "timestamp": 1714565608, "time_this_iter_s": 69.53149271011353, "time_total_s": 8205.539856672287, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8205.539856672287, "timesteps_since_restore": 2094400, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 37.287000000000006, "ram_util_percent": 80.33899999999998}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -175.86472004425, "episode_reward_mean": 13.745691903930327, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.40377922528455, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.5749953015574, "tl": -36.90244194980239}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.390515932260513, "mean_processing_ms": 3.532920831845348, "mean_inference_ms": 0.8406215910607078}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10525056, "num_steps_sampled": 2112000, "sample_time_ms": 50686.124, "load_time_ms": 95.897, "grad_time_ms": 19465.486, "update_time_ms": 3.689, "learner": {"tl": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 0.22962304949760437, "policy_loss": -0.0003278754011262208, "vf_loss": 0.2299509346485138, "vf_explained_var": 0.8401046991348267, "kl": 0.0038978885859251022, "entropy": 1.0222585201263428, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 179.690673828125, "policy_loss": -0.00017981928249355406, "vf_loss": 179.69085693359375, "vf_explained_var": -9.16994569166718e-09, "kl": 0.00028202528483234346, "entropy": 1.2310938835144043, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2112000, "episodes_total": 605, "training_iteration": 120, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-14-41", "timestamp": 1714565681, "time_this_iter_s": 72.97588086128235, "time_total_s": 8278.51573753357, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ea70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8278.51573753357, "timesteps_since_restore": 2112000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 36.909615384615385, "ram_util_percent": 80.3701923076923}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -175.86472004425, "episode_reward_mean": 15.299157624886462, "episode_len_mean": 3500.0, "episodes_this_iter": 2, "policy_reward_min": {"cav": 432.40377922528455, "tl": -52.51507536894274}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.9557593768804, "tl": -36.80471681266629}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.393530600933346, "mean_processing_ms": 3.5338911421631356, "mean_inference_ms": 0.840618141450696}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10529920, "num_steps_sampled": 2129600, "sample_time_ms": 50701.231, "load_time_ms": 96.208, "grad_time_ms": 19462.831, "update_time_ms": 3.697, "learner": {"tl": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07819189876317978, "policy_loss": -0.0002013023622566834, "vf_loss": 0.07839320600032806, "vf_explained_var": 0.9277650713920593, "kl": 0.0022222185507416725, "entropy": 1.039729356765747, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 160.13059997558594, "policy_loss": 0.0014232747489586473, "vf_loss": 160.1291961669922, "vf_explained_var": 1.8822518654815212e-08, "kl": 0.0004952955059707165, "entropy": 1.23455011844635, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2129600, "episodes_total": 607, "training_iteration": 121, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-15-50", "timestamp": 1714565750, "time_this_iter_s": 68.51343536376953, "time_total_s": 8347.029172897339, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8347.029172897339, "timesteps_since_restore": 2129600, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 35.562886597938146, "ram_util_percent": 80.34329896907215}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -155.15738930981672, "episode_reward_mean": 23.624178504194266, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.40377922528455, "tl": -50.82920631977919}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 457.1731918693442, "tl": -36.12908444709594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.393550211232824, "mean_processing_ms": 3.533858684299102, "mean_inference_ms": 0.8405221786135985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10537344, "num_steps_sampled": 2147200, "sample_time_ms": 50171.945, "load_time_ms": 96.218, "grad_time_ms": 19477.994, "update_time_ms": 3.714, "learner": {"tl": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20230932533740997, "policy_loss": -0.0010566998971626163, "vf_loss": 0.20336602628231049, "vf_explained_var": 0.8772321343421936, "kl": 0.013477168045938015, "entropy": 1.0440168380737305, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 161.35317993164062, "policy_loss": -9.912586392601952e-05, "vf_loss": 161.35325622558594, "vf_explained_var": -3.0829989672298552e-09, "kl": 6.431622023228556e-05, "entropy": 1.2379844188690186, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2147200, "episodes_total": 613, "training_iteration": 122, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-16-58", "timestamp": 1714565818, "time_this_iter_s": 68.23138380050659, "time_total_s": 8415.260556697845, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217d24d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8415.260556697845, "timesteps_since_restore": 2147200, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 39.1295918367347, "ram_util_percent": 80.54387755102042}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -155.15738930981672, "episode_reward_mean": 30.06241933824242, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -50.82920631977919}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.5633007878194, "tl": -35.5417401207982}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.387742233322673, "mean_processing_ms": 3.5329062873947565, "mean_inference_ms": 0.8395660496276308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10541952, "num_steps_sampled": 2164800, "sample_time_ms": 49838.626, "load_time_ms": 96.366, "grad_time_ms": 19439.554, "update_time_ms": 3.714, "learner": {"tl": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1326453685760498, "policy_loss": -0.000925319385714829, "vf_loss": 0.13357070088386536, "vf_explained_var": 0.8830524682998657, "kl": 0.01387401670217514, "entropy": 1.023404598236084, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 190.11334228515625, "policy_loss": -0.0037386277690529823, "vf_loss": 190.11708068847656, "vf_explained_var": -6.622738357719982e-09, "kl": 0.00030538171995431185, "entropy": 1.2467002868652344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2164800, "episodes_total": 617, "training_iteration": 123, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-18-02", "timestamp": 1714565882, "time_this_iter_s": 64.31903076171875, "time_total_s": 8479.579587459564, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217e4b90>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8479.579587459564, "timesteps_since_restore": 2164800, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 39.42197802197802, "ram_util_percent": 80.62417582417582}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -118.7093070725786, "episode_reward_mean": 39.063894318204134, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.40377922528455, "tl": -49.134230912883595}, "policy_reward_max": {"cav": 499.9954621081399, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.94233947288586, "tl": -34.823203762890266}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39022344791509, "mean_processing_ms": 3.5334613080848305, "mean_inference_ms": 0.8392660991269445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10547968, "num_steps_sampled": 2182400, "sample_time_ms": 49834.122, "load_time_ms": 96.359, "grad_time_ms": 19416.502, "update_time_ms": 3.738, "learner": {"tl": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1957305669784546, "policy_loss": -0.0003202403022442013, "vf_loss": 0.19605080783367157, "vf_explained_var": 0.8512063026428223, "kl": 0.0029349522665143013, "entropy": 1.034226417541504, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 167.98989868164062, "policy_loss": -0.001440729363821447, "vf_loss": 167.99136352539062, "vf_explained_var": -2.5363677824685738e-09, "kl": 0.00026882131351158023, "entropy": 1.2416479587554932, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2182400, "episodes_total": 623, "training_iteration": 124, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-19-12", "timestamp": 1714565952, "time_this_iter_s": 69.54611539840698, "time_total_s": 8549.125702857971, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dce60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8549.125702857971, "timesteps_since_restore": 2182400, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 38.025999999999996, "ram_util_percent": 80.697}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -104.74619218337946, "episode_reward_mean": 46.920269762186045, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.40377922528455, "tl": -46.61978584842884}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.9885794525715, "tl": -34.17235914086555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.39030032682402, "mean_processing_ms": 3.5338655502240353, "mean_inference_ms": 0.8392651054924382}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10554240, "num_steps_sampled": 2200000, "sample_time_ms": 49357.634, "load_time_ms": 96.746, "grad_time_ms": 19422.9, "update_time_ms": 3.732, "learner": {"tl": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 0.19862796366214752, "policy_loss": -0.00019928895926568657, "vf_loss": 0.19882725179195404, "vf_explained_var": 0.880010187625885, "kl": 0.0007839338504709303, "entropy": 1.034558653831482, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 165.5839385986328, "policy_loss": -5.845090709044598e-05, "vf_loss": 165.58399963378906, "vf_explained_var": -4.865685188093494e-09, "kl": 0.00010801662574522197, "entropy": 1.2416975498199463, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2200000, "episodes_total": 629, "training_iteration": 125, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-20-20", "timestamp": 1714566020, "time_this_iter_s": 67.82817125320435, "time_total_s": 8616.953874111176, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dcd40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8616.953874111176, "timesteps_since_restore": 2200000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 39.73541666666667, "ram_util_percent": 80.71770833333335}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -66.40291807391782, "episode_reward_mean": 48.60503916930799, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -43.39444879284567}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.33603355495035, "tl": -33.977582865470296}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.386238206965082, "mean_processing_ms": 3.533060379143054, "mean_inference_ms": 0.8379982748160623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10559104, "num_steps_sampled": 2217600, "sample_time_ms": 48839.167, "load_time_ms": 97.035, "grad_time_ms": 19428.191, "update_time_ms": 3.73, "learner": {"tl": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13169381022453308, "policy_loss": -0.00014268462837208062, "vf_loss": 0.13183650374412537, "vf_explained_var": 0.8785439133644104, "kl": 0.0004977337084710598, "entropy": 1.0539292097091675, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 170.7800750732422, "policy_loss": 0.00217546452768147, "vf_loss": 170.77789306640625, "vf_explained_var": -9.411259327407606e-09, "kl": 0.00021012603247072548, "entropy": 1.234810471534729, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2217600, "episodes_total": 633, "training_iteration": 126, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-21-25", "timestamp": 1714566085, "time_this_iter_s": 65.34962201118469, "time_total_s": 8682.30349612236, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d216ec170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8682.30349612236, "timesteps_since_restore": 2217600, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 38.98297872340425, "ram_util_percent": 80.74574468085106}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 134.37296403306073, "episode_reward_min": -66.40291807391782, "episode_reward_mean": 48.196652395864845, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.40377922528455, "tl": -43.39444879284567}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.78945553286945, "tl": -34.04940026141712}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.384734392850763, "mean_processing_ms": 3.5329407089813407, "mean_inference_ms": 0.8381433662221633}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10565760, "num_steps_sampled": 2235200, "sample_time_ms": 48659.947, "load_time_ms": 96.965, "grad_time_ms": 19431.961, "update_time_ms": 3.709, "learner": {"tl": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1735205501317978, "policy_loss": -3.481547173578292e-05, "vf_loss": 0.17355535924434662, "vf_explained_var": 0.8780511617660522, "kl": 0.00027162241167388856, "entropy": 1.0511313676834106, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 193.90367126464844, "policy_loss": -4.012961653643288e-06, "vf_loss": 193.90370178222656, "vf_explained_var": -3.4387295233528903e-09, "kl": 0.0006318116211332381, "entropy": 1.2255637645721436, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2235200, "episodes_total": 638, "training_iteration": 127, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-22-36", "timestamp": 1714566156, "time_this_iter_s": 70.71560025215149, "time_total_s": 8753.019096374512, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21775ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8753.019096374512, "timesteps_since_restore": 2235200, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 37.08811881188119, "ram_util_percent": 80.75643564356436}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 125.80622573429585, "episode_reward_min": -66.40291807391782, "episode_reward_mean": 45.38036508178448, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.40377922528455, "tl": -43.39444879284567}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.75075597776447, "tl": -34.28086590799841}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.382007925010335, "mean_processing_ms": 3.533166599074036, "mean_inference_ms": 0.8371394342312474}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10570240, "num_steps_sampled": 2252800, "sample_time_ms": 49369.705, "load_time_ms": 96.145, "grad_time_ms": 19402.541, "update_time_ms": 3.733, "learner": {"tl": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 0.23387551307678223, "policy_loss": -0.0005773934535682201, "vf_loss": 0.23445290327072144, "vf_explained_var": 0.8190110325813293, "kl": 0.007351977750658989, "entropy": 1.0632075071334839, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 179.2165985107422, "policy_loss": -0.00017993300571106374, "vf_loss": 179.21676635742188, "vf_explained_var": 1.7029898602416438e-09, "kl": 9.191754361381754e-05, "entropy": 1.2205263376235962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2252800, "episodes_total": 645, "training_iteration": 128, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-23-48", "timestamp": 1714566228, "time_this_iter_s": 71.9931116104126, "time_total_s": 8825.012207984924, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8825.012207984924, "timesteps_since_restore": 2252800, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 38.299019607843135, "ram_util_percent": 80.81078431372546}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 125.80622573429585, "episode_reward_min": -66.40291807391782, "episode_reward_mean": 44.81544417982518, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -43.39444879284567}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -29.880847781291155}, "policy_reward_mean": {"cav": 456.3392036796381, "tl": -34.29364662498447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.38246244584067, "mean_processing_ms": 3.5336107565795927, "mean_inference_ms": 0.8365924561852843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10575616, "num_steps_sampled": 2270400, "sample_time_ms": 49402.643, "load_time_ms": 96.106, "grad_time_ms": 19388.894, "update_time_ms": 3.765, "learner": {"tl": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13376428186893463, "policy_loss": -0.00031748972833156586, "vf_loss": 0.13408176600933075, "vf_explained_var": 0.8898451328277588, "kl": 0.004300151485949755, "entropy": 1.0553405284881592, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 179.30902099609375, "policy_loss": -0.001793359755538404, "vf_loss": 179.31080627441406, "vf_explained_var": 8.514949634275126e-09, "kl": 0.000140257048769854, "entropy": 1.2116302251815796, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2270400, "episodes_total": 649, "training_iteration": 129, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-24-58", "timestamp": 1714566298, "time_this_iter_s": 69.72432684898376, "time_total_s": 8894.736534833908, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc5f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8894.736534833908, "timesteps_since_restore": 2270400, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 36.37200000000001, "ram_util_percent": 80.84699999999998}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 127.47807423124152, "episode_reward_min": -66.40291807391782, "episode_reward_mean": 49.235006835634714, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.40377922528455, "tl": -43.39444879284567}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.77031652061277, "tl": -33.96127580708154}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.382699892265336, "mean_processing_ms": 3.5341308901453856, "mean_inference_ms": 0.8366719650297886}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10582144, "num_steps_sampled": 2288000, "sample_time_ms": 49313.544, "load_time_ms": 95.911, "grad_time_ms": 19388.259, "update_time_ms": 3.848, "learner": {"tl": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16922256350517273, "policy_loss": -0.00037609576247632504, "vf_loss": 0.16959868371486664, "vf_explained_var": 0.891194224357605, "kl": 0.004512045532464981, "entropy": 1.0337437391281128, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 167.57363891601562, "policy_loss": 0.0013857323210686445, "vf_loss": 167.572265625, "vf_explained_var": 4.674874265475637e-09, "kl": 0.00018598127644509077, "entropy": 1.2141705751419067, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2288000, "episodes_total": 654, "training_iteration": 130, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-26-10", "timestamp": 1714566370, "time_this_iter_s": 72.07639360427856, "time_total_s": 8966.812928438187, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8966.812928438187, "timesteps_since_restore": 2288000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 36.22450980392156, "ram_util_percent": 80.83039215686273}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -45.838811500327665, "episode_reward_mean": 53.73216639381044, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -42.03081366359663}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.7791795717585, "tl": -33.587251098162376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.37774817886515, "mean_processing_ms": 3.5336504202683936, "mean_inference_ms": 0.8357849494978056}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10587264, "num_steps_sampled": 2305600, "sample_time_ms": 49066.652, "load_time_ms": 96.025, "grad_time_ms": 19389.762, "update_time_ms": 3.799, "learner": {"tl": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1368248015642166, "policy_loss": -0.0001118462168960832, "vf_loss": 0.13693664968013763, "vf_explained_var": 0.8852403163909912, "kl": 0.0008968696347437799, "entropy": 1.0220575332641602, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 144.9304962158203, "policy_loss": 0.00010339692380512133, "vf_loss": 144.93038940429688, "vf_explained_var": -8.940697071579962e-09, "kl": 0.00019518852059263736, "entropy": 1.201399564743042, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2305600, "episodes_total": 658, "training_iteration": 131, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-27-16", "timestamp": 1714566436, "time_this_iter_s": 66.05960893630981, "time_total_s": 9032.872537374496, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218883b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9032.872537374496, "timesteps_since_restore": 2305600, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 38.18736842105263, "ram_util_percent": 80.80842105263159}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -29.41506765596876, "episode_reward_mean": 57.8995343563198, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.40377922528455, "tl": -42.03081366359663}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.83217762671273, "tl": -33.24438693919945}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.376334315612496, "mean_processing_ms": 3.5335189286287374, "mean_inference_ms": 0.8357885402671785}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10798464, "num_steps_sampled": 2323200, "sample_time_ms": 49124.56, "load_time_ms": 96.449, "grad_time_ms": 19387.819, "update_time_ms": 3.794, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 193.70468139648438, "policy_loss": 0.0010303278686478734, "vf_loss": 193.7036590576172, "vf_explained_var": -6.340919789238342e-09, "kl": 2.96267189696664e-05, "entropy": 1.2028380632400513, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 0.17354972660541534, "policy_loss": -9.116194269154221e-05, "vf_loss": 0.1736408770084381, "vf_explained_var": 0.8737375736236572, "kl": 0.0003057760768570006, "entropy": 1.0279453992843628, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2323200, "episodes_total": 663, "training_iteration": 132, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-28-25", "timestamp": 1714566505, "time_this_iter_s": 68.80074143409729, "time_total_s": 9101.673278808594, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21795a70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9101.673278808594, "timesteps_since_restore": 2323200, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 37.846938775510196, "ram_util_percent": 80.87959183673468}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 61.42242926830058, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.77512098948455, "tl": -32.94605764343207}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.37766971465226, "mean_processing_ms": 3.5341150140461663, "mean_inference_ms": 0.8352714408814762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10803200, "num_steps_sampled": 2340800, "sample_time_ms": 49861.618, "load_time_ms": 96.371, "grad_time_ms": 19422.91, "update_time_ms": 3.79, "learner": {"tl": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 0.22546522319316864, "policy_loss": -0.0007069698767736554, "vf_loss": 0.22617219388484955, "vf_explained_var": 0.8454487919807434, "kl": 0.00910127442330122, "entropy": 0.9963923692703247, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 165.85523986816406, "policy_loss": 0.0013460632180795074, "vf_loss": 165.85389709472656, "vf_explained_var": -1.7720299894108393e-08, "kl": 0.00011479781824164093, "entropy": 1.2146114110946655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2340800, "episodes_total": 670, "training_iteration": 133, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-29-37", "timestamp": 1714566577, "time_this_iter_s": 72.04272055625916, "time_total_s": 9173.715999364853, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9173.715999364853, "timesteps_since_restore": 2340800, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 37.635922330097095, "ram_util_percent": 80.90097087378638}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 61.32432089784876, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.3417932765262, "tl": -32.918122698223186}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.37518288237347, "mean_processing_ms": 3.533796714286162, "mean_inference_ms": 0.8344961930533806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10808832, "num_steps_sampled": 2358400, "sample_time_ms": 49322.56, "load_time_ms": 96.284, "grad_time_ms": 19419.796, "update_time_ms": 3.766, "learner": {"tl": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11793479323387146, "policy_loss": -4.1615312511567026e-05, "vf_loss": 0.11797641962766647, "vf_explained_var": 0.9064088463783264, "kl": 0.00027064362075179815, "entropy": 1.003136157989502, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 155.80459594726562, "policy_loss": -0.003265989711508155, "vf_loss": 155.807861328125, "vf_explained_var": 8.127906347965563e-09, "kl": 0.0014970655320212245, "entropy": 1.217430591583252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2358400, "episodes_total": 673, "training_iteration": 134, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-30-41", "timestamp": 1714566641, "time_this_iter_s": 64.12365770339966, "time_total_s": 9237.839657068253, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc3b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9237.839657068253, "timesteps_since_restore": 2358400, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 39.1978021978022, "ram_util_percent": 80.94835164835165}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 58.41899186991824, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.1031794865633, "tl": -33.14034896805385}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.37497880766959, "mean_processing_ms": 3.5338130229462372, "mean_inference_ms": 0.8341526344802908}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10816256, "num_steps_sampled": 2376000, "sample_time_ms": 49889.457, "load_time_ms": 95.854, "grad_time_ms": 19426.376, "update_time_ms": 3.756, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.21229416131973267, "policy_loss": -0.00019084244559053332, "vf_loss": 0.21248501539230347, "vf_explained_var": 0.8619176745414734, "kl": 0.002239508554339409, "entropy": 1.0334808826446533, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 192.41748046875, "policy_loss": 5.5302833061432466e-05, "vf_loss": 192.4174346923828, "vf_explained_var": 1.1304329028405391e-08, "kl": 0.00014499273675028235, "entropy": 1.222517490386963, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2376000, "episodes_total": 679, "training_iteration": 135, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-31-55", "timestamp": 1714566715, "time_this_iter_s": 73.55709505081177, "time_total_s": 9311.396752119064, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21775a70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9311.396752119064, "timesteps_since_restore": 2376000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 36.593333333333334, "ram_util_percent": 80.98952380952382}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 57.47984776883244, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.5420215735783, "tl": -33.25518115039557}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.37067985560445, "mean_processing_ms": 3.5341689395583433, "mean_inference_ms": 0.8337125923955386}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10819584, "num_steps_sampled": 2393600, "sample_time_ms": 50352.46, "load_time_ms": 95.553, "grad_time_ms": 19422.065, "update_time_ms": 3.757, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13576273620128632, "policy_loss": -0.00021300814114511013, "vf_loss": 0.13597573339939117, "vf_explained_var": 0.8611637353897095, "kl": 0.0023713407572358847, "entropy": 1.0260677337646484, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 179.67620849609375, "policy_loss": 0.0012507312931120396, "vf_loss": 179.6749725341797, "vf_explained_var": -4.58497284583359e-09, "kl": 8.434517803834751e-05, "entropy": 1.2140895128250122, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2393600, "episodes_total": 683, "training_iteration": 136, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-33-04", "timestamp": 1714566784, "time_this_iter_s": 69.93285322189331, "time_total_s": 9381.329605340958, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9381.329605340958, "timesteps_since_restore": 2393600, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 36.182, "ram_util_percent": 81.03100000000002}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 57.14679135455576, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.0881012049103, "tl": -33.2451091541963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.36942317722464, "mean_processing_ms": 3.5336119233405827, "mean_inference_ms": 0.8329790565249539}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10827008, "num_steps_sampled": 2411200, "sample_time_ms": 50081.971, "load_time_ms": 96.662, "grad_time_ms": 19367.705, "update_time_ms": 3.765, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1764652281999588, "policy_loss": -0.001263773418031633, "vf_loss": 0.17772901058197021, "vf_explained_var": 0.8726046681404114, "kl": 0.018213100731372833, "entropy": 1.0676528215408325, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 156.59495544433594, "policy_loss": -0.0009641105425544083, "vf_loss": 156.59591674804688, "vf_explained_var": -3.0829989672298552e-09, "kl": 0.0005226617795415223, "entropy": 1.2362568378448486, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2411200, "episodes_total": 688, "training_iteration": 137, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-34-12", "timestamp": 1714566852, "time_this_iter_s": 67.47716069221497, "time_total_s": 9448.806766033173, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21775ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9448.806766033173, "timesteps_since_restore": 2411200, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 39.31875, "ram_util_percent": 81.390625}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 56.86062109842642, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.12935050804396, "tl": -33.27239411746824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.370488966674188, "mean_processing_ms": 3.534270919268528, "mean_inference_ms": 0.8328271501256375}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11038208, "num_steps_sampled": 2428800, "sample_time_ms": 49984.126, "load_time_ms": 97.446, "grad_time_ms": 19063.482, "update_time_ms": 3.738, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 182.1859588623047, "policy_loss": 7.343656761804596e-05, "vf_loss": 182.1858673095703, "vf_explained_var": -9.2718339672615e-09, "kl": 6.179117190185934e-05, "entropy": 1.2395672798156738, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.23361916840076447, "policy_loss": -8.903062553144991e-05, "vf_loss": 0.2337081879377365, "vf_explained_var": 0.843538761138916, "kl": 0.0010450087720528245, "entropy": 1.07680082321167, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2428800, "episodes_total": 695, "training_iteration": 138, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-35-20", "timestamp": 1714566920, "time_this_iter_s": 67.98393130302429, "time_total_s": 9516.790697336197, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dccb0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9516.790697336197, "timesteps_since_restore": 2428800, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 42.46082474226803, "ram_util_percent": 81.61443298969073}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 58.6123835441188, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.59570121317637, "tl": -33.16527647242154}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.36649099461022, "mean_processing_ms": 3.5345169186499383, "mean_inference_ms": 0.8324202008110889}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11042560, "num_steps_sampled": 2446400, "sample_time_ms": 49737.103, "load_time_ms": 97.96, "grad_time_ms": 18955.749, "update_time_ms": 3.752, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13039197027683258, "policy_loss": -0.00013240004773251712, "vf_loss": 0.13052436709403992, "vf_explained_var": 0.8717308640480042, "kl": 0.000998660922050476, "entropy": 1.0807714462280273, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 190.9129180908203, "policy_loss": -0.0015141521580517292, "vf_loss": 190.9144287109375, "vf_explained_var": -1.7530777940422126e-09, "kl": 0.0009880467550829053, "entropy": 1.245092511177063, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2446400, "episodes_total": 699, "training_iteration": 139, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-36-26", "timestamp": 1714566986, "time_this_iter_s": 66.18639588356018, "time_total_s": 9582.977093219757, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217757a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9582.977093219757, "timesteps_since_restore": 2446400, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 39.40631578947368, "ram_util_percent": 81.64736842105262}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 59.071031077536084, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.40377922528455, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 455.93702633293555, "tl": -33.072166271283365}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.364767928530863, "mean_processing_ms": 3.5334740725545792, "mean_inference_ms": 0.8318296545667248}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11049600, "num_steps_sampled": 2464000, "sample_time_ms": 49093.055, "load_time_ms": 97.982, "grad_time_ms": 18953.023, "update_time_ms": 3.711, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14025287330150604, "policy_loss": -0.00012331240577623248, "vf_loss": 0.14037618041038513, "vf_explained_var": 0.8900352716445923, "kl": 0.0009178834734484553, "entropy": 1.1016325950622559, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 159.37583923339844, "policy_loss": -0.0014136629179120064, "vf_loss": 159.37728881835938, "vf_explained_var": -1.083720779782027e-09, "kl": 0.000437987589975819, "entropy": 1.2667059898376465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2464000, "episodes_total": 703, "training_iteration": 140, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-37-32", "timestamp": 1714567052, "time_this_iter_s": 65.6100423336029, "time_total_s": 9648.58713555336, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187e560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9648.58713555336, "timesteps_since_restore": 2464000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 40.08817204301075, "ram_util_percent": 81.33333333333331}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 61.47478849298487, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 432.6313517990081, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.1110621525144, "tl": -32.886356138294246}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.36476512259925, "mean_processing_ms": 3.534504794742954, "mean_inference_ms": 0.8312655067524556}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11260800, "num_steps_sampled": 2481600, "sample_time_ms": 49692.882, "load_time_ms": 97.834, "grad_time_ms": 18944.419, "update_time_ms": 3.733, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 183.78866577148438, "policy_loss": -0.00010020082845585421, "vf_loss": 183.78878784179688, "vf_explained_var": -7.224805642636056e-09, "kl": 8.702497143531218e-05, "entropy": 1.273184061050415, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.25648370385169983, "policy_loss": -0.00020119450346101075, "vf_loss": 0.25668489933013916, "vf_explained_var": 0.7733960151672363, "kl": 0.0025661438703536987, "entropy": 1.0964852571487427, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2481600, "episodes_total": 711, "training_iteration": 141, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-38-44", "timestamp": 1714567124, "time_this_iter_s": 71.97189331054688, "time_total_s": 9720.559028863907, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c23b710e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9720.559028863907, "timesteps_since_restore": 2481600, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 38.300000000000004, "ram_util_percent": 81.38737864077667}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 62.087109347322304, "episode_len_mean": 3500.0, "episodes_this_iter": 1, "policy_reward_min": {"cav": 432.6313517990081, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.1215157658774, "tl": -32.83620053487971}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.363780980136674, "mean_processing_ms": 3.5347513386854787, "mean_inference_ms": 0.831133761382986}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11265792, "num_steps_sampled": 2499200, "sample_time_ms": 48978.877, "load_time_ms": 97.383, "grad_time_ms": 18915.763, "update_time_ms": 3.741, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0424618162214756, "policy_loss": -0.00011282386549282819, "vf_loss": 0.04257464036345482, "vf_explained_var": 0.9574066996574402, "kl": 0.0012844023294746876, "entropy": 1.1091395616531372, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 196.66708374023438, "policy_loss": 0.003150134813040495, "vf_loss": 196.6638946533203, "vf_explained_var": 0.0, "kl": 5.858187432750128e-05, "entropy": 1.2807539701461792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2499200, "episodes_total": 712, "training_iteration": 142, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-39-45", "timestamp": 1714567185, "time_this_iter_s": 61.36131167411804, "time_total_s": 9781.920340538025, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9781.920340538025, "timesteps_since_restore": 2499200, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 38.768965517241384, "ram_util_percent": 81.29885057471262}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 62.62084238211496, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.6313517990081, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.14640576288764, "tl": -32.79379694839782}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.364988829678996, "mean_processing_ms": 3.53529694429253, "mean_inference_ms": 0.8310241952996784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11272832, "num_steps_sampled": 2516800, "sample_time_ms": 48630.471, "load_time_ms": 97.31, "grad_time_ms": 18938.416, "update_time_ms": 3.725, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2269948124885559, "policy_loss": -0.00012383150169625878, "vf_loss": 0.22711864113807678, "vf_explained_var": 0.846321702003479, "kl": 0.0007947757840156555, "entropy": 1.0934027433395386, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 166.3258819580078, "policy_loss": 0.0035629381891340017, "vf_loss": 166.3223114013672, "vf_explained_var": -1.8423254033450576e-08, "kl": 0.0001896858448162675, "entropy": 1.2824417352676392, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2516800, "episodes_total": 719, "training_iteration": 143, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-40-54", "timestamp": 1714567254, "time_this_iter_s": 68.78970980644226, "time_total_s": 9850.710050344467, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217759e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9850.710050344467, "timesteps_since_restore": 2516800, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 39.369696969696975, "ram_util_percent": 81.41212121212119}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 63.77202461684173, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.6313517990081, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 502.9847482863606, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.8320873826992, "tl": -32.75500523048828}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.362201024958487, "mean_processing_ms": 3.536121303022812, "mean_inference_ms": 0.8309466014349148}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11276288, "num_steps_sampled": 2534400, "sample_time_ms": 49414.207, "load_time_ms": 97.449, "grad_time_ms": 18866.001, "update_time_ms": 3.751, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1652367115020752, "policy_loss": -1.8539429220254533e-05, "vf_loss": 0.16525523364543915, "vf_explained_var": 0.8224073648452759, "kl": 0.00017595020472072065, "entropy": 1.1032872200012207, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 195.51296997070312, "policy_loss": -0.0013431365368887782, "vf_loss": 195.51429748535156, "vf_explained_var": -6.622738357719982e-09, "kl": 4.883033034275286e-05, "entropy": 1.2805917263031006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2534400, "episodes_total": 724, "training_iteration": 144, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-42-05", "timestamp": 1714567325, "time_this_iter_s": 71.23785185813904, "time_total_s": 9921.947902202606, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9921.947902202606, "timesteps_since_restore": 2534400, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 36.7009900990099, "ram_util_percent": 81.33267326732671}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 64.62447962982257, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.6313517990081, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.11034471788776, "tl": -32.623822090672256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.36049774276902, "mean_processing_ms": 3.535356984905542, "mean_inference_ms": 0.8299793993218492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11282304, "num_steps_sampled": 2552000, "sample_time_ms": 48689.401, "load_time_ms": 97.519, "grad_time_ms": 18877.706, "update_time_ms": 3.766, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1385430246591568, "policy_loss": -8.124019223032519e-05, "vf_loss": 0.13862426578998566, "vf_explained_var": 0.8634003400802612, "kl": 0.0005866254214197397, "entropy": 1.1142473220825195, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 190.22909545898438, "policy_loss": -0.0010472030844539404, "vf_loss": 190.23013305664062, "vf_explained_var": -1.2681838912342869e-09, "kl": 8.778956544119865e-05, "entropy": 1.27212655544281, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2552000, "episodes_total": 728, "training_iteration": 145, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-43-12", "timestamp": 1714567392, "time_this_iter_s": 66.42998933792114, "time_total_s": 9988.377891540527, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c240fd320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9988.377891540527, "timesteps_since_restore": 2552000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 38.176842105263155, "ram_util_percent": 81.43578947368421}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 67.49846745028492, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.59650590913907, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.1266437766353, "tl": -32.38568136052935}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.361516762648545, "mean_processing_ms": 3.5358470636039, "mean_inference_ms": 0.8298769135568739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11288704, "num_steps_sampled": 2569600, "sample_time_ms": 48551.431, "load_time_ms": 98.21, "grad_time_ms": 18891.799, "update_time_ms": 3.765, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.22489775717258453, "policy_loss": -5.0050704885507e-05, "vf_loss": 0.22494781017303467, "vf_explained_var": 0.8538881540298462, "kl": 0.0003081579925492406, "entropy": 1.1062527894973755, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 172.7939910888672, "policy_loss": 0.0022030568215996027, "vf_loss": 172.79180908203125, "vf_explained_var": 0.0, "kl": 0.00018208219262305647, "entropy": 1.259405255317688, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2569600, "episodes_total": 735, "training_iteration": 146, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-44-20", "timestamp": 1714567460, "time_this_iter_s": 68.70135426521301, "time_total_s": 10057.07924580574, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dcc20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10057.07924580574, "timesteps_since_restore": 2569600, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 39.70612244897959, "ram_util_percent": 81.42244897959182}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": -1.9147975869608027, "episode_reward_mean": 69.86573169711522, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.59650590913907, "tl": -38.011355755719094}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.55112020818456, "tl": -32.22378237592261}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.361935628879483, "mean_processing_ms": 3.5371103019210697, "mean_inference_ms": 0.8296420384737714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11292160, "num_steps_sampled": 2587200, "sample_time_ms": 48800.88, "load_time_ms": 97.096, "grad_time_ms": 18880.979, "update_time_ms": 3.798, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1637360155582428, "policy_loss": -0.00017480958194937557, "vf_loss": 0.16391083598136902, "vf_explained_var": 0.8016947507858276, "kl": 0.0015491509111598134, "entropy": 1.077300786972046, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 178.33767700195312, "policy_loss": -0.0003496760327834636, "vf_loss": 178.33799743652344, "vf_explained_var": 6.622738357719982e-09, "kl": 0.00013262384163681418, "entropy": 1.2687673568725586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2587200, "episodes_total": 740, "training_iteration": 147, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-45-30", "timestamp": 1714567530, "time_this_iter_s": 69.85172152519226, "time_total_s": 10126.930967330933, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21775050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10126.930967330933, "timesteps_since_restore": 2587200, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 37.025, "ram_util_percent": 81.44200000000001}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 133.28401091362008, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 71.47458603365381, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.59650590913907, "tl": -37.37972551798371}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.3443643737183, "tl": -32.07248152833887}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.35833668693007, "mean_processing_ms": 3.535993229728594, "mean_inference_ms": 0.829154341162479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11503360, "num_steps_sampled": 2604800, "sample_time_ms": 48108.275, "load_time_ms": 96.477, "grad_time_ms": 19209.414, "update_time_ms": 3.79, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 182.3709716796875, "policy_loss": 0.0012808134779334068, "vf_loss": 182.36968994140625, "vf_explained_var": 1.0276662854025176e-09, "kl": 5.368297570385039e-05, "entropy": 1.2766815423965454, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11008744686841965, "policy_loss": -7.616353832418099e-05, "vf_loss": 0.110163614153862, "vf_explained_var": 0.9117370247840881, "kl": 0.0006376479868777096, "entropy": 1.0654475688934326, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2604800, "episodes_total": 743, "training_iteration": 148, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-46-35", "timestamp": 1714567595, "time_this_iter_s": 64.3329644203186, "time_total_s": 10191.263931751251, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dca70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10191.263931751251, "timesteps_since_restore": 2604800, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 39.13406593406593, "ram_util_percent": 81.48681318681321}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 74.08757230451833, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.59650590913907, "tl": -36.66273286298727}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.6518689047844, "tl": -31.880358050022355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.35499368894991, "mean_processing_ms": 3.535781877043813, "mean_inference_ms": 0.8291631284463367}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11508992, "num_steps_sampled": 2622400, "sample_time_ms": 48584.454, "load_time_ms": 96.177, "grad_time_ms": 19323.354, "update_time_ms": 3.747, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2207152396440506, "policy_loss": -0.0006266292766667902, "vf_loss": 0.22134189307689667, "vf_explained_var": 0.8331289291381836, "kl": 0.008886288851499557, "entropy": 1.0428500175476074, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 147.73463439941406, "policy_loss": 5.331076681613922e-05, "vf_loss": 147.73460388183594, "vf_explained_var": -5.418604231977042e-09, "kl": 2.0085293726879172e-05, "entropy": 1.2762503623962402, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2622400, "episodes_total": 750, "training_iteration": 149, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-47-47", "timestamp": 1714567667, "time_this_iter_s": 72.08041191101074, "time_total_s": 10263.344343662262, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21815170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10263.344343662262, "timesteps_since_restore": 2622400, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 37.64368932038834, "ram_util_percent": 81.52815533980583}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 74.2422219109357, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.59650590913907, "tl": -36.66273286298727}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.99615344255341}, "policy_reward_mean": {"cav": 456.61050389915147, "tl": -31.864023499018174}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.35252642207286, "mean_processing_ms": 3.5356644546539453, "mean_inference_ms": 0.8286187032105531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11512960, "num_steps_sampled": 2640000, "sample_time_ms": 48657.097, "load_time_ms": 96.719, "grad_time_ms": 19290.858, "update_time_ms": 3.727, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10404480993747711, "policy_loss": -0.00016644311835989356, "vf_loss": 0.1042112484574318, "vf_explained_var": 0.8649678826332092, "kl": 0.0012879726709797978, "entropy": 1.0115329027175903, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 182.8326873779297, "policy_loss": -0.0024598396848887205, "vf_loss": 182.83514404296875, "vf_explained_var": 0.0, "kl": 0.00010299315908923745, "entropy": 1.2848248481750488, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2640000, "episodes_total": 753, "training_iteration": 150, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-48-53", "timestamp": 1714567733, "time_this_iter_s": 66.01624464988708, "time_total_s": 10329.360588312149, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d216fa290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10329.360588312149, "timesteps_since_restore": 2640000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 37.44468085106383, "ram_util_percent": 81.45638297872338}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 73.11818556837159, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.5380959363073, "tl": -36.66273286298727}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -28.150706541765686}, "policy_reward_mean": {"cav": 456.14496427137885, "tl": -31.918898225250803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.355903762947026, "mean_processing_ms": 3.5361841572758403, "mean_inference_ms": 0.8282426917238885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11521408, "num_steps_sampled": 2657600, "sample_time_ms": 48238.849, "load_time_ms": 96.577, "grad_time_ms": 19317.317, "update_time_ms": 3.711, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.19998961687088013, "policy_loss": -0.0002560988359618932, "vf_loss": 0.2002457082271576, "vf_explained_var": 0.8742169737815857, "kl": 0.002832643687725067, "entropy": 0.975968599319458, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 166.77566528320312, "policy_loss": -3.3906126191141084e-05, "vf_loss": 166.77569580078125, "vf_explained_var": 1.1740309169283591e-08, "kl": 2.4006540115806274e-05, "entropy": 1.2908059358596802, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2657600, "episodes_total": 759, "training_iteration": 151, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-50-01", "timestamp": 1714567801, "time_this_iter_s": 68.05207991600037, "time_total_s": 10397.41266822815, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d2187ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10397.41266822815, "timesteps_since_restore": 2657600, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 39.41530612244898, "ram_util_percent": 81.5795918367347}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 73.13072724491126, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.5380959363073, "tl": -36.66273286298727}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -28.150706541765686}, "policy_reward_mean": {"cav": 456.39813954323364, "tl": -31.93895102486038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.35305788629393, "mean_processing_ms": 3.5364140173406384, "mean_inference_ms": 0.8276117012894072}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11525888, "num_steps_sampled": 2675200, "sample_time_ms": 49150.745, "load_time_ms": 97.169, "grad_time_ms": 19312.697, "update_time_ms": 3.732, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.21712052822113037, "policy_loss": -0.00010925603419309482, "vf_loss": 0.21722978353500366, "vf_explained_var": 0.8454844355583191, "kl": 0.0007998812361620367, "entropy": 1.0002251863479614, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 154.14874267578125, "policy_loss": -0.0004885440575890243, "vf_loss": 154.1492156982422, "vf_explained_var": 5.108969691747234e-09, "kl": 0.00018569584062788635, "entropy": 1.2791863679885864, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2675200, "episodes_total": 766, "training_iteration": 152, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-51-11", "timestamp": 1714567871, "time_this_iter_s": 70.44274139404297, "time_total_s": 10467.855409622192, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d216fa050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10467.855409622192, "timesteps_since_restore": 2675200, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 38.635999999999996, "ram_util_percent": 81.51299999999998}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 73.55202630950731, "episode_len_mean": 3500.0, "episodes_this_iter": 2, "policy_reward_min": {"cav": 432.5380959363073, "tl": -36.66273286298727}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -28.61627121830681}, "policy_reward_mean": {"cav": 457.05497667272414, "tl": -31.95857919693494}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.351820689188887, "mean_processing_ms": 3.5369056158068424, "mean_inference_ms": 0.8278522413221664}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11737088, "num_steps_sampled": 2692800, "sample_time_ms": 49194.036, "load_time_ms": 97.457, "grad_time_ms": 19290.954, "update_time_ms": 3.769, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 143.91502380371094, "policy_loss": 0.0015427540056407452, "vf_loss": 143.91346740722656, "vf_explained_var": -1.2681838912342869e-09, "kl": 0.00018107035430148244, "entropy": 1.2736512422561646, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07341721653938293, "policy_loss": -0.00016307324403896928, "vf_loss": 0.0735802948474884, "vf_explained_var": 0.9307661652565002, "kl": 0.0006616499740630388, "entropy": 0.9975600242614746, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2692800, "episodes_total": 768, "training_iteration": 153, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-52-20", "timestamp": 1714567940, "time_this_iter_s": 69.00247955322266, "time_total_s": 10536.857889175415, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10536.857889175415, "timesteps_since_restore": 2692800, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 35.673469387755105, "ram_util_percent": 81.38367346938776}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 11.569048313958486, "episode_reward_mean": 73.60257460211898, "episode_len_mean": 3500.0, "episodes_this_iter": 7, "policy_reward_min": {"cav": 432.5380959363073, "tl": -35.692175437789516}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.18812094447617, "tl": -31.882128861863336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.352625499334277, "mean_processing_ms": 3.536842194902747, "mean_inference_ms": 0.8272434621458425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11744768, "num_steps_sampled": 2710400, "sample_time_ms": 49433.275, "load_time_ms": 97.202, "grad_time_ms": 19380.735, "update_time_ms": 3.82, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.22929349541664124, "policy_loss": -0.0005672185216099024, "vf_loss": 0.22986070811748505, "vf_explained_var": 0.8621636629104614, "kl": 0.008080195635557175, "entropy": 1.0172669887542725, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 161.4532012939453, "policy_loss": 2.1324120098142885e-05, "vf_loss": 161.4531707763672, "vf_explained_var": -5.9604645663569045e-09, "kl": 8.649846131447703e-05, "entropy": 1.2687504291534424, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2710400, "episodes_total": 775, "training_iteration": 154, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-53-35", "timestamp": 1714568015, "time_this_iter_s": 74.5278754234314, "time_total_s": 10611.385764598846, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f613b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10611.385764598846, "timesteps_since_restore": 2710400, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 36.45981308411215, "ram_util_percent": 81.5570093457944}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 136.38064640548885, "episode_reward_min": 23.727366115453886, "episode_reward_mean": 76.15337153993738, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.5380959363073, "tl": -35.6381554915813}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.2101639372278, "tl": -31.67139936644106}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.348994968889084, "mean_processing_ms": 3.5364498715975077, "mean_inference_ms": 0.8269323037460573}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11748480, "num_steps_sampled": 2728000, "sample_time_ms": 49843.787, "load_time_ms": 97.099, "grad_time_ms": 19337.695, "update_time_ms": 3.817, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15537136793136597, "policy_loss": -0.00015022743900772184, "vf_loss": 0.15552161633968353, "vf_explained_var": 0.8518538475036621, "kl": 0.001427013543434441, "entropy": 1.0340275764465332, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 160.79652404785156, "policy_loss": -1.3169543535695993e-06, "vf_loss": 160.79653930664062, "vf_explained_var": 2.055332570805035e-09, "kl": 0.00012876420805696398, "entropy": 1.2564078569412231, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2728000, "episodes_total": 780, "training_iteration": 155, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-54-45", "timestamp": 1714568085, "time_this_iter_s": 70.10173344612122, "time_total_s": 10681.487498044968, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218884d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10681.487498044968, "timesteps_since_restore": 2728000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 37.767, "ram_util_percent": 81.74199999999999}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 141.32114460129532, "episode_reward_min": 31.817554438882212, "episode_reward_mean": 78.74391020454374, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.847759057776464}, "policy_reward_max": {"cav": 500.0771377711744, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.6409913187155, "tl": -31.491423426181196}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.346721732363108, "mean_processing_ms": 3.5364423072286866, "mean_inference_ms": 0.8267443578124376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11959680, "num_steps_sampled": 2745600, "sample_time_ms": 50080.882, "load_time_ms": 96.504, "grad_time_ms": 19354.78, "update_time_ms": 3.834, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 165.97232055664062, "policy_loss": -0.0007115211919881403, "vf_loss": 165.97300720214844, "vf_explained_var": 9.771253139945202e-09, "kl": 0.000565595633815974, "entropy": 1.2474745512008667, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13017398118972778, "policy_loss": -0.00034209611476399004, "vf_loss": 0.13051608204841614, "vf_explained_var": 0.9082847237586975, "kl": 0.003704531118273735, "entropy": 1.0013761520385742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2745600, "episodes_total": 784, "training_iteration": 156, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-55-56", "timestamp": 1714568156, "time_this_iter_s": 71.23980689048767, "time_total_s": 10752.727304935455, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dcdd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10752.727304935455, "timesteps_since_restore": 2745600, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 35.962376237623765, "ram_util_percent": 81.7178217821782}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 141.32114460129532, "episode_reward_min": 31.817554438882212, "episode_reward_mean": 80.37747897239163, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.847759057776464}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.413363416442, "tl": -31.336323703671084}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.3498334308705, "mean_processing_ms": 3.5376894423916183, "mean_inference_ms": 0.8265172118607296}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11965696, "num_steps_sampled": 2763200, "sample_time_ms": 49786.298, "load_time_ms": 96.546, "grad_time_ms": 19387.623, "update_time_ms": 3.837, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18762588500976562, "policy_loss": -0.000368542387150228, "vf_loss": 0.18799443542957306, "vf_explained_var": 0.865311324596405, "kl": 0.004047127440571785, "entropy": 0.993058979511261, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 153.6244354248047, "policy_loss": -0.0040206010453403, "vf_loss": 153.62844848632812, "vf_explained_var": 7.609103569450326e-09, "kl": 0.0004896217724308372, "entropy": 1.257048487663269, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2763200, "episodes_total": 790, "training_iteration": 157, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-57-03", "timestamp": 1714568223, "time_this_iter_s": 67.2380645275116, "time_total_s": 10819.965369462967, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21775c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10819.965369462967, "timesteps_since_restore": 2763200, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 39.47708333333333, "ram_util_percent": 81.74270833333334}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 141.32114460129532, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 82.18325098618004, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 457.23588323707077, "tl": -31.254386020907774}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.34828034635058, "mean_processing_ms": 3.538026895063847, "mean_inference_ms": 0.8266425784654494}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11971072, "num_steps_sampled": 2780800, "sample_time_ms": 50317.14, "load_time_ms": 96.358, "grad_time_ms": 19386.174, "update_time_ms": 3.843, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12585702538490295, "policy_loss": -0.0002808905264828354, "vf_loss": 0.12613791227340698, "vf_explained_var": 0.9013502597808838, "kl": 0.004236108157783747, "entropy": 0.9934632182121277, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 154.83383178710938, "policy_loss": 2.715576920309104e-05, "vf_loss": 154.83380126953125, "vf_explained_var": -4.257474817137563e-09, "kl": 0.0002851811586879194, "entropy": 1.252065896987915, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2780800, "episodes_total": 794, "training_iteration": 158, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-58-13", "timestamp": 1714568293, "time_this_iter_s": 69.62777519226074, "time_total_s": 10889.593144655228, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c20f61710>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10889.593144655228, "timesteps_since_restore": 2780800, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 36.16499999999999, "ram_util_percent": 81.77999999999999}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 142.69770308562983, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 83.01710536822948, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.59697105928177, "tl": -31.13165547425462}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.34291570421633, "mean_processing_ms": 3.5364407399119266, "mean_inference_ms": 0.8258276517418927}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11978240, "num_steps_sampled": 2798400, "sample_time_ms": 50280.89, "load_time_ms": 96.251, "grad_time_ms": 19421.679, "update_time_ms": 3.864, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18725815415382385, "policy_loss": -0.0002450512256473303, "vf_loss": 0.1875031739473343, "vf_explained_var": 0.8855630159378052, "kl": 0.0034064073115587234, "entropy": 0.9991501569747925, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 146.00259399414062, "policy_loss": -0.0008250506944023073, "vf_loss": 146.00343322753906, "vf_explained_var": 2.1287374085687816e-09, "kl": 4.0977603930514306e-05, "entropy": 1.2554171085357666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2798400, "episodes_total": 800, "training_iteration": 159, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_20-59-25", "timestamp": 1714568365, "time_this_iter_s": 72.07334876060486, "time_total_s": 10961.666493415833, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10961.666493415833, "timesteps_since_restore": 2798400, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 36.584466019417476, "ram_util_percent": 81.84951456310677}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 142.69770308562983, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 83.16899029088137, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.6092327842387, "tl": -31.120020207780012}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.341102942907504, "mean_processing_ms": 3.5364000830298488, "mean_inference_ms": 0.8255466497045871}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11984640, "num_steps_sampled": 2816000, "sample_time_ms": 50116.362, "load_time_ms": 95.884, "grad_time_ms": 19447.55, "update_time_ms": 3.894, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13156510889530182, "policy_loss": -0.00025673737400211394, "vf_loss": 0.13182184100151062, "vf_explained_var": 0.9064730405807495, "kl": 0.0014530736953020096, "entropy": 0.9693180322647095, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 145.67816162109375, "policy_loss": -0.0022854148410260677, "vf_loss": 145.68043518066406, "vf_explained_var": -2.38418573772492e-09, "kl": 0.0004732356173917651, "entropy": 1.273361325263977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2816000, "episodes_total": 804, "training_iteration": 160, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-00-30", "timestamp": 1714568430, "time_this_iter_s": 64.62664532661438, "time_total_s": 11026.293138742447, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11026.293138742447, "timesteps_since_restore": 2816000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 39.3445652173913, "ram_util_percent": 81.82608695652173}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 142.69770308562983, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 83.89214363686479, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 457.18263838662386, "tl": -31.107541229146804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.344319895151877, "mean_processing_ms": 3.537773946362646, "mean_inference_ms": 0.8254314455497759}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11991168, "num_steps_sampled": 2833600, "sample_time_ms": 50496.721, "load_time_ms": 95.988, "grad_time_ms": 19441.685, "update_time_ms": 3.991, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1562153398990631, "policy_loss": -4.46164958702866e-05, "vf_loss": 0.1562599539756775, "vf_explained_var": 0.8917554616928101, "kl": 0.0004094019823241979, "entropy": 0.9708932638168335, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 134.12435913085938, "policy_loss": 0.0016848532250151038, "vf_loss": 134.12266540527344, "vf_explained_var": -7.0123111761688506e-09, "kl": 0.00024724900140427053, "entropy": 1.2784689664840698, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2833600, "episodes_total": 809, "training_iteration": 161, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-01-42", "timestamp": 1714568502, "time_this_iter_s": 71.79770708084106, "time_total_s": 11098.090845823288, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21722440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11098.090845823288, "timesteps_since_restore": 2833600, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 36.15196078431373, "ram_util_percent": 81.86568627450978}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 142.69770308562983, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 83.71477396177988, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.5380959363073, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.782676093990872}, "policy_reward_mean": {"cav": 456.4229159595319, "tl": -31.05901183314619}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.343471321940434, "mean_processing_ms": 3.5371061574231653, "mean_inference_ms": 0.8251910358190868}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11997952, "num_steps_sampled": 2851200, "sample_time_ms": 50036.78, "load_time_ms": 95.412, "grad_time_ms": 19445.517, "update_time_ms": 3.964, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15407811105251312, "policy_loss": -0.0010797905270010233, "vf_loss": 0.1551578938961029, "vf_explained_var": 0.8996763825416565, "kl": 0.015218467451632023, "entropy": 0.9612948298454285, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 158.28797912597656, "policy_loss": -0.0012698516948148608, "vf_loss": 158.28924560546875, "vf_explained_var": 7.87231169141478e-09, "kl": 0.000118647440103814, "entropy": 1.2798140048980713, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2851200, "episodes_total": 814, "training_iteration": 162, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-02-48", "timestamp": 1714568568, "time_this_iter_s": 65.87444043159485, "time_total_s": 11163.965286254883, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc3b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11163.965286254883, "timesteps_since_restore": 2851200, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 39.5436170212766, "ram_util_percent": 81.90957446808508}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 142.69770308562983, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 84.88803749685843, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.02068622452674, "tl": -27.72687147229958}, "policy_reward_mean": {"cav": 456.6135766504629, "tl": -30.977128262800566}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.33674598362991, "mean_processing_ms": 3.536227787251305, "mean_inference_ms": 0.8247196246697848}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12006016, "num_steps_sampled": 2868800, "sample_time_ms": 49846.959, "load_time_ms": 95.813, "grad_time_ms": 19466.154, "update_time_ms": 3.947, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18454483151435852, "policy_loss": -0.00033781296224333346, "vf_loss": 0.18488264083862305, "vf_explained_var": 0.8958283066749573, "kl": 0.00230608438141644, "entropy": 0.9750014543533325, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 124.1712646484375, "policy_loss": -0.000686876883264631, "vf_loss": 124.17195892333984, "vf_explained_var": 0.0, "kl": 0.0004474788729567081, "entropy": 1.3000980615615845, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2868800, "episodes_total": 820, "training_iteration": 163, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-03-55", "timestamp": 1714568635, "time_this_iter_s": 67.31441617012024, "time_total_s": 11231.279702425003, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dca70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11231.279702425003, "timesteps_since_restore": 2868800, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 39.543749999999996, "ram_util_percent": 81.95520833333332}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 85.60952690589575, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.2158397788504, "tl": -27.72687147229958}, "policy_reward_mean": {"cav": 456.75928397390527, "tl": -30.92914642233428}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.338234042285197, "mean_processing_ms": 3.5369092796763266, "mean_inference_ms": 0.8244951736198335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12012800, "num_steps_sampled": 2886400, "sample_time_ms": 49644.985, "load_time_ms": 96.391, "grad_time_ms": 19478.798, "update_time_ms": 3.86, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15318720042705536, "policy_loss": -0.0002678268647287041, "vf_loss": 0.1534550040960312, "vf_explained_var": 0.9135028123855591, "kl": 0.0022603655233979225, "entropy": 0.9504119157791138, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 126.36896514892578, "policy_loss": 0.0004523357201833278, "vf_loss": 126.3685073852539, "vf_explained_var": -1.3495391470996765e-08, "kl": 0.00015202743816189468, "entropy": 1.294451355934143, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2886400, "episodes_total": 825, "training_iteration": 164, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-05-08", "timestamp": 1714568708, "time_this_iter_s": 72.63784623146057, "time_total_s": 11303.917548656464, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8c23b714d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11303.917548656464, "timesteps_since_restore": 2886400, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 35.68557692307692, "ram_util_percent": 81.88750000000002}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 86.10832088844167, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.2158397788504, "tl": -27.407602882577834}, "policy_reward_mean": {"cav": 456.631721647839, "tl": -30.876950063283257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.335856065123757, "mean_processing_ms": 3.536679198007459, "mean_inference_ms": 0.824629043279019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12020608, "num_steps_sampled": 2904000, "sample_time_ms": 49324.862, "load_time_ms": 96.945, "grad_time_ms": 19455.858, "update_time_ms": 3.86, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12960602343082428, "policy_loss": -6.591829151147977e-05, "vf_loss": 0.12967194616794586, "vf_explained_var": 0.9251551628112793, "kl": 0.0004979940713383257, "entropy": 0.9594535231590271, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 124.15189361572266, "policy_loss": 0.0008083268185146153, "vf_loss": 124.15107727050781, "vf_explained_var": -2.9313760308014025e-09, "kl": 2.034871795331128e-05, "entropy": 1.2937836647033691, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2904000, "episodes_total": 829, "training_iteration": 165, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-06-14", "timestamp": 1714568774, "time_this_iter_s": 66.6735429763794, "time_total_s": 11370.591091632843, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d218158c0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11370.591091632843, "timesteps_since_restore": 2904000, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 39.857894736842105, "ram_util_percent": 82.0}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 87.11452672547114, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.2158397788504, "tl": -27.407602882577834}, "policy_reward_mean": {"cav": 456.8238068230064, "tl": -30.809106674794755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.33387176646478, "mean_processing_ms": 3.5365484961951164, "mean_inference_ms": 0.8244289310763934}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12028800, "num_steps_sampled": 2921600, "sample_time_ms": 49298.397, "load_time_ms": 97.48, "grad_time_ms": 19452.104, "update_time_ms": 3.845, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.17538419365882874, "policy_loss": -0.00031163994572125375, "vf_loss": 0.17569583654403687, "vf_explained_var": 0.9004563093185425, "kl": 0.0026660659350454807, "entropy": 0.9298073053359985, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 108.3779296875, "policy_loss": -0.0002684728242456913, "vf_loss": 108.37818908691406, "vf_explained_var": -1.862645149230957e-09, "kl": 0.0006724032573401928, "entropy": 1.3123517036437988, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2921600, "episodes_total": 835, "training_iteration": 166, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-07-25", "timestamp": 1714568845, "time_this_iter_s": 70.94210171699524, "time_total_s": 11441.533193349838, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d217224d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11441.533193349838, "timesteps_since_restore": 2921600, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 37.687128712871285, "ram_util_percent": 82.02574257425744}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 89.73594330991239, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.2158397788504, "tl": -26.165529750950448}, "policy_reward_mean": {"cav": 456.75067181512713, "tl": -30.58456070876804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.333762675133798, "mean_processing_ms": 3.5367656393659495, "mean_inference_ms": 0.8238534544690779}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12240000, "num_steps_sampled": 2939200, "sample_time_ms": 49622.656, "load_time_ms": 97.576, "grad_time_ms": 19463.982, "update_time_ms": 3.828, "learner": {"cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 133.1822052001953, "policy_loss": -0.0017063709674403071, "vf_loss": 133.18389892578125, "vf_explained_var": -1.5172091138992982e-08, "kl": 0.0001350629609078169, "entropy": 1.322963833808899, "entropy_coeff": 0.0}, "tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.17657925188541412, "policy_loss": -0.0002767831610981375, "vf_loss": 0.17685605585575104, "vf_explained_var": 0.9078201651573181, "kl": 0.0028769588097929955, "entropy": 0.9388068318367004, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2939200, "episodes_total": 841, "training_iteration": 167, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-08-36", "timestamp": 1714568916, "time_this_iter_s": 70.59921097755432, "time_total_s": 11512.132404327393, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d230dc950>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11512.132404327393, "timesteps_since_restore": 2939200, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 36.93366336633664, "ram_util_percent": 82.02574257425745}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 90.12266996879798, "episode_len_mean": 3500.0, "episodes_this_iter": 3, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.2158397788504, "tl": -26.165529750950448}, "policy_reward_mean": {"cav": 456.5926054235798, "tl": -30.53916128789864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.330036661454532, "mean_processing_ms": 3.5361908988761837, "mean_inference_ms": 0.8237330682839895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12248576, "num_steps_sampled": 2956800, "sample_time_ms": 49018.101, "load_time_ms": 97.667, "grad_time_ms": 19460.115, "update_time_ms": 3.833, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09845408797264099, "policy_loss": -0.0004747177008539438, "vf_loss": 0.0989287942647934, "vf_explained_var": 0.9500830769538879, "kl": 0.001993755344301462, "entropy": 0.9796620607376099, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 106.86946868896484, "policy_loss": -0.0019342120504006743, "vf_loss": 106.87140655517578, "vf_explained_var": 1.2454702158493092e-08, "kl": 0.0006703388062305748, "entropy": 1.3241722583770752, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2956800, "episodes_total": 844, "training_iteration": 168, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-09-39", "timestamp": 1714568979, "time_this_iter_s": 63.54375863075256, "time_total_s": 11575.676162958145, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888ef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11575.676162958145, "timesteps_since_restore": 2956800, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 39.07032967032966, "ram_util_percent": 82.0725274725275}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 90.7745885420638, "episode_len_mean": 3500.0, "episodes_this_iter": 5, "policy_reward_min": {"cav": 432.53132354288937, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.3678775020507, "tl": -26.165529750950448}, "policy_reward_mean": {"cav": 457.1485175723364, "tl": -30.531160752522883}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.333864572051592, "mean_processing_ms": 3.5375693116460436, "mean_inference_ms": 0.8237873729891547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12256768, "num_steps_sampled": 2974400, "sample_time_ms": 48405.508, "load_time_ms": 98.243, "grad_time_ms": 19435.109, "update_time_ms": 3.817, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14881622791290283, "policy_loss": -0.00018151030235458165, "vf_loss": 0.1489977389574051, "vf_explained_var": 0.9271888136863708, "kl": 0.0009743478731252253, "entropy": 0.9543126821517944, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 110.1812973022461, "policy_loss": 0.0005338224582374096, "vf_loss": 110.1807632446289, "vf_explained_var": -4.6566128730773926e-09, "kl": 4.154795897193253e-05, "entropy": 1.326981782913208, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2974400, "episodes_total": 849, "training_iteration": 169, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-10-45", "timestamp": 1714569045, "time_this_iter_s": 65.70131587982178, "time_total_s": 11641.377478837967, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21888290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11641.377478837967, "timesteps_since_restore": 2974400, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 40.15376344086022, "ram_util_percent": 82.06021505376347}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
{"episode_reward_max": 148.6913942483526, "episode_reward_min": 41.43945792961007, "episode_reward_mean": 90.75611047116392, "episode_len_mean": 3500.0, "episodes_this_iter": 6, "policy_reward_min": {"cav": 432.3954963194807, "tl": -34.4875285701222}, "policy_reward_max": {"cav": 500.3678775020507, "tl": -26.165529750950448}, "policy_reward_mean": {"cav": 456.82706623375265, "tl": -30.505912980215907}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 16.328056579729463, "mean_processing_ms": 3.5364238594346347, "mean_inference_ms": 0.8236288752381785}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12264192, "num_steps_sampled": 2992000, "sample_time_ms": 49163.312, "load_time_ms": 98.087, "grad_time_ms": 19419.915, "update_time_ms": 3.793, "learner": {"tl": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16952337324619293, "policy_loss": -0.0004452501598279923, "vf_loss": 0.1699686348438263, "vf_explained_var": 0.9069205522537231, "kl": 0.006568240933120251, "entropy": 0.948052704334259, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 128.25894165039062, "policy_loss": -0.0010208541061729193, "vf_loss": 128.2599639892578, "vf_explained_var": 1.2331995868919421e-08, "kl": 0.00015187569078989327, "entropy": 1.3178117275238037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 17600, "done": false, "timesteps_total": 2992000, "episodes_total": 855, "training_iteration": 170, "experiment_id": "51b0b104e128490da3c318662d570531", "date": "2024-05-01_21-11-57", "timestamp": 1714569117, "time_this_iter_s": 72.051931142807, "time_total_s": 11713.429409980774, "pid": 8113, "hostname": "g-System-Product-Name", "node_ip": "10.208.143.112", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 17500, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_3x4_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 4,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 3,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_12\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_4\",\n                    \"end\": 86400,\n                    \"name\": \"flow_13\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 13,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(72,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f8d21795b00>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11713.429409980774, "timesteps_since_restore": 2992000, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 36.92038834951455, "ram_util_percent": 82.08640776699032}, "num_healthy_workers": 8, "trial_id": "176e92a8", "experiment_tag": "0"}
