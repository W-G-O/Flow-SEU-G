{"episode_reward_max": -29.653506335712162, "episode_reward_min": -35.86100367316058, "episode_reward_mean": -33.71455590297492, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 0.0, "tl": -35.86100367316058}, "policy_reward_max": {"cav": 0.0, "tl": -29.653506335712162}, "policy_reward_mean": {"cav": 0.0, "tl": -33.71455590297492}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.7267553544779415, "mean_processing_ms": 0.7824441586160488, "mean_inference_ms": 0.6032288984867045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9, "num_steps_sampled": 28000, "sample_time_ms": 18725.118, "load_time_ms": 186.533, "grad_time_ms": 2588.244, "update_time_ms": 2404.738, "learner": {"tl": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.018230076879262924, "policy_loss": -0.0031880238093435764, "vf_loss": 0.021036870777606964, "vf_explained_var": 0.010634652338922024, "kl": 0.0019061511848121881, "entropy": 1.3843843936920166, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 8.924516677856445, "policy_loss": -0.0014223349280655384, "vf_loss": 8.925938606262207, "vf_explained_var": 1.1920928955078125e-07, "kl": 3.039836883544922e-06, "entropy": 1.4224433898925781, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 28000, "episodes_total": 4, "training_iteration": 1, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-37-46", "timestamp": 1714829866, "time_this_iter_s": 24.053179502487183, "time_total_s": 24.053179502487183, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135fd40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24.053179502487183, "timesteps_since_restore": 28000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.486111111111114, "ram_util_percent": 56.463888888888896}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 1.6236301213086501, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -29.97771113963808, "episode_len_mean": 3500.0, "episodes_this_iter": 10, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 30.68175670242552, "tl": -28.032523707420555}, "policy_reward_mean": {"cav": 9.166874638442206, "tl": -32.596818179192965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.5051605838300945, "mean_processing_ms": 0.7841278918176666, "mean_inference_ms": 0.595558204659809}, "off_policy_estimator": {}, "info": {"num_steps_trained": 69, "num_steps_sampled": 56000, "sample_time_ms": 18610.656, "load_time_ms": 98.878, "grad_time_ms": 2404.262, "update_time_ms": 1205.466, "learner": {"tl": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 0.012459959834814072, "policy_loss": -0.007037679199129343, "vf_loss": 0.018656788393855095, "vf_explained_var": 0.03524896129965782, "kl": 0.008408525958657265, "entropy": 1.3675956726074219, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 110.2232437133789, "policy_loss": 0.00014932453632354736, "vf_loss": 110.22309875488281, "vf_explained_var": 0.0, "kl": 4.172325134277344e-07, "entropy": 1.4220623970031738, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 56000, "episodes_total": 14, "training_iteration": 2, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-38-07", "timestamp": 1714829887, "time_this_iter_s": 20.741114377975464, "time_total_s": 44.79429388046265, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135fc20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44.79429388046265, "timesteps_since_restore": 56000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.90689655172413, "ram_util_percent": 52.841379310344834}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 1.6236301213086501, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -27.401045591860235, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 30.68175670242552, "tl": -20.76145544905352}, "policy_reward_mean": {"cav": 9.945225886390368, "tl": -30.113379924512138}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.4229512317422435, "mean_processing_ms": 0.7920587461594107, "mean_inference_ms": 0.5911666733551566}, "off_policy_estimator": {}, "info": {"num_steps_trained": 115, "num_steps_sampled": 84000, "sample_time_ms": 17765.907, "load_time_ms": 71.349, "grad_time_ms": 2357.195, "update_time_ms": 804.872, "learner": {"tl": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0073717874474823475, "policy_loss": -0.008223584853112698, "vf_loss": 0.01504803542047739, "vf_explained_var": 0.04893709719181061, "kl": 0.010946767404675484, "entropy": 1.3275625705718994, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 72.43848419189453, "policy_loss": -9.040210716193542e-05, "vf_loss": 72.4385757446289, "vf_explained_var": 0.0, "kl": 5.960464477539063e-08, "entropy": 1.4220530986785889, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 84000, "episodes_total": 22, "training_iteration": 3, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-38-25", "timestamp": 1714829905, "time_this_iter_s": 18.369001150131226, "time_total_s": 63.16329503059387, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fabe200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 63.16329503059387, "timesteps_since_restore": 84000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.7962962962963, "ram_util_percent": 52.918518518518525}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 4.066585302394865, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -24.34621938204553, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 30.68175670242552, "tl": -16.636524067798508}, "policy_reward_mean": {"cav": 11.011704968914557, "tl": -27.282674040422737}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.363258501357057, "mean_processing_ms": 0.8023811537909165, "mean_inference_ms": 0.5887952238801257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 123, "num_steps_sampled": 112000, "sample_time_ms": 17294.816, "load_time_ms": 56.342, "grad_time_ms": 2328.319, "update_time_ms": 604.991, "learner": {"tl": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004366172477602959, "policy_loss": -0.009049414657056332, "vf_loss": 0.01287492923438549, "vf_explained_var": 0.03694329038262367, "kl": 0.010813159868121147, "entropy": 1.2675485610961914, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 8.303994178771973, "policy_loss": -0.0006144419312477112, "vf_loss": 8.304608345031738, "vf_explained_var": 0.0, "kl": 1.1920928955078125e-06, "entropy": 1.4217461347579956, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 112000, "episodes_total": 30, "training_iteration": 4, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-38-43", "timestamp": 1714829923, "time_this_iter_s": 18.147346258163452, "time_total_s": 81.31064128875732, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac450aa950>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 81.31064128875732, "timesteps_since_restore": 112000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.884615384615394, "ram_util_percent": 52.900000000000006}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 4.066585302394865, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -21.87852426520837, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 30.68175670242552, "tl": -12.72161720269568}, "policy_reward_mean": {"cav": 10.03259906911636, "tl": -24.782697679952584}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3177301776320376, "mean_processing_ms": 0.8100988245199098, "mean_inference_ms": 0.5869245211118768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 201, "num_steps_sampled": 140000, "sample_time_ms": 16982.994, "load_time_ms": 47.399, "grad_time_ms": 2312.631, "update_time_ms": 484.83, "learner": {"tl": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 0.006915173958986998, "policy_loss": -0.002840197877958417, "vf_loss": 0.009602019563317299, "vf_explained_var": 0.03743831068277359, "kl": 0.0030670263804495335, "entropy": 1.2272469997406006, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 117.17415618896484, "policy_loss": -1.3051889027337893e-06, "vf_loss": 117.17416381835938, "vf_explained_var": 0.0, "kl": 5.960464477539062e-07, "entropy": 1.4215019941329956, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 140000, "episodes_total": 38, "training_iteration": 5, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-39-01", "timestamp": 1714829941, "time_this_iter_s": 18.008468866348267, "time_total_s": 99.31911015510559, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135f050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 99.31911015510559, "timesteps_since_restore": 140000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.663999999999994, "ram_util_percent": 52.907999999999994}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -19.382055993296866, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -10.351118222926988}, "policy_reward_mean": {"cav": 10.729165568230856, "tl": -22.64745420971495}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2808540766972287, "mean_processing_ms": 0.8164149616497367, "mean_inference_ms": 0.5855064753240056}, "off_policy_estimator": {}, "info": {"num_steps_trained": 218, "num_steps_sampled": 168000, "sample_time_ms": 16759.867, "load_time_ms": 41.347, "grad_time_ms": 2340.887, "update_time_ms": 404.668, "learner": {"tl": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00849063042551279, "policy_loss": -0.0018562966724857688, "vf_loss": 0.010301410220563412, "vf_explained_var": 0.03156544640660286, "kl": 0.0018207477405667305, "entropy": 1.2013094425201416, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 16.894763946533203, "policy_loss": -0.0006068629445508122, "vf_loss": 16.895370483398438, "vf_explained_var": 0.0, "kl": 8.344650268554688e-07, "entropy": 1.4218418598175049, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 168000, "episodes_total": 46, "training_iteration": 6, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-39-19", "timestamp": 1714829959, "time_this_iter_s": 18.148564100265503, "time_total_s": 117.4676742553711, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fad6440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 117.4676742553711, "timesteps_since_restore": 168000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.30384615384616, "ram_util_percent": 52.830769230769235}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -17.98284878517637, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -10.351118222926988}, "policy_reward_mean": {"cav": 9.669466850217177, "tl": -21.026940200985475}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.250657280824973, "mean_processing_ms": 0.8212616401601538, "mean_inference_ms": 0.5843950843020479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 264, "num_steps_sampled": 196000, "sample_time_ms": 16604.293, "load_time_ms": 37.08, "grad_time_ms": 2360.635, "update_time_ms": 347.438, "learner": {"tl": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009726922027766705, "policy_loss": -0.0013026680098846555, "vf_loss": 0.011008023284375668, "vf_explained_var": 0.034906502813100815, "kl": 0.0017254119738936424, "entropy": 1.1762733459472656, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 76.86650848388672, "policy_loss": -0.0001782749022822827, "vf_loss": 76.86669158935547, "vf_explained_var": 0.0, "kl": 1.0728836059570312e-06, "entropy": 1.4226471185684204, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 196000, "episodes_total": 54, "training_iteration": 7, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-39-38", "timestamp": 1714829978, "time_this_iter_s": 18.172773599624634, "time_total_s": 135.64044785499573, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fabeb00>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 135.64044785499573, "timesteps_since_restore": 196000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.207692307692305, "ram_util_percent": 52.896153846153844}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -16.64205319100525, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -8.87654098987449}, "policy_reward_mean": {"cav": 9.82205801274621, "tl": -19.810459001568542}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2252150646130664, "mean_processing_ms": 0.8255191622163208, "mean_inference_ms": 0.5841280414129741}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28168, "num_steps_sampled": 224000, "sample_time_ms": 16495.452, "load_time_ms": 33.783, "grad_time_ms": 2362.735, "update_time_ms": 304.504, "learner": {"tl": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009468861855566502, "policy_loss": -0.0022119355853646994, "vf_loss": 0.011667991057038307, "vf_explained_var": 0.020869320258498192, "kl": 0.002049198839813471, "entropy": 1.139410138130188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 224000, "episodes_total": 62, "training_iteration": 8, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-39-56", "timestamp": 1714829996, "time_this_iter_s": 18.134321689605713, "time_total_s": 153.77476954460144, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fad63b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 153.77476954460144, "timesteps_since_restore": 224000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.62307692307692, "ram_util_percent": 52.92307692307692}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -15.859173116940697, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -8.87654098987449}, "policy_reward_mean": {"cav": 9.47933650114186, "tl": -18.83839316015671}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.203458165038756, "mean_processing_ms": 0.8287835148514434, "mean_inference_ms": 0.5837856428526127}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28212, "num_steps_sampled": 252000, "sample_time_ms": 16403.514, "load_time_ms": 31.323, "grad_time_ms": 2350.798, "update_time_ms": 271.091, "learner": {"tl": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 0.013276174664497375, "policy_loss": -0.00023986522865016013, "vf_loss": 0.013515050522983074, "vf_explained_var": 0.02381369099020958, "kl": 0.0003171049174852669, "entropy": 1.1226719617843628, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 33.21805191040039, "policy_loss": 5.5145133956102654e-05, "vf_loss": 33.217994689941406, "vf_explained_var": 0.0, "kl": 0.0, "entropy": 1.4229130744934082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 252000, "episodes_total": 70, "training_iteration": 9, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-40-14", "timestamp": 1714830014, "time_this_iter_s": 17.94940996170044, "time_total_s": 171.72417950630188, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fad6050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 171.72417950630188, "timesteps_since_restore": 252000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.8423076923077, "ram_util_percent": 52.94615384615384}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -14.981895316880355, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -8.72854890207845}, "policy_reward_mean": {"cav": 9.280418593462798, "tl": -17.956388455810732}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1844721251801857, "mean_processing_ms": 0.8316700603940748, "mean_inference_ms": 0.5832988272007299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56116, "num_steps_sampled": 280000, "sample_time_ms": 16313.951, "load_time_ms": 29.299, "grad_time_ms": 2348.643, "update_time_ms": 244.354, "learner": {"tl": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 0.013294770382344723, "policy_loss": -0.0007394814165309072, "vf_loss": 0.014033416286110878, "vf_explained_var": 0.027027202770113945, "kl": 0.0005333770532160997, "entropy": 1.1072413921356201, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 280000, "episodes_total": 78, "training_iteration": 10, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-40-32", "timestamp": 1714830032, "time_this_iter_s": 17.85993981361389, "time_total_s": 189.58411931991577, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fab1440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 189.58411931991577, "timesteps_since_restore": 280000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.012, "ram_util_percent": 52.924}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -14.476361578855313, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -8.72854890207845}, "policy_reward_mean": {"cav": 8.886425735901437, "tl": -17.266285937801108}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1678900562957524, "mean_processing_ms": 0.8341115113949354, "mean_inference_ms": 0.5828474783263146}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56161, "num_steps_sampled": 308000, "sample_time_ms": 16003.978, "load_time_ms": 11.926, "grad_time_ms": 2349.639, "update_time_ms": 4.272, "learner": {"tl": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01253428403288126, "policy_loss": -0.0006010206998325884, "vf_loss": 0.013134912587702274, "vf_explained_var": 0.02303236722946167, "kl": 0.0005024080746807158, "entropy": 1.0919288396835327, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 25.265670776367188, "policy_loss": -8.739100303500891e-05, "vf_loss": 25.265758514404297, "vf_explained_var": -1.1920928955078125e-07, "kl": 1.1920928955078125e-07, "entropy": 1.4231696128845215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 308000, "episodes_total": 86, "training_iteration": 11, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-40-50", "timestamp": 1714830050, "time_this_iter_s": 18.248260259628296, "time_total_s": 207.83237957954407, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135fdd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 207.83237957954407, "timesteps_since_restore": 308000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.05384615384615, "ram_util_percent": 52.94230769230769}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -13.75158850902004, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -7.5104272325352515}, "policy_reward_mean": {"cav": 8.932953405803426, "tl": -16.602531085340285}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1530856293280114, "mean_processing_ms": 0.8363676825234035, "mean_inference_ms": 0.5823196683936817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56162, "num_steps_sampled": 336000, "sample_time_ms": 15697.168, "load_time_ms": 12.038, "grad_time_ms": 2350.181, "update_time_ms": 4.001, "learner": {"tl": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01254788413643837, "policy_loss": -0.0010270490311086178, "vf_loss": 0.0135747529566288, "vf_explained_var": 0.024015286937355995, "kl": 0.0004686143365688622, "entropy": 1.0717968940734863, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00015024396998342127, "policy_loss": 0.0, "vf_loss": 0.00015024392632767558, "vf_explained_var": -1.0, "kl": 1.1920928955078125e-07, "entropy": 1.423559546470642, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 336000, "episodes_total": 94, "training_iteration": 12, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-41-08", "timestamp": 1714830068, "time_this_iter_s": 17.677263975143433, "time_total_s": 225.5096435546875, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fab13b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 225.5096435546875, "timesteps_since_restore": 336000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 46.08, "ram_util_percent": 52.972}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -37.47782155934061, "episode_reward_mean": -12.926058561633733, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -37.47782155934061}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -7.5104272325352515}, "policy_reward_mean": {"cav": 8.699399352717244, "tl": -15.709866354503252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1286076211882237, "mean_processing_ms": 0.8394250473705046, "mean_inference_ms": 0.5813166342802084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56189, "num_steps_sampled": 364000, "sample_time_ms": 15648.733, "load_time_ms": 11.564, "grad_time_ms": 2332.565, "update_time_ms": 4.032, "learner": {"tl": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01214560680091381, "policy_loss": -0.0018694662721827626, "vf_loss": 0.01401462871581316, "vf_explained_var": 0.03767414391040802, "kl": 0.0022619718220084906, "entropy": 1.052643060684204, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 17.582115173339844, "policy_loss": -0.00017084898718167096, "vf_loss": 17.58228874206543, "vf_explained_var": 0.0, "kl": 3.5762786865234375e-07, "entropy": 1.4240961074829102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 364000, "episodes_total": 102, "training_iteration": 13, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-41-25", "timestamp": 1714830085, "time_this_iter_s": 17.701672554016113, "time_total_s": 243.2113161087036, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fad6170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 243.2113161087036, "timesteps_since_restore": 364000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.68076923076923, "ram_util_percent": 52.94230769230769}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -34.79919126758629, "episode_reward_mean": -11.342654319787847, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -34.79919126758629}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -7.5104272325352515}, "policy_reward_mean": {"cav": 7.882832371924056, "tl": -13.865160678803552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0880974576300675, "mean_processing_ms": 0.8423668896318461, "mean_inference_ms": 0.5797150006251379}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84093, "num_steps_sampled": 392000, "sample_time_ms": 15609.02, "load_time_ms": 11.582, "grad_time_ms": 2331.653, "update_time_ms": 3.884, "learner": {"tl": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01634983718395233, "policy_loss": -0.0009182736976072192, "vf_loss": 0.017268000170588493, "vf_explained_var": 0.024235647171735764, "kl": 0.001136904233135283, "entropy": 1.035396695137024, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 392000, "episodes_total": 110, "training_iteration": 14, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-41-43", "timestamp": 1714830103, "time_this_iter_s": 17.742594003677368, "time_total_s": 260.953910112381, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3faba440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 260.953910112381, "timesteps_since_restore": 392000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 46.148, "ram_util_percent": 53.007999999999996}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -30.760748218356476, "episode_reward_mean": -9.829302629948563, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -30.760748218356476}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -7.5104272325352515}, "policy_reward_mean": {"cav": 7.903107100352122, "tl": -12.358296902061252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0568855722288926, "mean_processing_ms": 0.8496679252179782, "mean_inference_ms": 0.5785793080460695}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84152, "num_steps_sampled": 420000, "sample_time_ms": 15596.615, "load_time_ms": 11.555, "grad_time_ms": 2351.424, "update_time_ms": 3.854, "learner": {"tl": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.013964722864329815, "policy_loss": -0.0009050869848579168, "vf_loss": 0.014869804494082928, "vf_explained_var": 0.042197335511446, "kl": 0.000249991484452039, "entropy": 1.0213558673858643, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 66.62792205810547, "policy_loss": 4.037962207803503e-05, "vf_loss": 66.62787628173828, "vf_explained_var": -1.1920928955078125e-07, "kl": 1.1920928955078125e-07, "entropy": 1.4244145154953003, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 420000, "episodes_total": 118, "training_iteration": 15, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-42-01", "timestamp": 1714830121, "time_this_iter_s": 18.081814527511597, "time_total_s": 279.0357246398926, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad41333e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 279.0357246398926, "timesteps_since_restore": 420000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.776923076923076, "ram_util_percent": 53.00384615384615}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -23.53319070563636, "episode_reward_mean": -8.867881341227172, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -23.53319070563636}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -7.423835623345647}, "policy_reward_mean": {"cav": 7.737912035513254, "tl": -11.344013192591422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0344562937848854, "mean_processing_ms": 0.8539904155912074, "mean_inference_ms": 0.5778572279073133}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84159, "num_steps_sampled": 448000, "sample_time_ms": 15583.847, "load_time_ms": 11.611, "grad_time_ms": 2354.015, "update_time_ms": 3.844, "learner": {"tl": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.018873626366257668, "policy_loss": -0.0001607970625627786, "vf_loss": 0.019034424796700478, "vf_explained_var": 0.03887191787362099, "kl": 0.0001645688316784799, "entropy": 1.0143367052078247, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 9.326443672180176, "policy_loss": -1.2474401046347339e-05, "vf_loss": 9.326456069946289, "vf_explained_var": 0.0, "kl": 5.960464477539063e-08, "entropy": 1.4244929552078247, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 448000, "episodes_total": 126, "training_iteration": 16, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-42-19", "timestamp": 1714830139, "time_this_iter_s": 18.047073364257812, "time_total_s": 297.0827980041504, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3faba3b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 297.0827980041504, "timesteps_since_restore": 448000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 45.03846153846154, "ram_util_percent": 52.99230769230768}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 24.170668216335716, "episode_reward_min": -16.528412895249822, "episode_reward_mean": -8.365975348686717, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -19.60949223978656}, "policy_reward_max": {"cav": 35.25490751552623, "tl": -7.423835623345647}, "policy_reward_mean": {"cav": 7.473206376759798, "tl": -10.832133453017466}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.017024249326566, "mean_processing_ms": 0.85688307549054, "mean_inference_ms": 0.5772527916446818}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84181, "num_steps_sampled": 476000, "sample_time_ms": 15576.498, "load_time_ms": 11.682, "grad_time_ms": 2336.77, "update_time_ms": 3.819, "learner": {"tl": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.016107097268104553, "policy_loss": -0.00020853723981417716, "vf_loss": 0.016315633431077003, "vf_explained_var": 0.08620250225067139, "kl": 0.0002533563820179552, "entropy": 1.001835584640503, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 19.764101028442383, "policy_loss": -0.00017453865439165384, "vf_loss": 19.7642765045166, "vf_explained_var": 5.960464477539063e-08, "kl": 1.1920928955078125e-07, "entropy": 1.4243340492248535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 476000, "episodes_total": 134, "training_iteration": 17, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-42-37", "timestamp": 1714830157, "time_this_iter_s": 17.927229642868042, "time_total_s": 315.01002764701843, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135fe60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 315.01002764701843, "timesteps_since_restore": 476000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 45.824000000000005, "ram_util_percent": 52.98799999999999}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.640103106578888, "episode_reward_mean": -8.25286740889073, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.640103106578888}, "policy_reward_max": {"cav": 24.289323347960142, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 6.420786643361312, "tl": -10.371727001199977}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.002668473583768, "mean_processing_ms": 0.8593037570656673, "mean_inference_ms": 0.5767562141717534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84196, "num_steps_sampled": 504000, "sample_time_ms": 15561.067, "load_time_ms": 11.832, "grad_time_ms": 2312.865, "update_time_ms": 3.803, "learner": {"tl": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.014994349330663681, "policy_loss": -0.0006090812967158854, "vf_loss": 0.015603430569171906, "vf_explained_var": 0.05739016830921173, "kl": 0.00028054782887920737, "entropy": 0.9860020875930786, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 13.779193878173828, "policy_loss": -0.000296560931019485, "vf_loss": 13.77949047088623, "vf_explained_var": 0.0, "kl": 1.0132789611816406e-06, "entropy": 1.4234980344772339, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 504000, "episodes_total": 142, "training_iteration": 18, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-42-55", "timestamp": 1714830175, "time_this_iter_s": 17.74219822883606, "time_total_s": 332.7522258758545, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3faba0e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 332.7522258758545, "timesteps_since_restore": 504000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.92692307692308, "ram_util_percent": 52.89999999999999}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -8.032545285899092, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 24.289323347960142, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 6.665766908762541, "tl": -10.232248365790745}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.990932131205882, "mean_processing_ms": 0.8611552197804235, "mean_inference_ms": 0.5763333546899394}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84228, "num_steps_sampled": 532000, "sample_time_ms": 15564.763, "load_time_ms": 11.832, "grad_time_ms": 2319.717, "update_time_ms": 3.808, "learner": {"tl": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.022940294817090034, "policy_loss": -5.541947029996663e-05, "vf_loss": 0.022995712235569954, "vf_explained_var": 0.0910150483250618, "kl": 0.000514279818162322, "entropy": 0.984328031539917, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 25.146644592285156, "policy_loss": -0.0007025822997093201, "vf_loss": 25.14734649658203, "vf_explained_var": 0.0, "kl": 2.1457672119140625e-06, "entropy": 1.4223904609680176, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 532000, "episodes_total": 150, "training_iteration": 19, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-43-13", "timestamp": 1714830193, "time_this_iter_s": 18.051636219024658, "time_total_s": 350.80386209487915, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fad6c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 350.80386209487915, "timesteps_since_restore": 532000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 45.76, "ram_util_percent": 52.964}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -7.964496573153082, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 24.289323347960142, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 7.001960172097771, "tl": -10.205123828224384}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9810465666626333, "mean_processing_ms": 0.8628618966800117, "mean_inference_ms": 0.5759196307432572}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84238, "num_steps_sampled": 560000, "sample_time_ms": 15603.763, "load_time_ms": 11.902, "grad_time_ms": 2308.192, "update_time_ms": 3.833, "learner": {"tl": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024485498666763306, "policy_loss": 0.00012019796122331172, "vf_loss": 0.024365300312638283, "vf_explained_var": 0.09483633190393448, "kl": 0.00024812258197925985, "entropy": 0.9835978746414185, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 21.54897689819336, "policy_loss": -0.0003241538943257183, "vf_loss": 21.549301147460938, "vf_explained_var": -1.1920928955078125e-07, "kl": 5.960464477539062e-07, "entropy": 1.4228802919387817, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 560000, "episodes_total": 158, "training_iteration": 20, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-43-31", "timestamp": 1714830211, "time_this_iter_s": 18.13515567779541, "time_total_s": 368.93901777267456, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3face0e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 368.93901777267456, "timesteps_since_restore": 560000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.03846153846153, "ram_util_percent": 53.02307692307693}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -8.142629928044128, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 6.332414607763281, "tl": -10.105678456450764}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.97309732488203, "mean_processing_ms": 0.8645287545932381, "mean_inference_ms": 0.5755752866860593}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84247, "num_steps_sampled": 588000, "sample_time_ms": 15674.786, "load_time_ms": 11.873, "grad_time_ms": 2248.43, "update_time_ms": 3.815, "learner": {"tl": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.014644072391092777, "policy_loss": -0.0012321858666837215, "vf_loss": 0.01587625965476036, "vf_explained_var": 0.1665772795677185, "kl": 0.0009242475498467684, "entropy": 0.9663858413696289, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 8.71086311340332, "policy_loss": -0.00032875273609533906, "vf_loss": 8.711191177368164, "vf_explained_var": 0.0, "kl": 1.7881393432617188e-06, "entropy": 1.4243468046188354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 588000, "episodes_total": 166, "training_iteration": 21, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-43-50", "timestamp": 1714830230, "time_this_iter_s": 18.3601713180542, "time_total_s": 387.29918909072876, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad41333c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 387.29918909072876, "timesteps_since_restore": 588000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 48.973076923076924, "ram_util_percent": 53.23846153846153}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -8.171765938419805, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 5.959328652202174, "tl": -9.959564534080476}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9663301241927518, "mean_processing_ms": 0.8661308339815459, "mean_inference_ms": 0.5753759805187486}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112151, "num_steps_sampled": 616000, "sample_time_ms": 15709.929, "load_time_ms": 11.758, "grad_time_ms": 2263.111, "update_time_ms": 3.863, "learner": {"tl": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024902021512389183, "policy_loss": 1.0702588042477146e-05, "vf_loss": 0.024891318753361702, "vf_explained_var": 0.10119733214378357, "kl": 0.0007276134565472603, "entropy": 0.9574263095855713, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 616000, "episodes_total": 174, "training_iteration": 22, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-44-08", "timestamp": 1714830248, "time_this_iter_s": 18.174959897994995, "time_total_s": 405.47414898872375, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135f320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 405.47414898872375, "timesteps_since_restore": 616000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 46.59615384615384, "ram_util_percent": 53.900000000000006}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -8.212068675726686, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 5.894837113876288, "tl": -9.98051980988959}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9605402942651025, "mean_processing_ms": 0.8676694731290582, "mean_inference_ms": 0.575291663299224}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112179, "num_steps_sampled": 644000, "sample_time_ms": 15726.319, "load_time_ms": 11.814, "grad_time_ms": 2303.775, "update_time_ms": 3.892, "learner": {"tl": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024837417528033257, "policy_loss": -0.00031196195050142705, "vf_loss": 0.025149378925561905, "vf_explained_var": 0.16314469277858734, "kl": 0.00010796829155879095, "entropy": 0.9555952548980713, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 16.392255783081055, "policy_loss": -7.260697020683438e-05, "vf_loss": 16.3923282623291, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.0, "entropy": 1.424500584602356, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 644000, "episodes_total": 182, "training_iteration": 23, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-44-26", "timestamp": 1714830266, "time_this_iter_s": 18.27383852005005, "time_total_s": 423.7479875087738, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3faceef0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 423.7479875087738, "timesteps_since_restore": 644000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 44.00370370370371, "ram_util_percent": 53.81481481481482}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -8.249323642737805, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 5.582173921840442, "tl": -9.97979755850836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.955373795654828, "mean_processing_ms": 0.8690693084757264, "mean_inference_ms": 0.5752258979763616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112197, "num_steps_sampled": 672000, "sample_time_ms": 15714.875, "load_time_ms": 11.962, "grad_time_ms": 2333.353, "update_time_ms": 3.911, "learner": {"tl": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.017506778240203857, "policy_loss": -0.001043332857079804, "vf_loss": 0.01855010725557804, "vf_explained_var": 0.1206662580370903, "kl": 0.002119753509759903, "entropy": 0.953593373298645, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 17.757909774780273, "policy_loss": -9.117854642681777e-05, "vf_loss": 17.757999420166016, "vf_explained_var": 0.0, "kl": 4.172325134277344e-07, "entropy": 1.4237257242202759, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 672000, "episodes_total": 190, "training_iteration": 24, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-44-44", "timestamp": 1714830284, "time_this_iter_s": 17.92249631881714, "time_total_s": 441.67048382759094, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3face4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 441.67048382759094, "timesteps_since_restore": 672000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 46.05200000000001, "ram_util_percent": 53.812000000000005}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -14.283937239040096, "episode_reward_mean": -8.283996531140403, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -14.283937239040096}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 5.44121803668295, "tl": -9.970774122512136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9508852810444512, "mean_processing_ms": 0.8703537024612761, "mean_inference_ms": 0.5752778509136506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112214, "num_steps_sampled": 700000, "sample_time_ms": 15716.426, "load_time_ms": 12.001, "grad_time_ms": 2310.909, "update_time_ms": 3.905, "learner": {"tl": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.019744999706745148, "policy_loss": -0.002535885665565729, "vf_loss": 0.02228088490664959, "vf_explained_var": 0.15677723288536072, "kl": 0.004494657274335623, "entropy": 0.9425145387649536, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 26.19284439086914, "policy_loss": -5.275887451716699e-05, "vf_loss": 26.192893981933594, "vf_explained_var": -1.1920928955078125e-07, "kl": 3.5762786865234375e-07, "entropy": 1.423130989074707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 700000, "episodes_total": 198, "training_iteration": 25, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-45-02", "timestamp": 1714830302, "time_this_iter_s": 17.87344455718994, "time_total_s": 459.5439283847809, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad4135f710>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 459.5439283847809, "timesteps_since_restore": 700000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.76923076923077, "ram_util_percent": 53.84615384615385}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -15.241482399227236, "episode_reward_mean": -8.383074538640264, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.241482399227236}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.366978736014008}, "policy_reward_mean": {"cav": 5.644369840304025, "tl": -10.132829189134528}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9469432721770144, "mean_processing_ms": 0.8714726472965539, "mean_inference_ms": 0.5753843286857758}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112220, "num_steps_sampled": 728000, "sample_time_ms": 15717.312, "load_time_ms": 11.993, "grad_time_ms": 2278.583, "update_time_ms": 3.947, "learner": {"tl": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02585342898964882, "policy_loss": 0.0001016145761241205, "vf_loss": 0.025751814246177673, "vf_explained_var": 0.15090641379356384, "kl": 7.826452201697975e-05, "entropy": 0.942818820476532, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 7.4033894538879395, "policy_loss": -0.0015250444412231445, "vf_loss": 7.404914379119873, "vf_explained_var": 0.0, "kl": 2.7418136596679688e-06, "entropy": 1.4216731786727905, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 728000, "episodes_total": 206, "training_iteration": 26, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-45-20", "timestamp": 1714830320, "time_this_iter_s": 17.735032558441162, "time_total_s": 477.27896094322205, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac450aa9e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 477.27896094322205, "timesteps_since_restore": 728000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 46.128, "ram_util_percent": 53.908}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 10.720465743115557, "episode_reward_min": -15.241482399227236, "episode_reward_mean": -8.462262927098429, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.241482399227236}, "policy_reward_max": {"cav": 21.19556592252921, "tl": -6.2116966620890075}, "policy_reward_mean": {"cav": 5.749790435107771, "tl": -10.187200057630776}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9434211929672505, "mean_processing_ms": 0.8725827943644151, "mean_inference_ms": 0.575517362746198}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112274, "num_steps_sampled": 756000, "sample_time_ms": 15724.852, "load_time_ms": 11.963, "grad_time_ms": 2283.363, "update_time_ms": 3.932, "learner": {"tl": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0245338324457407, "policy_loss": -0.00030534283723682165, "vf_loss": 0.02483917400240898, "vf_explained_var": 0.16755157709121704, "kl": 0.0003455977130215615, "entropy": 0.9458807706832886, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 64.19146728515625, "policy_loss": 5.033281195210293e-05, "vf_loss": 64.19142150878906, "vf_explained_var": 0.0, "kl": 1.9669532775878906e-06, "entropy": 1.420120358467102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 756000, "episodes_total": 214, "training_iteration": 27, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-45-38", "timestamp": 1714830338, "time_this_iter_s": 18.050142526626587, "time_total_s": 495.32910346984863, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3face4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 495.32910346984863, "timesteps_since_restore": 756000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 44.78076923076923, "ram_util_percent": 53.93076923076922}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.479776701244837, "episode_reward_min": -15.241482399227236, "episode_reward_mean": -8.463147224987448, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.241482399227236}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -6.2116966620890075}, "policy_reward_mean": {"cav": 5.762556832560547, "tl": -10.19191427475562}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.940259921845863, "mean_processing_ms": 0.8735591348368453, "mean_inference_ms": 0.5756924375897527}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112297, "num_steps_sampled": 784000, "sample_time_ms": 15725.4, "load_time_ms": 11.945, "grad_time_ms": 2285.016, "update_time_ms": 4.027, "learner": {"tl": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.020643269643187523, "policy_loss": -0.00018698755593504757, "vf_loss": 0.02083025500178337, "vf_explained_var": 0.13344520330429077, "kl": 6.201730138855055e-05, "entropy": 0.9433543086051941, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 64.26802825927734, "policy_loss": -3.613596345530823e-05, "vf_loss": 64.26806640625, "vf_explained_var": 5.960464477539063e-08, "kl": 2.980232238769531e-07, "entropy": 1.4195231199264526, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 784000, "episodes_total": 222, "training_iteration": 28, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-45-55", "timestamp": 1714830355, "time_this_iter_s": 17.763757944107056, "time_total_s": 513.0928614139557, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad41333710>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 513.0928614139557, "timesteps_since_restore": 784000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 46.43200000000001, "ram_util_percent": 53.952}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -15.241482399227236, "episode_reward_mean": -8.088186716207131, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.241482399227236}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -6.011615483282286}, "policy_reward_mean": {"cav": 6.18769141502973, "tl": -10.00637105486636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.937633857138329, "mean_processing_ms": 0.8744816085680007, "mean_inference_ms": 0.5759931835881457}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112333, "num_steps_sampled": 812000, "sample_time_ms": 15757.987, "load_time_ms": 11.884, "grad_time_ms": 2266.059, "update_time_ms": 4.032, "learner": {"tl": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0188126303255558, "policy_loss": 0.00011288777750451118, "vf_loss": 0.01869974471628666, "vf_explained_var": 0.23374514281749725, "kl": 6.862340524094179e-05, "entropy": 0.9426076412200928, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 29.57931137084961, "policy_loss": -0.000664360006339848, "vf_loss": 29.57997703552246, "vf_explained_var": 0.0, "kl": 1.3113021850585938e-06, "entropy": 1.4184273481369019, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 812000, "episodes_total": 230, "training_iteration": 29, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-46-14", "timestamp": 1714830374, "time_this_iter_s": 18.189338445663452, "time_total_s": 531.2821998596191, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad41333c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 531.2821998596191, "timesteps_since_restore": 812000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 46.95, "ram_util_percent": 53.85000000000001}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -15.241482399227236, "episode_reward_mean": -8.006010601161671, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.241482399227236}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.591437536584076, "tl": -9.983441862136903}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.935344331282098, "mean_processing_ms": 0.875314957097495, "mean_inference_ms": 0.5763171165544171}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112336, "num_steps_sampled": 840000, "sample_time_ms": 15727.311, "load_time_ms": 11.83, "grad_time_ms": 2261.114, "update_time_ms": 4.09, "learner": {"tl": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.027758771553635597, "policy_loss": -2.3734404749120586e-05, "vf_loss": 0.027782505378127098, "vf_explained_var": 0.1789407581090927, "kl": 0.00032593432115390897, "entropy": 0.932073175907135, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4056099653244019, "policy_loss": -0.00025931993150152266, "vf_loss": 1.4058693647384644, "vf_explained_var": -1.1920928955078125e-07, "kl": 1.2516975402832031e-06, "entropy": 1.4175390005111694, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 840000, "episodes_total": 238, "training_iteration": 30, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-46-31", "timestamp": 1714830391, "time_this_iter_s": 17.77849507331848, "time_total_s": 549.0606949329376, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad413339e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 549.0606949329376, "timesteps_since_restore": 840000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 46.64800000000001, "ram_util_percent": 53.272}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -15.241482399227236, "episode_reward_mean": -8.073153320105327, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.241482399227236}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.354901960952607, "tl": -9.979623908391112}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9334136971095344, "mean_processing_ms": 0.8761257225327438, "mean_inference_ms": 0.5767117230099547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112376, "num_steps_sampled": 868000, "sample_time_ms": 15696.71, "load_time_ms": 11.983, "grad_time_ms": 2297.274, "update_time_ms": 4.102, "learner": {"tl": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025128452107310295, "policy_loss": -0.0004666745662689209, "vf_loss": 0.025595126673579216, "vf_explained_var": 0.2185012400150299, "kl": 0.000130668340716511, "entropy": 0.934799075126648, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 24.15846061706543, "policy_loss": -0.0005595028633251786, "vf_loss": 24.159019470214844, "vf_explained_var": -2.384185791015625e-07, "kl": 1.6689300537109375e-06, "entropy": 1.4173370599746704, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 868000, "episodes_total": 246, "training_iteration": 31, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-46-50", "timestamp": 1714830410, "time_this_iter_s": 18.419411420822144, "time_total_s": 567.4801063537598, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad41333320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 567.4801063537598, "timesteps_since_restore": 868000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 45.96296296296297, "ram_util_percent": 53.325925925925915}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -8.143668080894653, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.431371376022276, "tl": -10.07307949370133}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.931727285243291, "mean_processing_ms": 0.8769060206129461, "mean_inference_ms": 0.5770943280712436}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112391, "num_steps_sampled": 896000, "sample_time_ms": 15702.063, "load_time_ms": 12.229, "grad_time_ms": 2286.097, "update_time_ms": 4.146, "learner": {"tl": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028685972094535828, "policy_loss": -0.0029554569628089666, "vf_loss": 0.03164143115282059, "vf_explained_var": 0.18724629282951355, "kl": 0.005125537980347872, "entropy": 0.931693971157074, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 11.400861740112305, "policy_loss": -0.0008428573491983116, "vf_loss": 11.401703834533691, "vf_explained_var": 0.0, "kl": 1.2516975402832031e-06, "entropy": 1.4184021949768066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 896000, "episodes_total": 254, "training_iteration": 32, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-47-08", "timestamp": 1714830428, "time_this_iter_s": 18.118788719177246, "time_total_s": 585.598895072937, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac4518c440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 585.598895072937, "timesteps_since_restore": 896000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 46.37692307692308, "ram_util_percent": 53.26923076923077}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -8.07771339753933, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.458262605301647, "tl": -10.079774805182838}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9298746916302467, "mean_processing_ms": 0.877475639538407, "mean_inference_ms": 0.5772662440707641}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112404, "num_steps_sampled": 924000, "sample_time_ms": 15680.42, "load_time_ms": 12.144, "grad_time_ms": 2252.138, "update_time_ms": 4.053, "learner": {"tl": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025953318923711777, "policy_loss": -0.0005634487024508417, "vf_loss": 0.026516765356063843, "vf_explained_var": 0.25558045506477356, "kl": 0.0003848995838779956, "entropy": 0.9306177496910095, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 7.88578462600708, "policy_loss": -0.00033577129943296313, "vf_loss": 7.886120319366455, "vf_explained_var": -1.1920928955078125e-07, "kl": 2.3245811462402344e-06, "entropy": 1.4198740720748901, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 924000, "episodes_total": 262, "training_iteration": 33, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-47-26", "timestamp": 1714830446, "time_this_iter_s": 17.715640544891357, "time_total_s": 603.3145356178284, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad413334d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 603.3145356178284, "timesteps_since_restore": 924000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 45.724, "ram_util_percent": 53.208}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -8.17551501502484, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.458071916754564, "tl": -10.17751730921875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9279806354530784, "mean_processing_ms": 0.8779670340128166, "mean_inference_ms": 0.5773559343192428}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140308, "num_steps_sampled": 952000, "sample_time_ms": 15705.088, "load_time_ms": 11.933, "grad_time_ms": 2223.217, "update_time_ms": 4.012, "learner": {"tl": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.030230257660150528, "policy_loss": 0.0006457272102124989, "vf_loss": 0.029584530740976334, "vf_explained_var": 0.20110419392585754, "kl": 0.00012002960284007713, "entropy": 0.9349725842475891, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 952000, "episodes_total": 270, "training_iteration": 34, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-47-44", "timestamp": 1714830464, "time_this_iter_s": 17.87761688232422, "time_total_s": 621.1921525001526, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac450aa950>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 621.1921525001526, "timesteps_since_restore": 952000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 47.263999999999996, "ram_util_percent": 53.24}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -8.195233161711965, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.776345255539515, "tl": -10.295900190929201}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.926173299950333, "mean_processing_ms": 0.8784269813994504, "mean_inference_ms": 0.5774188136940736}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140341, "num_steps_sampled": 980000, "sample_time_ms": 15712.881, "load_time_ms": 11.891, "grad_time_ms": 2231.55, "update_time_ms": 4.041, "learner": {"tl": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026631075888872147, "policy_loss": -0.00017085899889934808, "vf_loss": 0.026801936328411102, "vf_explained_var": 0.3458351492881775, "kl": 0.0005215135170146823, "entropy": 0.93974769115448, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 16.55561637878418, "policy_loss": -0.0001327810896327719, "vf_loss": 16.555749893188477, "vf_explained_var": 1.1920928955078125e-07, "kl": 8.940696716308594e-07, "entropy": 1.4207185506820679, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 980000, "episodes_total": 278, "training_iteration": 35, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-48-02", "timestamp": 1714830482, "time_this_iter_s": 18.036062955856323, "time_total_s": 639.2282154560089, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac4518c200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 639.2282154560089, "timesteps_since_restore": 980000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 44.74230769230769, "ram_util_percent": 53.23461538461539}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 7.852539655072354, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -8.050664460300661, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 21.00690356131275, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 6.958489461111222, "tl": -10.20779619324513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.924426350286599, "mean_processing_ms": 0.8788454509468488, "mean_inference_ms": 0.5775040986174953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140373, "num_steps_sampled": 1008000, "sample_time_ms": 15708.298, "load_time_ms": 11.99, "grad_time_ms": 2251.3, "update_time_ms": 3.982, "learner": {"tl": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02085527777671814, "policy_loss": 0.00012610566045623273, "vf_loss": 0.020729169249534607, "vf_explained_var": 0.25316157937049866, "kl": 7.376966095762327e-05, "entropy": 0.9329420924186707, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 83.94781494140625, "policy_loss": -0.0006972718983888626, "vf_loss": 83.94851684570312, "vf_explained_var": 0.0, "kl": 1.6689300537109375e-06, "entropy": 1.4218864440917969, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1008000, "episodes_total": 286, "training_iteration": 36, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-48-20", "timestamp": 1714830500, "time_this_iter_s": 17.88674020767212, "time_total_s": 657.114955663681, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac4518c290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 657.114955663681, "timesteps_since_restore": 1008000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.02692307692309, "ram_util_percent": 53.23076923076925}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -7.712172203143816, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 7.767008688128116, "tl": -10.119944896463522}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9228811482288166, "mean_processing_ms": 0.8792555114584637, "mean_inference_ms": 0.5776253870005907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140411, "num_steps_sampled": 1036000, "sample_time_ms": 15702.85, "load_time_ms": 11.927, "grad_time_ms": 2259.284, "update_time_ms": 4.026, "learner": {"tl": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.023538751527667046, "policy_loss": -0.000477073946967721, "vf_loss": 0.02401582896709442, "vf_explained_var": 0.3669328987598419, "kl": 0.00046308821765705943, "entropy": 0.924039363861084, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 30.378032684326172, "policy_loss": 0.00010731973452493548, "vf_loss": 30.3779239654541, "vf_explained_var": -2.384185791015625e-07, "kl": 7.152557373046875e-07, "entropy": 1.4227181673049927, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1036000, "episodes_total": 294, "training_iteration": 37, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-48-38", "timestamp": 1714830518, "time_this_iter_s": 18.074840307235718, "time_total_s": 675.1897959709167, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac450aa9e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 675.1897959709167, "timesteps_since_restore": 1036000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 45.843999999999994, "ram_util_percent": 53.256}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -7.912906533420845, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 7.796448935045896, "tl": -10.251841213934606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9214310432050765, "mean_processing_ms": 0.8796531222230639, "mean_inference_ms": 0.5777363246034085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140418, "num_steps_sampled": 1064000, "sample_time_ms": 15692.259, "load_time_ms": 11.858, "grad_time_ms": 2300.775, "update_time_ms": 3.917, "learner": {"tl": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02473728358745575, "policy_loss": 0.0001041249415720813, "vf_loss": 0.02463315986096859, "vf_explained_var": 0.316816508769989, "kl": 0.00035149959148839116, "entropy": 0.9172492623329163, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 11.142202377319336, "policy_loss": -0.00029885023832321167, "vf_loss": 11.142500877380371, "vf_explained_var": -1.1920928955078125e-07, "kl": 4.76837158203125e-07, "entropy": 1.4227522611618042, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1064000, "episodes_total": 302, "training_iteration": 38, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-48-56", "timestamp": 1714830536, "time_this_iter_s": 18.071327686309814, "time_total_s": 693.2611236572266, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad41333440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 693.2611236572266, "timesteps_since_restore": 1064000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 44.87307692307692, "ram_util_percent": 53.29230769230771}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -7.925844560798825, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 7.349502391498283, "tl": -10.057200254333312}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9200902196974186, "mean_processing_ms": 0.8799917535774808, "mean_inference_ms": 0.5778381369516085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140451, "num_steps_sampled": 1092000, "sample_time_ms": 15657.277, "load_time_ms": 11.956, "grad_time_ms": 2326.467, "update_time_ms": 3.901, "learner": {"tl": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02573363296687603, "policy_loss": -0.0007681953138671815, "vf_loss": 0.026501823216676712, "vf_explained_var": 0.37942612171173096, "kl": 0.0011139000998809934, "entropy": 0.909217894077301, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 43.40885925292969, "policy_loss": -0.00016296631656587124, "vf_loss": 43.40902328491211, "vf_explained_var": 5.960464477539063e-08, "kl": 6.556510925292969e-07, "entropy": 1.423052191734314, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1092000, "episodes_total": 310, "training_iteration": 39, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-49-14", "timestamp": 1714830554, "time_this_iter_s": 18.095194816589355, "time_total_s": 711.3563184738159, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac4518c7a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 711.3563184738159, "timesteps_since_restore": 1092000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 44.96153846153846, "ram_util_percent": 53.35384615384615}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -7.916113697936114, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 7.450597680108911, "tl": -10.076787025167683}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.918806127048308, "mean_processing_ms": 0.8803199228372077, "mean_inference_ms": 0.5779212329606778}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168355, "num_steps_sampled": 1120000, "sample_time_ms": 15645.93, "load_time_ms": 11.934, "grad_time_ms": 2351.684, "update_time_ms": 3.8, "learner": {"tl": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026275308802723885, "policy_loss": -0.0003143741632811725, "vf_loss": 0.026589682325720787, "vf_explained_var": 0.41013428568840027, "kl": 0.00038638649857603014, "entropy": 0.9069420099258423, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1120000, "episodes_total": 318, "training_iteration": 40, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-49-32", "timestamp": 1714830572, "time_this_iter_s": 17.918028116226196, "time_total_s": 729.2743465900421, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fac4518c320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 729.2743465900421, "timesteps_since_restore": 1120000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 45.01923076923077, "ram_util_percent": 53.39230769230768}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.047741000829063, "episode_reward_mean": -7.970000958792569, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.047741000829063}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 7.765936168853996, "tl": -10.222122447760214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9175510227163874, "mean_processing_ms": 0.8805805808928154, "mean_inference_ms": 0.5779543871576307}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168409, "num_steps_sampled": 1148000, "sample_time_ms": 15596.564, "load_time_ms": 11.647, "grad_time_ms": 2351.094, "update_time_ms": 3.8, "learner": {"tl": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03214045986533165, "policy_loss": -0.0005616107955574989, "vf_loss": 0.032702069729566574, "vf_explained_var": 0.45807042717933655, "kl": 0.0011782404035329819, "entropy": 0.9127089381217957, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 40.954219818115234, "policy_loss": -1.686590735516802e-06, "vf_loss": 40.9542236328125, "vf_explained_var": 1.1920928955078125e-07, "kl": 1.1920928955078125e-07, "entropy": 1.423043966293335, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1148000, "episodes_total": 326, "training_iteration": 41, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-49-50", "timestamp": 1714830590, "time_this_iter_s": 17.914384603500366, "time_total_s": 747.1887311935425, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3facec20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 747.1887311935425, "timesteps_since_restore": 1148000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 45.872, "ram_util_percent": 53.316}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.95917495902779, "episode_reward_mean": -8.253387135194608, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.95917495902779}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.781145704141178}, "policy_reward_mean": {"cav": 7.354905298867028, "tl": -10.386309671866028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.916371465489996, "mean_processing_ms": 0.8807959633332207, "mean_inference_ms": 0.5779757429543163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168434, "num_steps_sampled": 1176000, "sample_time_ms": 15576.33, "load_time_ms": 11.407, "grad_time_ms": 2369.565, "update_time_ms": 3.741, "learner": {"tl": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.031218253076076508, "policy_loss": 0.000428353960160166, "vf_loss": 0.030789900571107864, "vf_explained_var": 0.41555002331733704, "kl": 0.0004061001818627119, "entropy": 0.910966694355011, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 35.72394561767578, "policy_loss": -0.0013021135237067938, "vf_loss": 35.72524642944336, "vf_explained_var": 0.0, "kl": 2.1457672119140625e-06, "entropy": 1.4218015670776367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1176000, "episodes_total": 334, "training_iteration": 42, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-50-08", "timestamp": 1714830608, "time_this_iter_s": 18.09843134880066, "time_total_s": 765.2871625423431, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa83050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 765.2871625423431, "timesteps_since_restore": 1176000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 45.33846153846154, "ram_util_percent": 53.334615384615375}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.95917495902779, "episode_reward_mean": -8.278741140564597, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.95917495902779}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -6.16392186426516}, "policy_reward_mean": {"cav": 7.5455423958979155, "tl": -10.542403859333946}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.915193145629358, "mean_processing_ms": 0.8809520284153026, "mean_inference_ms": 0.5779783886288292}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168451, "num_steps_sampled": 1204000, "sample_time_ms": 15579.664, "load_time_ms": 11.396, "grad_time_ms": 2370.156, "update_time_ms": 3.768, "learner": {"tl": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.030104076489806175, "policy_loss": 0.000451429164968431, "vf_loss": 0.02965264767408371, "vf_explained_var": 0.47744548320770264, "kl": 5.3171661420492455e-06, "entropy": 0.9093183875083923, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 11.867057800292969, "policy_loss": -0.00013996573397889733, "vf_loss": 11.867196083068848, "vf_explained_var": 0.0, "kl": 2.205371856689453e-06, "entropy": 1.420604944229126, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1204000, "episodes_total": 342, "training_iteration": 43, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-50-26", "timestamp": 1714830626, "time_this_iter_s": 17.75461196899414, "time_total_s": 783.0417745113373, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa69560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 783.0417745113373, "timesteps_since_restore": 1204000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 46.036, "ram_util_percent": 53.407999999999994}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.95917495902779, "episode_reward_mean": -8.357696107590533, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.95917495902779}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -5.693367763318978}, "policy_reward_mean": {"cav": 7.240968483894431, "tl": -10.52998665275884}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9140381334710654, "mean_processing_ms": 0.8810717225861243, "mean_inference_ms": 0.5779774517032077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168469, "num_steps_sampled": 1232000, "sample_time_ms": 15586.716, "load_time_ms": 11.449, "grad_time_ms": 2356.78, "update_time_ms": 3.785, "learner": {"tl": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033469315618276596, "policy_loss": -0.00023642154701519758, "vf_loss": 0.033705733716487885, "vf_explained_var": 0.5259107947349548, "kl": 0.0005957921966910362, "entropy": 0.9080395698547363, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 17.508893966674805, "policy_loss": -0.0008463065023534, "vf_loss": 17.509742736816406, "vf_explained_var": -1.1920928955078125e-07, "kl": 1.4901161193847656e-06, "entropy": 1.4204744100570679, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1232000, "episodes_total": 350, "training_iteration": 44, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-50-43", "timestamp": 1714830643, "time_this_iter_s": 17.81523871421814, "time_total_s": 800.8570132255554, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa83830>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 800.8570132255554, "timesteps_since_restore": 1232000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 45.37307692307692, "ram_util_percent": 53.411538461538456}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -16.95917495902779, "episode_reward_mean": -8.491078432595877, "episode_len_mean": 3500.0, "episodes_this_iter": 9, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 7.258142657115853, "tl": -10.66852122973062}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9117306654911146, "mean_processing_ms": 0.8813828185142661, "mean_inference_ms": 0.5777325196056897}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168481, "num_steps_sampled": 1260000, "sample_time_ms": 15775.504, "load_time_ms": 11.469, "grad_time_ms": 2347.907, "update_time_ms": 3.749, "learner": {"tl": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03366200998425484, "policy_loss": -0.00032330091926269233, "vf_loss": 0.03398531302809715, "vf_explained_var": 0.5246425867080688, "kl": 0.0005311760469339788, "entropy": 0.9047505855560303, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 18.175640106201172, "policy_loss": -0.0005525152082554996, "vf_loss": 18.176193237304688, "vf_explained_var": 0.0, "kl": 1.9669532775878906e-06, "entropy": 1.4205862283706665, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1260000, "episodes_total": 359, "training_iteration": 45, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-51-03", "timestamp": 1714830663, "time_this_iter_s": 19.83350944519043, "time_total_s": 820.6905226707458, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa69c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 820.6905226707458, "timesteps_since_restore": 1260000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 42.074999999999996, "ram_util_percent": 53.44285714285713}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -18.536454715448738, "episode_reward_mean": -8.514959791431515, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 7.388205253952087, "tl": -10.65753931507761}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9107502491490735, "mean_processing_ms": 0.8815788716888009, "mean_inference_ms": 0.5777297530493486}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168488, "num_steps_sampled": 1288000, "sample_time_ms": 15822.565, "load_time_ms": 11.501, "grad_time_ms": 2330.518, "update_time_ms": 3.742, "learner": {"tl": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028176378458738327, "policy_loss": -0.0008603503811173141, "vf_loss": 0.02903672680258751, "vf_explained_var": 0.5210562944412231, "kl": 0.0018580456962808967, "entropy": 0.90493243932724, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 11.310437202453613, "policy_loss": -0.0006847977638244629, "vf_loss": 11.311121940612793, "vf_explained_var": -2.384185791015625e-07, "kl": 1.7881393432617188e-06, "entropy": 1.4207144975662231, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1288000, "episodes_total": 367, "training_iteration": 46, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-51-21", "timestamp": 1714830681, "time_this_iter_s": 18.183716773986816, "time_total_s": 838.8742394447327, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa83c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 838.8742394447327, "timesteps_since_restore": 1288000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 44.96153846153846, "ram_util_percent": 53.5}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -18.536454715448738, "episode_reward_mean": -8.48628552073962, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 7.0481665634759745, "tl": -10.530253824147652}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.909946863921411, "mean_processing_ms": 0.8817148833343095, "mean_inference_ms": 0.5777788366354021}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168509, "num_steps_sampled": 1316000, "sample_time_ms": 15859.407, "load_time_ms": 11.63, "grad_time_ms": 2312.102, "update_time_ms": 3.731, "learner": {"tl": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025285009294748306, "policy_loss": -2.0221012164256535e-05, "vf_loss": 0.025305232033133507, "vf_explained_var": 0.5519400238990784, "kl": 0.00162424985319376, "entropy": 0.8996355533599854, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 30.257062911987305, "policy_loss": -0.0003075486165471375, "vf_loss": 30.25736427307129, "vf_explained_var": 0.0, "kl": 1.2516975402832031e-06, "entropy": 1.4216972589492798, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1316000, "episodes_total": 375, "training_iteration": 47, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-51-40", "timestamp": 1714830700, "time_this_iter_s": 18.261297464370728, "time_total_s": 857.1355369091034, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa219e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 857.1355369091034, "timesteps_since_restore": 1316000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 47.51923076923077, "ram_util_percent": 53.99230769230769}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -18.536454715448738, "episode_reward_mean": -8.53866791515185, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 6.948735329328701, "tl": -10.623288513950454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9092675918899977, "mean_processing_ms": 0.8817774534168638, "mean_inference_ms": 0.5778490097690044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 196413, "num_steps_sampled": 1344000, "sample_time_ms": 15892.31, "load_time_ms": 11.55, "grad_time_ms": 2264.422, "update_time_ms": 3.742, "learner": {"tl": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.030963482335209846, "policy_loss": -0.00010477211617399007, "vf_loss": 0.03106825426220894, "vf_explained_var": 0.49164316058158875, "kl": 0.00017697029397822917, "entropy": 0.8877002000808716, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1344000, "episodes_total": 383, "training_iteration": 48, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-51-58", "timestamp": 1714830718, "time_this_iter_s": 17.92329502105713, "time_total_s": 875.0588319301605, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa40a70>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 875.0588319301605, "timesteps_since_restore": 1344000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 45.15000000000001, "ram_util_percent": 54.37307692307694}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 14.72451199976742, "episode_reward_min": -18.536454715448738, "episode_reward_mean": -8.644265904027897, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 22.00901895613749, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 6.7735353739537665, "tl": -10.676326516214024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9088678646106403, "mean_processing_ms": 0.8818446887441855, "mean_inference_ms": 0.577989652619222}, "off_policy_estimator": {}, "info": {"num_steps_trained": 196460, "num_steps_sampled": 1372000, "sample_time_ms": 15950.41, "load_time_ms": 11.484, "grad_time_ms": 2246.995, "update_time_ms": 3.802, "learner": {"tl": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03211754932999611, "policy_loss": 0.00023051399330142885, "vf_loss": 0.031887032091617584, "vf_explained_var": 0.6415117383003235, "kl": 0.0006391823990270495, "entropy": 0.8825017213821411, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 70.87406158447266, "policy_loss": -1.6613209936622297e-06, "vf_loss": 70.87406158447266, "vf_explained_var": 0.0, "kl": 5.364418029785156e-07, "entropy": 1.4224871397018433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1372000, "episodes_total": 391, "training_iteration": 49, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-52-16", "timestamp": 1714830736, "time_this_iter_s": 18.50171709060669, "time_total_s": 893.5605490207672, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa21f80>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 893.5605490207672, "timesteps_since_restore": 1372000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 46.603846153846156, "ram_util_percent": 54.33461538461539}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 11.403722937453825, "episode_reward_min": -18.536454715448738, "episode_reward_mean": -9.048769145735434, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 23.775671297162624, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 6.612649285806088, "tl": -10.966437438619193}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9087363656476373, "mean_processing_ms": 0.881915164975204, "mean_inference_ms": 0.5782255346381866}, "off_policy_estimator": {}, "info": {"num_steps_trained": 224364, "num_steps_sampled": 1400000, "sample_time_ms": 16068.931, "load_time_ms": 11.494, "grad_time_ms": 2220.411, "update_time_ms": 3.821, "learner": {"tl": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.035095714032649994, "policy_loss": -0.00062183802947402, "vf_loss": 0.03571755439043045, "vf_explained_var": 0.6147060394287109, "kl": 0.0016352758975699544, "entropy": 0.8807446956634521, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1400000, "episodes_total": 399, "training_iteration": 50, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-52-35", "timestamp": 1714830755, "time_this_iter_s": 18.83748197555542, "time_total_s": 912.3980309963226, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa40e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 912.3980309963226, "timesteps_since_restore": 1400000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 48.0962962962963, "ram_util_percent": 54.35555555555553}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -18.536454715448738, "episode_reward_mean": -8.450456969554006, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 8.601278720270145, "tl": -10.944827798432334}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9087145433461603, "mean_processing_ms": 0.8819682679372117, "mean_inference_ms": 0.5785031092467517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 224492, "num_steps_sampled": 1428000, "sample_time_ms": 16099.972, "load_time_ms": 11.548, "grad_time_ms": 2203.12, "update_time_ms": 3.819, "learner": {"tl": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03404655680060387, "policy_loss": 6.0279980971245095e-06, "vf_loss": 0.034040529280900955, "vf_explained_var": 0.6417070031166077, "kl": 0.00026921569951809943, "entropy": 0.883550226688385, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 112.9827880859375, "policy_loss": -0.00845714658498764, "vf_loss": 112.99124145507812, "vf_explained_var": 0.0, "kl": 2.384185791015625e-07, "entropy": 1.4225977659225464, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1428000, "episodes_total": 407, "training_iteration": 51, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-52-53", "timestamp": 1714830773, "time_this_iter_s": 18.05264973640442, "time_total_s": 930.450680732727, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa83c20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 930.450680732727, "timesteps_since_restore": 1428000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 45.21153846153846, "ram_util_percent": 54.4076923076923}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -22.10383052085396, "episode_reward_mean": -8.519981569627538, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 8.572197082772313, "tl": -11.091640694459231}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9089118798495037, "mean_processing_ms": 0.8819963643630886, "mean_inference_ms": 0.5788408594229572}, "off_policy_estimator": {}, "info": {"num_steps_trained": 224499, "num_steps_sampled": 1456000, "sample_time_ms": 16165.036, "load_time_ms": 11.613, "grad_time_ms": 2170.49, "update_time_ms": 3.806, "learner": {"tl": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03903926908969879, "policy_loss": 0.0001271654909942299, "vf_loss": 0.0389120988547802, "vf_explained_var": 0.6356759667396545, "kl": 2.6578400138532743e-05, "entropy": 0.8879672884941101, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 9.424416542053223, "policy_loss": 1.7506736185168847e-05, "vf_loss": 9.424399375915527, "vf_explained_var": 0.0, "kl": 5.960464477539063e-08, "entropy": 1.4226531982421875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1456000, "episodes_total": 415, "training_iteration": 52, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-53-12", "timestamp": 1714830792, "time_this_iter_s": 18.428144216537476, "time_total_s": 948.8788249492645, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa21dd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 948.8788249492645, "timesteps_since_restore": 1456000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 48.48076923076923, "ram_util_percent": 54.3423076923077}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -22.10383052085396, "episode_reward_mean": -8.73532676271322, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 8.13843108419622, "tl": -11.258240398814031}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9092308884595086, "mean_processing_ms": 0.8820507614975509, "mean_inference_ms": 0.5792007758353515}, "off_policy_estimator": {}, "info": {"num_steps_trained": 224522, "num_steps_sampled": 1484000, "sample_time_ms": 16192.492, "load_time_ms": 11.619, "grad_time_ms": 2171.686, "update_time_ms": 3.841, "learner": {"tl": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.035629257559776306, "policy_loss": 0.0005535013042390347, "vf_loss": 0.03507575765252113, "vf_explained_var": 0.6946197152137756, "kl": 0.00016087085532490164, "entropy": 0.8864621520042419, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 8.81283187866211, "policy_loss": -3.633291998994537e-05, "vf_loss": 8.812867164611816, "vf_explained_var": 1.7881393432617188e-07, "kl": 0.0, "entropy": 1.4227490425109863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1484000, "episodes_total": 423, "training_iteration": 53, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-53-30", "timestamp": 1714830810, "time_this_iter_s": 18.04361605644226, "time_total_s": 966.9224410057068, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa21cb0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 966.9224410057068, "timesteps_since_restore": 1484000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.223076923076924, "ram_util_percent": 54.30384615384616}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -22.10383052085396, "episode_reward_mean": -8.83348796006158, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 7.832326643899458, "tl": -11.261509219670392}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9095822185525897, "mean_processing_ms": 0.882090517733943, "mean_inference_ms": 0.5795731468180614}, "off_policy_estimator": {}, "info": {"num_steps_trained": 252426, "num_steps_sampled": 1512000, "sample_time_ms": 16213.942, "load_time_ms": 11.557, "grad_time_ms": 2188.077, "update_time_ms": 3.871, "learner": {"tl": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028230631723999977, "policy_loss": -0.0006297767977230251, "vf_loss": 0.028860408812761307, "vf_explained_var": 0.702768862247467, "kl": 0.0004288909549359232, "entropy": 0.879694402217865, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1512000, "episodes_total": 431, "training_iteration": 54, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-53-48", "timestamp": 1714830828, "time_this_iter_s": 18.194164276123047, "time_total_s": 985.1166052818298, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa408c0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 985.1166052818298, "timesteps_since_restore": 1512000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 45.28846153846153, "ram_util_percent": 54.29615384615385}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -22.10383052085396, "episode_reward_mean": -8.949272560825214, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 7.769983629055162, "tl": -11.280267649541754}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.909969524726324, "mean_processing_ms": 0.8821160730805873, "mean_inference_ms": 0.5799343451915285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 252457, "num_steps_sampled": 1540000, "sample_time_ms": 16022.328, "load_time_ms": 11.57, "grad_time_ms": 2181.438, "update_time_ms": 3.876, "learner": {"tl": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.037084974348545074, "policy_loss": -0.0003531872935127467, "vf_loss": 0.03743815794587135, "vf_explained_var": 0.7247660160064697, "kl": 0.0010717329569160938, "entropy": 0.8823238611221313, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 18.49404525756836, "policy_loss": -0.00015900211292319, "vf_loss": 18.494203567504883, "vf_explained_var": 0.0, "kl": 1.1920928955078125e-07, "entropy": 1.4224299192428589, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1540000, "episodes_total": 439, "training_iteration": 55, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-54-06", "timestamp": 1714830846, "time_this_iter_s": 17.8513765335083, "time_total_s": 1002.9679818153381, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa21b90>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1002.9679818153381, "timesteps_since_restore": 1540000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 46.056000000000004, "ram_util_percent": 54.324}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -22.10383052085396, "episode_reward_mean": -9.128978450168201, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -4.974856652921838}, "policy_reward_mean": {"cav": 8.080978171497422, "tl": -11.472462119902447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.910376012038858, "mean_processing_ms": 0.8821049155461114, "mean_inference_ms": 0.5802888450120008}, "off_policy_estimator": {}, "info": {"num_steps_trained": 280361, "num_steps_sampled": 1568000, "sample_time_ms": 16023.12, "load_time_ms": 11.343, "grad_time_ms": 2177.168, "update_time_ms": 3.891, "learner": {"tl": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03434499353170395, "policy_loss": -9.745113493409008e-05, "vf_loss": 0.03444244712591171, "vf_explained_var": 0.757600724697113, "kl": 0.00022229926253203303, "entropy": 0.8835998177528381, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1568000, "episodes_total": 447, "training_iteration": 56, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-54-24", "timestamp": 1714830864, "time_this_iter_s": 18.14679527282715, "time_total_s": 1021.1147770881653, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa463b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1021.1147770881653, "timesteps_since_restore": 1568000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 44.86923076923077, "ram_util_percent": 54.400000000000006}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
{"episode_reward_max": 22.978173966888154, "episode_reward_min": -22.10383052085396, "episode_reward_mean": -8.95648543111983, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -22.602324767118645}, "policy_reward_max": {"cav": 35.8232179207563, "tl": -5.550635597155406}, "policy_reward_mean": {"cav": 9.050649511072637, "tl": -11.490667294220161}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.911858481903358, "mean_processing_ms": 0.8818778086449482, "mean_inference_ms": 0.5808768059182136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 280422, "num_steps_sampled": 1596000, "sample_time_ms": 16002.337, "load_time_ms": 11.256, "grad_time_ms": 2145.844, "update_time_ms": 3.88, "learner": {"tl": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03541205823421478, "policy_loss": -5.2011477237101644e-05, "vf_loss": 0.03546406701207161, "vf_explained_var": 0.7584664821624756, "kl": 7.853542774682865e-05, "entropy": 0.8823950290679932, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 49.352909088134766, "policy_loss": 9.885577128443401e-06, "vf_loss": 49.352901458740234, "vf_explained_var": -1.1920928955078125e-07, "kl": 2.384185791015625e-07, "entropy": 1.421919822692871, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1596000, "episodes_total": 455, "training_iteration": 57, "experiment_id": "fae86a9447d54f23961273986a58b11f", "date": "2024-05-04_21-54-42", "timestamp": 1714830882, "time_this_iter_s": 17.739797830581665, "time_total_s": 1038.854574918747, "pid": 177344, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPress_cav_light_Env\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPress_cav_light_Env-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(7,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(96,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7fad3fa467a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1038.854574918747, "timesteps_since_restore": 1596000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 45.11923076923077, "ram_util_percent": 54.388461538461534}, "num_healthy_workers": 8, "trial_id": "6891cd22", "experiment_tag": "0"}
