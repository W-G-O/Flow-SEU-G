{"episode_reward_max": -279.4243506167024, "episode_reward_min": -311.79103003206114, "episode_reward_mean": -299.6214905843628, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.247149435555528, "mean_processing_ms": 0.7707429938566616, "mean_inference_ms": 0.5615746203610315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27904, "num_steps_sampled": 28000, "sample_time_ms": 18055.79, "load_time_ms": 50.774, "grad_time_ms": 2414.713, "update_time_ms": 297.104, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 5.172670364379883, "policy_loss": -0.0046151429414749146, "vf_loss": 5.176718711853027, "vf_explained_var": 0.00843666773289442, "kl": 0.0028326045721769333, "entropy": 1.3834792375564575, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 28000, "episodes_total": 4, "training_iteration": 1, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-20-29", "timestamp": 1714818029, "time_this_iter_s": 20.861891508102417, "time_total_s": 20.861891508102417, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20.861891508102417, "timesteps_since_restore": 28000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.56666666666667, "ram_util_percent": 45.37333333333334}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -245.28037284610897, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -286.346839583307, "episode_len_mean": 3500.0, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0413570928526705, "mean_processing_ms": 0.7376462906386395, "mean_inference_ms": 0.5553489602772941}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55808, "num_steps_sampled": 56000, "sample_time_ms": 17348.543, "load_time_ms": 30.085, "grad_time_ms": 2291.83, "update_time_ms": 150.654, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 3.802898406982422, "policy_loss": -0.007526197470724583, "vf_loss": 3.8095178604125977, "vf_explained_var": 0.006851650308817625, "kl": 0.009067374281585217, "entropy": 1.3635066747665405, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 56000, "episodes_total": 13, "training_iteration": 2, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-20-48", "timestamp": 1714818048, "time_this_iter_s": 18.831286668777466, "time_total_s": 39.69317817687988, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39.69317817687988, "timesteps_since_restore": 56000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.55555555555556, "ram_util_percent": 47.17777777777778}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -194.5715985158656, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -264.5092497931566, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9649492325890185, "mean_processing_ms": 0.7506373298848911, "mean_inference_ms": 0.5555597582624675}, "off_policy_estimator": {}, "info": {"num_steps_trained": 83712, "num_steps_sampled": 84000, "sample_time_ms": 16486.408, "load_time_ms": 23.407, "grad_time_ms": 2247.168, "update_time_ms": 101.276, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.4800851345062256, "policy_loss": -0.00800447165966034, "vf_loss": 2.4875574111938477, "vf_explained_var": 0.004938056692481041, "kl": 0.010643737390637398, "entropy": 1.3213249444961548, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 84000, "episodes_total": 21, "training_iteration": 3, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-21-05", "timestamp": 1714818065, "time_this_iter_s": 16.941675901412964, "time_total_s": 56.63485407829285, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 56.63485407829285, "timesteps_since_restore": 84000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.67083333333333, "ram_util_percent": 47.20000000000001}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -135.525635785784, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -239.55140705385455, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.914891488918399, "mean_processing_ms": 0.7651996084393345, "mean_inference_ms": 0.5575441326787276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 111616, "num_steps_sampled": 112000, "sample_time_ms": 16026.057, "load_time_ms": 20.038, "grad_time_ms": 2247.088, "update_time_ms": 76.876, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 1.315150499343872, "policy_loss": -0.003904107492417097, "vf_loss": 1.3188244104385376, "vf_explained_var": 0.002777132671326399, "kl": 0.00460779620334506, "entropy": 1.28143310546875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 112000, "episodes_total": 29, "training_iteration": 4, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-21-22", "timestamp": 1714818082, "time_this_iter_s": 16.912641048431396, "time_total_s": 73.54749512672424, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 73.54749512672424, "timesteps_since_restore": 112000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.78, "ram_util_percent": 47.284}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -128.33054649598714, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -218.98682342190818, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8736185105950107, "mean_processing_ms": 0.7766771827500076, "mean_inference_ms": 0.5572807223605347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139520, "num_steps_sampled": 140000, "sample_time_ms": 15637.086, "load_time_ms": 17.793, "grad_time_ms": 2249.329, "update_time_ms": 62.017, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2179945707321167, "policy_loss": -0.0034734471701085567, "vf_loss": 1.2213737964630127, "vf_explained_var": 0.0011862647952511907, "kl": 0.00377635401673615, "entropy": 1.23931884765625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 140000, "episodes_total": 37, "training_iteration": 5, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-21-38", "timestamp": 1714818098, "time_this_iter_s": 16.359482049942017, "time_total_s": 89.90697717666626, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 89.90697717666626, "timesteps_since_restore": 140000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.891304347826086, "ram_util_percent": 47.213043478260886}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -109.15148307403, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -202.12453485750925, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8392457512953126, "mean_processing_ms": 0.7858889147492288, "mean_inference_ms": 0.5565347117195868}, "off_policy_estimator": {}, "info": {"num_steps_trained": 167424, "num_steps_sampled": 168000, "sample_time_ms": 15344.487, "load_time_ms": 16.333, "grad_time_ms": 2252.584, "update_time_ms": 52.274, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8195703029632568, "policy_loss": -0.00347570376470685, "vf_loss": 0.822998046875, "vf_explained_var": 0.0005493866628967226, "kl": 0.0038354280404746532, "entropy": 1.1913667917251587, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 168000, "episodes_total": 45, "training_iteration": 6, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-21-54", "timestamp": 1714818114, "time_this_iter_s": 16.17041277885437, "time_total_s": 106.07738995552063, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 106.07738995552063, "timesteps_since_restore": 168000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.93478260869565, "ram_util_percent": 47.24347826086956}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -91.63376804653814, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -188.36901182230582, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.810469928566334, "mean_processing_ms": 0.793242512627845, "mean_inference_ms": 0.5556118218525828}, "off_policy_estimator": {}, "info": {"num_steps_trained": 195328, "num_steps_sampled": 196000, "sample_time_ms": 15157.073, "load_time_ms": 15.41, "grad_time_ms": 2256.01, "update_time_ms": 45.122, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8394205570220947, "policy_loss": -0.0013057364849373698, "vf_loss": 0.8407155871391296, "vf_explained_var": 0.0001590161700733006, "kl": 0.0017011846648529172, "entropy": 1.1702702045440674, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 196000, "episodes_total": 53, "training_iteration": 7, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-22-11", "timestamp": 1714818131, "time_this_iter_s": 16.33080554008484, "time_total_s": 122.40819549560547, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 122.40819549560547, "timesteps_since_restore": 196000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.65652173913044, "ram_util_percent": 47.213043478260886}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -73.44152061990344, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -177.3224897487566, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.785966299956685, "mean_processing_ms": 0.7994236100041427, "mean_inference_ms": 0.5547106362025597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 223232, "num_steps_sampled": 224000, "sample_time_ms": 14993.68, "load_time_ms": 14.659, "grad_time_ms": 2245.701, "update_time_ms": 39.806, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7909330725669861, "policy_loss": -0.0011994586093351245, "vf_loss": 0.7921278476715088, "vf_explained_var": 9.211678843712434e-05, "kl": 0.001514382311142981, "entropy": 1.1431633234024048, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 224000, "episodes_total": 61, "training_iteration": 8, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-22-27", "timestamp": 1714818147, "time_this_iter_s": 16.044750452041626, "time_total_s": 138.4529459476471, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 138.4529459476471, "timesteps_since_restore": 224000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.02608695652174, "ram_util_percent": 47.195652173913054}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -73.44152061990344, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -168.62393956541723, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7649474976054242, "mean_processing_ms": 0.8045988903131464, "mean_inference_ms": 0.5538597635940746}, "off_policy_estimator": {}, "info": {"num_steps_trained": 251136, "num_steps_sampled": 252000, "sample_time_ms": 14871.942, "load_time_ms": 13.954, "grad_time_ms": 2245.856, "update_time_ms": 35.658, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6867749691009521, "policy_loss": -0.0006220525247044861, "vf_loss": 0.6873951554298401, "vf_explained_var": 3.9815357013139874e-05, "kl": 0.0012359126703813672, "entropy": 1.1163873672485352, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 252000, "episodes_total": 69, "training_iteration": 9, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-22-43", "timestamp": 1714818163, "time_this_iter_s": 16.163665294647217, "time_total_s": 154.6166112422943, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 154.6166112422943, "timesteps_since_restore": 252000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.79130434782609, "ram_util_percent": 47.26521739130435}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -72.42899794649848, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -160.84842059917597, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7464629302931005, "mean_processing_ms": 0.8090144245128881, "mean_inference_ms": 0.553035420025645}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279040, "num_steps_sampled": 280000, "sample_time_ms": 14765.38, "load_time_ms": 13.433, "grad_time_ms": 2244.508, "update_time_ms": 32.489, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6078479290008545, "policy_loss": -0.002095020841807127, "vf_loss": 0.6099408864974976, "vf_explained_var": 1.3470103112922516e-05, "kl": 0.0026324300561100245, "entropy": 1.085360050201416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 280000, "episodes_total": 77, "training_iteration": 10, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-22-59", "timestamp": 1714818179, "time_this_iter_s": 16.05902075767517, "time_total_s": 170.67563199996948, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 170.67563199996948, "timesteps_since_restore": 280000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.43043478260869, "ram_util_percent": 47.252173913043464}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -72.42899794649848, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -154.62944310507459, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.730101998016022, "mean_processing_ms": 0.812794221932929, "mean_inference_ms": 0.5524441552102034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 306944, "num_steps_sampled": 308000, "sample_time_ms": 14351.671, "load_time_ms": 9.338, "grad_time_ms": 2225.625, "update_time_ms": 3.06, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0534396171569824, "policy_loss": -0.0003471120144240558, "vf_loss": 1.053786277770996, "vf_explained_var": 3.199238335582777e-06, "kl": 0.0008302950300276279, "entropy": 1.0795563459396362, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 308000, "episodes_total": 85, "training_iteration": 11, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-23-15", "timestamp": 1714818195, "time_this_iter_s": 16.164721488952637, "time_total_s": 186.84035348892212, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 186.84035348892212, "timesteps_since_restore": 308000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.699999999999996, "ram_util_percent": 47.29999999999998}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -66.20312670989243, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -149.3444783807633, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.715377566828898, "mean_processing_ms": 0.816016709019461, "mean_inference_ms": 0.5517995230484173}, "off_policy_estimator": {}, "info": {"num_steps_trained": 334848, "num_steps_sampled": 336000, "sample_time_ms": 14052.911, "load_time_ms": 9.513, "grad_time_ms": 2241.628, "update_time_ms": 2.891, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 0.988981306552887, "policy_loss": -0.001645181211642921, "vf_loss": 0.9906260371208191, "vf_explained_var": 1.0871012818824966e-06, "kl": 0.0021938516292721033, "entropy": 1.0635261535644531, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 336000, "episodes_total": 93, "training_iteration": 12, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-23-31", "timestamp": 1714818211, "time_this_iter_s": 16.006778240203857, "time_total_s": 202.84713172912598, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 202.84713172912598, "timesteps_since_restore": 336000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.18695652173913, "ram_util_percent": 47.230434782608704}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -66.20312670989243, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -142.95653827337082, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6965181499229907, "mean_processing_ms": 0.8193081633121883, "mean_inference_ms": 0.5510934510435477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 362752, "num_steps_sampled": 364000, "sample_time_ms": 13937.11, "load_time_ms": 9.394, "grad_time_ms": 2278.535, "update_time_ms": 2.878, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7309191823005676, "policy_loss": -0.0009577692835591733, "vf_loss": 0.7318767309188843, "vf_explained_var": 1.613153273183343e-07, "kl": 0.001260258723050356, "entropy": 1.0432671308517456, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 364000, "episodes_total": 101, "training_iteration": 13, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-23-47", "timestamp": 1714818227, "time_this_iter_s": 16.15364646911621, "time_total_s": 219.0007781982422, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 219.0007781982422, "timesteps_since_restore": 364000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.30434782608695, "ram_util_percent": 47.18695652173914}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -62.69741646726267, "episode_reward_min": -316.03242432403846, "episode_reward_mean": -126.70792829282006, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.655640596363242, "mean_processing_ms": 0.8262964794730947, "mean_inference_ms": 0.5500027004532615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 390656, "num_steps_sampled": 392000, "sample_time_ms": 13846.663, "load_time_ms": 9.303, "grad_time_ms": 2300.078, "update_time_ms": 2.766, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9103821516036987, "policy_loss": -0.0008586479816585779, "vf_loss": 0.9112407565116882, "vf_explained_var": 3.1962306934474327e-07, "kl": 0.0005477620870806277, "entropy": 1.0276225805282593, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 392000, "episodes_total": 109, "training_iteration": 14, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-24-04", "timestamp": 1714818244, "time_this_iter_s": 16.222731828689575, "time_total_s": 235.22351002693176, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 235.22351002693176, "timesteps_since_restore": 392000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 44.51304347826087, "ram_util_percent": 47.29130434782609}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -62.69741646726267, "episode_reward_min": -273.91939278643554, "episode_reward_mean": -113.2763730555651, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.626254135319669, "mean_processing_ms": 0.8358935318573221, "mean_inference_ms": 0.5490089441422183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 418560, "num_steps_sampled": 420000, "sample_time_ms": 13810.743, "load_time_ms": 9.327, "grad_time_ms": 2303.174, "update_time_ms": 2.764, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6060782670974731, "policy_loss": -0.0008813421591185033, "vf_loss": 0.6069596409797668, "vf_explained_var": 1.014372656982232e-07, "kl": 0.0003490097587928176, "entropy": 1.0136934518814087, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 420000, "episodes_total": 117, "training_iteration": 15, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-24-20", "timestamp": 1714818260, "time_this_iter_s": 16.032071113586426, "time_total_s": 251.2555811405182, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 251.2555811405182, "timesteps_since_restore": 420000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.55217391304348, "ram_util_percent": 47.31304347826086}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.416577866578336, "episode_reward_min": -208.7008656926151, "episode_reward_mean": -103.24735014389645, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6027148804193763, "mean_processing_ms": 0.8417310638311603, "mean_inference_ms": 0.5475136381453684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 446464, "num_steps_sampled": 448000, "sample_time_ms": 13783.272, "load_time_ms": 9.287, "grad_time_ms": 2299.761, "update_time_ms": 2.662, "learner": {"default_policy": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8110921382904053, "policy_loss": -0.0007674837834201753, "vf_loss": 0.811859667301178, "vf_explained_var": -7.847033600683062e-08, "kl": 0.0011090910993516445, "entropy": 0.9991574287414551, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 448000, "episodes_total": 125, "training_iteration": 16, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-24-35", "timestamp": 1714818275, "time_this_iter_s": 15.864122867584229, "time_total_s": 267.1197040081024, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 267.1197040081024, "timesteps_since_restore": 448000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.369565217391305, "ram_util_percent": 47.32173913043478}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.416577866578336, "episode_reward_min": -154.7230137483771, "episode_reward_mean": -96.28880460962338, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5836775857371737, "mean_processing_ms": 0.8458020926118622, "mean_inference_ms": 0.5460207211326762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 474368, "num_steps_sampled": 476000, "sample_time_ms": 13740.944, "load_time_ms": 9.282, "grad_time_ms": 2305.638, "update_time_ms": 2.662, "learner": {"default_policy": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9377654194831848, "policy_loss": -0.0012346998555585742, "vf_loss": 0.939000129699707, "vf_explained_var": -3.80047957548868e-08, "kl": 0.0010522464290261269, "entropy": 0.993987500667572, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 476000, "episodes_total": 133, "training_iteration": 17, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-24-51", "timestamp": 1714818291, "time_this_iter_s": 15.966532707214355, "time_total_s": 283.0862367153168, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 283.0862367153168, "timesteps_since_restore": 476000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.27826086956522, "ram_util_percent": 47.356521739130436}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.416577866578336, "episode_reward_min": -151.58122810196238, "episode_reward_mean": -93.26669608911916, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.568369244850194, "mean_processing_ms": 0.8487804630402132, "mean_inference_ms": 0.5448884898382128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 502272, "num_steps_sampled": 504000, "sample_time_ms": 13721.278, "load_time_ms": 9.233, "grad_time_ms": 2342.379, "update_time_ms": 2.659, "learner": {"default_policy": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0036637783050537, "policy_loss": 0.00011528166942298412, "vf_loss": 1.0035486221313477, "vf_explained_var": -1.9685938212887777e-08, "kl": 0.00011221712338738143, "entropy": 0.9869617223739624, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 504000, "episodes_total": 141, "training_iteration": 18, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-25-08", "timestamp": 1714818308, "time_this_iter_s": 16.216050624847412, "time_total_s": 299.3022873401642, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 299.3022873401642, "timesteps_since_restore": 504000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.60434782608696, "ram_util_percent": 47.356521739130415}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.416577866578336, "episode_reward_min": -133.43939814657236, "episode_reward_mean": -90.5077127281733, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5557060523087283, "mean_processing_ms": 0.8509948256810402, "mean_inference_ms": 0.5439444028336065}, "off_policy_estimator": {}, "info": {"num_steps_trained": 530176, "num_steps_sampled": 532000, "sample_time_ms": 13702.589, "load_time_ms": 9.318, "grad_time_ms": 2360.768, "update_time_ms": 2.66, "learner": {"default_policy": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4514484405517578, "policy_loss": -0.0002533923543523997, "vf_loss": 1.4517018795013428, "vf_explained_var": -1.7225195492187595e-08, "kl": 0.00040149089181795716, "entropy": 0.9812478423118591, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 532000, "episodes_total": 149, "training_iteration": 19, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-25-24", "timestamp": 1714818324, "time_this_iter_s": 16.161785125732422, "time_total_s": 315.4640724658966, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 315.4640724658966, "timesteps_since_restore": 532000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 44.4695652173913, "ram_util_percent": 47.35652173913043}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.462975488563686, "episode_reward_min": -133.43939814657236, "episode_reward_mean": -89.80358618229056, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.545159705649677, "mean_processing_ms": 0.852774302814437, "mean_inference_ms": 0.5431852399400177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 558080, "num_steps_sampled": 560000, "sample_time_ms": 13705.955, "load_time_ms": 9.323, "grad_time_ms": 2368.073, "update_time_ms": 2.521, "learner": {"default_policy": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 2.121469497680664, "policy_loss": 0.00013636531366501004, "vf_loss": 2.121333122253418, "vf_explained_var": -1.0936631600344526e-09, "kl": 0.00013278282131068408, "entropy": 0.9815405011177063, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 560000, "episodes_total": 157, "training_iteration": 20, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-25-40", "timestamp": 1714818340, "time_this_iter_s": 16.16515040397644, "time_total_s": 331.62922286987305, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 331.62922286987305, "timesteps_since_restore": 560000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.869565217391305, "ram_util_percent": 47.33478260869563}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.462975488563686, "episode_reward_min": -133.43939814657236, "episode_reward_mean": -89.74168413579902, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.535958683285591, "mean_processing_ms": 0.854147585262828, "mean_inference_ms": 0.5425089936508151}, "off_policy_estimator": {}, "info": {"num_steps_trained": 585984, "num_steps_sampled": 588000, "sample_time_ms": 13680.463, "load_time_ms": 9.255, "grad_time_ms": 2367.665, "update_time_ms": 2.472, "learner": {"default_policy": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 1.156633734703064, "policy_loss": -0.0006268761353567243, "vf_loss": 1.157260537147522, "vf_explained_var": -1.3397373876955498e-08, "kl": 0.0003852395748253912, "entropy": 0.9652136564254761, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 588000, "episodes_total": 165, "training_iteration": 21, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-25-56", "timestamp": 1714818356, "time_this_iter_s": 15.904891729354858, "time_total_s": 347.5341145992279, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 347.5341145992279, "timesteps_since_restore": 588000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 44.504347826086956, "ram_util_percent": 47.35652173913043}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.462975488563686, "episode_reward_min": -133.43939814657236, "episode_reward_mean": -88.27653707310078, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.528014706655292, "mean_processing_ms": 0.8553928981771318, "mean_inference_ms": 0.5420102289559227}, "off_policy_estimator": {}, "info": {"num_steps_trained": 613888, "num_steps_sampled": 616000, "sample_time_ms": 13700.665, "load_time_ms": 9.346, "grad_time_ms": 2351.793, "update_time_ms": 2.485, "learner": {"default_policy": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8337432146072388, "policy_loss": -0.0005467982264235616, "vf_loss": 1.8342901468276978, "vf_explained_var": -1.859227438671951e-08, "kl": 0.000737772264983505, "entropy": 0.9623339176177979, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 616000, "episodes_total": 173, "training_iteration": 22, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-26-12", "timestamp": 1714818372, "time_this_iter_s": 16.049195051193237, "time_total_s": 363.58330965042114, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 363.58330965042114, "timesteps_since_restore": 616000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 44.71304347826087, "ram_util_percent": 47.391304347826086}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.462975488563686, "episode_reward_min": -136.24562485330125, "episode_reward_mean": -89.4886264725128, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5211488241879074, "mean_processing_ms": 0.8563871831697167, "mean_inference_ms": 0.5415195505379622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 641792, "num_steps_sampled": 644000, "sample_time_ms": 13704.919, "load_time_ms": 9.48, "grad_time_ms": 2321.396, "update_time_ms": 2.767, "learner": {"default_policy": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 1.230465054512024, "policy_loss": -0.001170931849628687, "vf_loss": 1.2316359281539917, "vf_explained_var": -1.0936632044433736e-08, "kl": 0.0019565692637115717, "entropy": 0.946357250213623, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 644000, "episodes_total": 181, "training_iteration": 23, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-26-28", "timestamp": 1714818388, "time_this_iter_s": 15.892337322235107, "time_total_s": 379.47564697265625, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 379.47564697265625, "timesteps_since_restore": 644000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 45.659090909090914, "ram_util_percent": 47.34090909090908}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.462975488563686, "episode_reward_min": -136.24562485330125, "episode_reward_mean": -88.5701347206201, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5151030880439573, "mean_processing_ms": 0.857247184283042, "mean_inference_ms": 0.5410392607940571}, "off_policy_estimator": {}, "info": {"num_steps_trained": 669696, "num_steps_sampled": 672000, "sample_time_ms": 13693.499, "load_time_ms": 9.467, "grad_time_ms": 2298.662, "update_time_ms": 2.765, "learner": {"default_policy": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4434502124786377, "policy_loss": -0.0002688150270842016, "vf_loss": 1.4437190294265747, "vf_explained_var": -5.194900065674801e-09, "kl": 0.0013861366314813495, "entropy": 0.9465051889419556, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 672000, "episodes_total": 189, "training_iteration": 24, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-26-44", "timestamp": 1714818404, "time_this_iter_s": 15.88322138786316, "time_total_s": 395.3588683605194, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 395.3588683605194, "timesteps_since_restore": 672000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 44.49999999999999, "ram_util_percent": 47.4}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -142.13264986647235, "episode_reward_mean": -88.25886574937807, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.509862268311198, "mean_processing_ms": 0.8580550328075893, "mean_inference_ms": 0.540655204466249}, "off_policy_estimator": {}, "info": {"num_steps_trained": 697600, "num_steps_sampled": 700000, "sample_time_ms": 13683.459, "load_time_ms": 9.403, "grad_time_ms": 2293.612, "update_time_ms": 2.982, "learner": {"default_policy": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 1.643987774848938, "policy_loss": -0.00011375286703696474, "vf_loss": 1.6441015005111694, "vf_explained_var": -1.9139105855714433e-09, "kl": 2.660459722392261e-05, "entropy": 0.950082540512085, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 700000, "episodes_total": 197, "training_iteration": 25, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-27-00", "timestamp": 1714818420, "time_this_iter_s": 15.882999181747437, "time_total_s": 411.24186754226685, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 411.24186754226685, "timesteps_since_restore": 700000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.52173913043478, "ram_util_percent": 47.45217391304348}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -147.18833860583968, "episode_reward_mean": -89.14210332505489, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5052001439541467, "mean_processing_ms": 0.8587742792366692, "mean_inference_ms": 0.5403065318760051}, "off_policy_estimator": {}, "info": {"num_steps_trained": 725504, "num_steps_sampled": 728000, "sample_time_ms": 13683.874, "load_time_ms": 9.565, "grad_time_ms": 2293.244, "update_time_ms": 3.177, "learner": {"default_policy": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8788655996322632, "policy_loss": 9.085251804208383e-05, "vf_loss": 1.878774642944336, "vf_explained_var": 3.280989702147963e-09, "kl": 3.7753383367089555e-05, "entropy": 0.9449737071990967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 728000, "episodes_total": 205, "training_iteration": 26, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-27-16", "timestamp": 1714818436, "time_this_iter_s": 15.864579677581787, "time_total_s": 427.10644721984863, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 427.10644721984863, "timesteps_since_restore": 728000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 45.709090909090904, "ram_util_percent": 47.440909090909095}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -147.18833860583968, "episode_reward_mean": -90.79542918997073, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5010734639905166, "mean_processing_ms": 0.8594183685516112, "mean_inference_ms": 0.5399966897297392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 753408, "num_steps_sampled": 756000, "sample_time_ms": 13689.697, "load_time_ms": 9.419, "grad_time_ms": 2290.284, "update_time_ms": 3.213, "learner": {"default_policy": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6674638986587524, "policy_loss": -0.0004045414971187711, "vf_loss": 1.6678683757781982, "vf_explained_var": 8.202474255369907e-10, "kl": 0.0001576141221448779, "entropy": 0.9344619512557983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 756000, "episodes_total": 213, "training_iteration": 27, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-27-31", "timestamp": 1714818451, "time_this_iter_s": 15.993143558502197, "time_total_s": 443.09959077835083, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 443.09959077835083, "timesteps_since_restore": 756000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 44.608695652173914, "ram_util_percent": 47.45652173913044}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -147.18833860583968, "episode_reward_mean": -91.45928401289113, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4974529927128755, "mean_processing_ms": 0.8599153747319912, "mean_inference_ms": 0.5397329258030682}, "off_policy_estimator": {}, "info": {"num_steps_trained": 781312, "num_steps_sampled": 784000, "sample_time_ms": 13695.153, "load_time_ms": 9.476, "grad_time_ms": 2262.23, "update_time_ms": 3.202, "learner": {"default_policy": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 2.067600727081299, "policy_loss": -0.0002546630275901407, "vf_loss": 2.0678553581237793, "vf_explained_var": -3.827821171142887e-09, "kl": 6.233474414329976e-05, "entropy": 0.9387179613113403, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 784000, "episodes_total": 221, "training_iteration": 28, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-27-47", "timestamp": 1714818467, "time_this_iter_s": 15.98961615562439, "time_total_s": 459.0892069339752, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 459.0892069339752, "timesteps_since_restore": 784000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 44.560869565217395, "ram_util_percent": 47.491304347826095}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -149.2913752097576, "episode_reward_mean": -94.44087885164366, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.49437782357556, "mean_processing_ms": 0.8603517936129075, "mean_inference_ms": 0.5395313377372689}, "off_policy_estimator": {}, "info": {"num_steps_trained": 809216, "num_steps_sampled": 812000, "sample_time_ms": 13701.912, "load_time_ms": 9.478, "grad_time_ms": 2247.26, "update_time_ms": 3.197, "learner": {"default_policy": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 2.2429492473602295, "policy_loss": -0.00038691426743753254, "vf_loss": 2.2433362007141113, "vf_explained_var": -1.0936632044433736e-08, "kl": 0.0008204292389564216, "entropy": 0.9441003799438477, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 812000, "episodes_total": 229, "training_iteration": 29, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-28-04", "timestamp": 1714818484, "time_this_iter_s": 16.079520225524902, "time_total_s": 475.1687271595001, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 475.1687271595001, "timesteps_since_restore": 812000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 44.52173913043478, "ram_util_percent": 47.44782608695652}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -96.91425121592373, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.491640106026124, "mean_processing_ms": 0.8606926521658254, "mean_inference_ms": 0.539365622244158}, "off_policy_estimator": {}, "info": {"num_steps_trained": 837120, "num_steps_sampled": 840000, "sample_time_ms": 13685.302, "load_time_ms": 9.444, "grad_time_ms": 2242.811, "update_time_ms": 3.215, "learner": {"default_policy": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7253448963165283, "policy_loss": 0.0005248295492492616, "vf_loss": 1.7248202562332153, "vf_explained_var": -2.1873263200689053e-09, "kl": 0.00021810333419125527, "entropy": 0.9439025521278381, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 840000, "episodes_total": 237, "training_iteration": 30, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-28-20", "timestamp": 1714818500, "time_this_iter_s": 15.95393967628479, "time_total_s": 491.1226668357849, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 491.1226668357849, "timesteps_since_restore": 840000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 44.19565217391304, "ram_util_percent": 47.45217391304348}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -96.30368762014558, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.489133543825963, "mean_processing_ms": 0.8609298739609474, "mean_inference_ms": 0.5392143914443647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 865024, "num_steps_sampled": 868000, "sample_time_ms": 13681.522, "load_time_ms": 9.414, "grad_time_ms": 2245.356, "update_time_ms": 3.25, "learner": {"default_policy": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4585672616958618, "policy_loss": 2.8351578293950297e-05, "vf_loss": 1.4585386514663696, "vf_explained_var": 0.0, "kl": 0.0006602584035135806, "entropy": 0.9414934515953064, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 868000, "episodes_total": 245, "training_iteration": 31, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-28-35", "timestamp": 1714818515, "time_this_iter_s": 15.894070863723755, "time_total_s": 507.01673769950867, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 507.01673769950867, "timesteps_since_restore": 868000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 45.40909090909091, "ram_util_percent": 47.47727272727273}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -97.38856898906042, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.486784908360672, "mean_processing_ms": 0.8611256036400683, "mean_inference_ms": 0.5390824122169584}, "off_policy_estimator": {}, "info": {"num_steps_trained": 892928, "num_steps_sampled": 896000, "sample_time_ms": 13670.376, "load_time_ms": 9.313, "grad_time_ms": 2252.524, "update_time_ms": 3.241, "learner": {"default_policy": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6846388578414917, "policy_loss": 0.00013151067832950503, "vf_loss": 1.6845073699951172, "vf_explained_var": -7.1088108732908495e-09, "kl": 0.0002526015741750598, "entropy": 0.9425784945487976, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 896000, "episodes_total": 253, "training_iteration": 32, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-28-51", "timestamp": 1714818531, "time_this_iter_s": 16.007655382156372, "time_total_s": 523.024393081665, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 523.024393081665, "timesteps_since_restore": 896000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 44.70434782608696, "ram_util_percent": 47.48260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -95.81810579329513, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.484596849430653, "mean_processing_ms": 0.8613287656586935, "mean_inference_ms": 0.5390052741802432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 920832, "num_steps_sampled": 924000, "sample_time_ms": 13677.367, "load_time_ms": 9.211, "grad_time_ms": 2262.034, "update_time_ms": 2.972, "learner": {"default_policy": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 1.905198097229004, "policy_loss": -0.0002863768604584038, "vf_loss": 1.9054845571517944, "vf_explained_var": -4.921484553221944e-09, "kl": 0.00048408418660983443, "entropy": 0.9465880990028381, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 924000, "episodes_total": 261, "training_iteration": 33, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-29-08", "timestamp": 1714818548, "time_this_iter_s": 16.054218292236328, "time_total_s": 539.0786113739014, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 539.0786113739014, "timesteps_since_restore": 924000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 44.55217391304348, "ram_util_percent": 47.51304347826087}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -96.77955826377783, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.482551854824865, "mean_processing_ms": 0.8614572891688017, "mean_inference_ms": 0.5388931614769096}, "off_policy_estimator": {}, "info": {"num_steps_trained": 948736, "num_steps_sampled": 952000, "sample_time_ms": 13684.124, "load_time_ms": 9.232, "grad_time_ms": 2255.42, "update_time_ms": 2.982, "learner": {"default_policy": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8915218114852905, "policy_loss": -0.0005096719251014292, "vf_loss": 1.8920314311981201, "vf_explained_var": -1.148346395751787e-08, "kl": 7.2450828156434e-05, "entropy": 0.9393182992935181, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 952000, "episodes_total": 269, "training_iteration": 34, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-29-23", "timestamp": 1714818563, "time_this_iter_s": 15.887426376342773, "time_total_s": 554.9660377502441, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 554.9660377502441, "timesteps_since_restore": 952000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 44.495652173913044, "ram_util_percent": 47.508695652173905}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -96.82897517496266, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4806225966394986, "mean_processing_ms": 0.8615592280057878, "mean_inference_ms": 0.5387502328818993}, "off_policy_estimator": {}, "info": {"num_steps_trained": 976640, "num_steps_sampled": 980000, "sample_time_ms": 13695.89, "load_time_ms": 9.25, "grad_time_ms": 2260.649, "update_time_ms": 2.835, "learner": {"default_policy": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8830804824829102, "policy_loss": -0.0007977125933393836, "vf_loss": 1.8838781118392944, "vf_explained_var": -4.921484553221944e-09, "kl": 8.236308531195391e-06, "entropy": 0.9394198656082153, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 980000, "episodes_total": 277, "training_iteration": 35, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-29-39", "timestamp": 1714818579, "time_this_iter_s": 16.049708366394043, "time_total_s": 571.0157461166382, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 571.0157461166382, "timesteps_since_restore": 980000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 44.39565217391305, "ram_util_percent": 47.50869565217391}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -96.8718265365182, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4787913689489987, "mean_processing_ms": 0.8617137268505727, "mean_inference_ms": 0.5385954091052736}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1004544, "num_steps_sampled": 1008000, "sample_time_ms": 13697.098, "load_time_ms": 9.109, "grad_time_ms": 2266.776, "update_time_ms": 2.658, "learner": {"default_policy": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8280653953552246, "policy_loss": -0.0008560189162380993, "vf_loss": 1.8289214372634888, "vf_explained_var": -3.280989702147963e-09, "kl": 0.0006238569621928036, "entropy": 0.9367704391479492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1008000, "episodes_total": 285, "training_iteration": 36, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-29-55", "timestamp": 1714818595, "time_this_iter_s": 15.938615560531616, "time_total_s": 586.9543616771698, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 586.9543616771698, "timesteps_since_restore": 1008000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.695454545454545, "ram_util_percent": 47.527272727272724}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.25789871978752, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -98.22858197494799, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4771060730095567, "mean_processing_ms": 0.8619064811357454, "mean_inference_ms": 0.5384843995411298}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1032448, "num_steps_sampled": 1036000, "sample_time_ms": 13718.824, "load_time_ms": 9.222, "grad_time_ms": 2260.956, "update_time_ms": 2.894, "learner": {"default_policy": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5434465408325195, "policy_loss": -0.0014455028576776385, "vf_loss": 1.5448920726776123, "vf_explained_var": -9.842969106443888e-09, "kl": 0.0031107673421502113, "entropy": 0.9384613037109375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1036000, "episodes_total": 293, "training_iteration": 37, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-30-12", "timestamp": 1714818612, "time_this_iter_s": 16.154428482055664, "time_total_s": 603.1087901592255, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 603.1087901592255, "timesteps_since_restore": 1036000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 46.3913043478261, "ram_util_percent": 47.739130434782616}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -56.825160215603034, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -98.11000847957513, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.475630922899529, "mean_processing_ms": 0.8621106898914371, "mean_inference_ms": 0.5384178393261828}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1060352, "num_steps_sampled": 1064000, "sample_time_ms": 13759.172, "load_time_ms": 9.174, "grad_time_ms": 2258.792, "update_time_ms": 2.909, "learner": {"default_policy": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 1.901497483253479, "policy_loss": 0.00032919482327997684, "vf_loss": 1.9011682271957397, "vf_explained_var": 1.0936631600344526e-09, "kl": 9.716262866277248e-06, "entropy": 0.9361720681190491, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1064000, "episodes_total": 301, "training_iteration": 38, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-30-28", "timestamp": 1714818628, "time_this_iter_s": 16.36933732032776, "time_total_s": 619.4781274795532, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 619.4781274795532, "timesteps_since_restore": 1064000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 44.15, "ram_util_percent": 48.458333333333336}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -56.825160215603034, "episode_reward_min": -153.87099379121244, "episode_reward_mean": -96.59433522359146, "episode_len_mean": 3500.0, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4730377137968107, "mean_processing_ms": 0.8622788590948098, "mean_inference_ms": 0.5382335091999965}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1088256, "num_steps_sampled": 1092000, "sample_time_ms": 13942.974, "load_time_ms": 9.142, "grad_time_ms": 2249.436, "update_time_ms": 2.93, "learner": {"default_policy": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0813519954681396, "policy_loss": -0.00023442821111530066, "vf_loss": 2.0815865993499756, "vf_explained_var": -5.741731978758935e-09, "kl": 3.149979420413729e-06, "entropy": 0.9360455274581909, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1092000, "episodes_total": 310, "training_iteration": 39, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-30-46", "timestamp": 1714818646, "time_this_iter_s": 17.82824993133545, "time_total_s": 637.3063774108887, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 637.3063774108887, "timesteps_since_restore": 1092000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 40.82000000000001, "ram_util_percent": 48.38}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -56.825160215603034, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -97.6630487798323, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4716990448171248, "mean_processing_ms": 0.8625819690260883, "mean_inference_ms": 0.5381680995915498}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1116160, "num_steps_sampled": 1120000, "sample_time_ms": 13968.441, "load_time_ms": 9.13, "grad_time_ms": 2244.836, "update_time_ms": 2.92, "learner": {"default_policy": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 2.2697668075561523, "policy_loss": -1.6250331100309268e-05, "vf_loss": 2.2697830200195312, "vf_explained_var": -5.194900065674801e-09, "kl": 0.0005939226830378175, "entropy": 0.9312986135482788, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1120000, "episodes_total": 318, "training_iteration": 40, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-31-02", "timestamp": 1714818662, "time_this_iter_s": 16.161571741104126, "time_total_s": 653.4679491519928, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 653.4679491519928, "timesteps_since_restore": 1120000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 43.99565217391304, "ram_util_percent": 48.39565217391304}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.72034366648282, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -97.25044664734142, "episode_len_mean": 3500.0, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.469056483168876, "mean_processing_ms": 0.8629084671447513, "mean_inference_ms": 0.5380299851410039}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1144064, "num_steps_sampled": 1148000, "sample_time_ms": 14167.407, "load_time_ms": 9.236, "grad_time_ms": 2274.731, "update_time_ms": 2.898, "learner": {"default_policy": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 2.573258638381958, "policy_loss": 0.00017984143050853163, "vf_loss": 2.5730786323547363, "vf_explained_var": -1.0936631600344526e-09, "kl": 0.00017049751477316022, "entropy": 0.9246819019317627, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1148000, "episodes_total": 327, "training_iteration": 41, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-31-20", "timestamp": 1714818680, "time_this_iter_s": 18.18344283103943, "time_total_s": 671.6513919830322, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 671.6513919830322, "timesteps_since_restore": 1148000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 40.1576923076923, "ram_util_percent": 48.37307692307692}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -95.3423234795735, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4678541164837116, "mean_processing_ms": 0.8633267843394364, "mean_inference_ms": 0.5379851826680162}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1171968, "num_steps_sampled": 1176000, "sample_time_ms": 14190.08, "load_time_ms": 9.026, "grad_time_ms": 2302.861, "update_time_ms": 2.897, "learner": {"default_policy": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 2.1424264907836914, "policy_loss": -0.0006103633204475045, "vf_loss": 2.1430368423461914, "vf_explained_var": 0.0, "kl": 0.0001885503006633371, "entropy": 0.9228315949440002, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1176000, "episodes_total": 335, "training_iteration": 42, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-31-37", "timestamp": 1714818697, "time_this_iter_s": 16.51421093940735, "time_total_s": 688.1656029224396, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 688.1656029224396, "timesteps_since_restore": 1176000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 42.86249999999999, "ram_util_percent": 48.34583333333333}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -95.59136935166671, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4667677773842076, "mean_processing_ms": 0.8637275163518399, "mean_inference_ms": 0.5379652539060737}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1199872, "num_steps_sampled": 1204000, "sample_time_ms": 14200.768, "load_time_ms": 9.198, "grad_time_ms": 2304.125, "update_time_ms": 2.907, "learner": {"default_policy": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7337760925292969, "policy_loss": 8.441042882623151e-05, "vf_loss": 1.7336918115615845, "vf_explained_var": -7.1088108732908495e-09, "kl": 0.00010078295599669218, "entropy": 0.9218181371688843, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1204000, "episodes_total": 343, "training_iteration": 43, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-31-53", "timestamp": 1714818713, "time_this_iter_s": 16.17613434791565, "time_total_s": 704.3417372703552, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 704.3417372703552, "timesteps_since_restore": 1204000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 44.35217391304348, "ram_util_percent": 48.32173913043478}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -96.3486371303105, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4657645441884912, "mean_processing_ms": 0.8641017641446969, "mean_inference_ms": 0.5379715511192419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1227776, "num_steps_sampled": 1232000, "sample_time_ms": 14222.046, "load_time_ms": 9.194, "grad_time_ms": 2328.099, "update_time_ms": 3.146, "learner": {"default_policy": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 2.7875685691833496, "policy_loss": -0.0007437765598297119, "vf_loss": 2.7883121967315674, "vf_explained_var": -3.007573745605896e-09, "kl": 0.0016081694047898054, "entropy": 0.9276913404464722, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1232000, "episodes_total": 351, "training_iteration": 44, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-32-09", "timestamp": 1714818729, "time_this_iter_s": 16.336905002593994, "time_total_s": 720.6786422729492, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 720.6786422729492, "timesteps_since_restore": 1232000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 44.34782608695652, "ram_util_percent": 48.38695652173914}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -97.15838639546746, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4648276424516795, "mean_processing_ms": 0.8644287883765776, "mean_inference_ms": 0.5379709935494069}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1255680, "num_steps_sampled": 1260000, "sample_time_ms": 14220.311, "load_time_ms": 9.194, "grad_time_ms": 2333.151, "update_time_ms": 3.141, "learner": {"default_policy": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 2.5795602798461914, "policy_loss": 0.00017103225400205702, "vf_loss": 2.5793893337249756, "vf_explained_var": -2.460742276610972e-09, "kl": 0.00021093967370688915, "entropy": 0.9235191941261292, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1260000, "episodes_total": 359, "training_iteration": 45, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-32-25", "timestamp": 1714818745, "time_this_iter_s": 16.0822536945343, "time_total_s": 736.7608959674835, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 736.7608959674835, "timesteps_since_restore": 1260000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 44.182608695652185, "ram_util_percent": 48.38260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -97.96815355495056, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4639513017314245, "mean_processing_ms": 0.8646890964192393, "mean_inference_ms": 0.537952094958738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1283584, "num_steps_sampled": 1288000, "sample_time_ms": 14242.859, "load_time_ms": 9.282, "grad_time_ms": 2343.953, "update_time_ms": 3.107, "learner": {"default_policy": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 2.6011288166046143, "policy_loss": -0.0005642788019031286, "vf_loss": 2.6016929149627686, "vf_explained_var": 5.468315800172263e-10, "kl": 0.0009491452947258949, "entropy": 0.9260094165802002, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1288000, "episodes_total": 367, "training_iteration": 46, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-32-42", "timestamp": 1714818762, "time_this_iter_s": 16.271857738494873, "time_total_s": 753.0327537059784, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 753.0327537059784, "timesteps_since_restore": 1288000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 43.952173913043474, "ram_util_percent": 48.352173913043465}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -166.17909988618544, "episode_reward_mean": -98.06741469145771, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.463155747668983, "mean_processing_ms": 0.8649058939668118, "mean_inference_ms": 0.5379381867837169}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1311488, "num_steps_sampled": 1316000, "sample_time_ms": 14232.537, "load_time_ms": 9.268, "grad_time_ms": 2347.717, "update_time_ms": 2.879, "learner": {"default_policy": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 2.6685807704925537, "policy_loss": -1.1338553122186568e-05, "vf_loss": 2.6685919761657715, "vf_explained_var": -6.015147491211792e-09, "kl": 9.623578080208972e-05, "entropy": 0.9241649508476257, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1316000, "episodes_total": 375, "training_iteration": 47, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-32-58", "timestamp": 1714818778, "time_this_iter_s": 16.08617854118347, "time_total_s": 769.1189322471619, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 769.1189322471619, "timesteps_since_restore": 1316000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 44.26521739130435, "ram_util_percent": 48.37391304347827}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -169.96754675836928, "episode_reward_mean": -97.851185996228, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.462457977725526, "mean_processing_ms": 0.8650501161604472, "mean_inference_ms": 0.5379382418354061}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1339392, "num_steps_sampled": 1344000, "sample_time_ms": 14224.325, "load_time_ms": 9.423, "grad_time_ms": 2372.488, "update_time_ms": 2.883, "learner": {"default_policy": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 2.719784736633301, "policy_loss": -0.0001301843294641003, "vf_loss": 2.7199151515960693, "vf_explained_var": 8.202474255369907e-10, "kl": 0.0003133406862616539, "entropy": 0.9287341833114624, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1344000, "episodes_total": 383, "training_iteration": 48, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-33-14", "timestamp": 1714818794, "time_this_iter_s": 16.53791117668152, "time_total_s": 785.6568434238434, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 785.6568434238434, "timesteps_since_restore": 1344000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 42.875, "ram_util_percent": 48.383333333333326}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -98.71475877589072, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4617510517515, "mean_processing_ms": 0.8651365623815928, "mean_inference_ms": 0.5379237362735716}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1367296, "num_steps_sampled": 1372000, "sample_time_ms": 14043.258, "load_time_ms": 9.476, "grad_time_ms": 2400.663, "update_time_ms": 2.893, "learner": {"default_policy": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3213250637054443, "policy_loss": 0.0011805689428001642, "vf_loss": 2.3201444149017334, "vf_explained_var": -5.194900065674801e-09, "kl": 7.49279024603311e-06, "entropy": 0.9266757965087891, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1372000, "episodes_total": 391, "training_iteration": 49, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-33-31", "timestamp": 1714818811, "time_this_iter_s": 16.2970974445343, "time_total_s": 801.9539408683777, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 801.9539408683777, "timesteps_since_restore": 1372000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 44.026086956521745, "ram_util_percent": 48.34347826086956}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -99.03597642526918, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.461070998518652, "mean_processing_ms": 0.8651780744902855, "mean_inference_ms": 0.5379134541847135}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1395200, "num_steps_sampled": 1400000, "sample_time_ms": 14054.3, "load_time_ms": 9.737, "grad_time_ms": 2428.406, "update_time_ms": 2.927, "learner": {"default_policy": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 2.471790313720703, "policy_loss": -0.0004923861124552786, "vf_loss": 2.472282648086548, "vf_explained_var": -1.5311284684571547e-08, "kl": 0.0006095002754591405, "entropy": 0.9263410568237305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1400000, "episodes_total": 399, "training_iteration": 50, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-33-47", "timestamp": 1714818827, "time_this_iter_s": 16.554521083831787, "time_total_s": 818.5084619522095, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 818.5084619522095, "timesteps_since_restore": 1400000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 43.0875, "ram_util_percent": 48.4}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -101.42732747995919, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4604793237790803, "mean_processing_ms": 0.8651760158854038, "mean_inference_ms": 0.5379257648182003}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1423104, "num_steps_sampled": 1428000, "sample_time_ms": 13894.885, "load_time_ms": 9.655, "grad_time_ms": 2431.827, "update_time_ms": 2.958, "learner": {"default_policy": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 2.6283860206604004, "policy_loss": 6.562499038409442e-05, "vf_loss": 2.6283202171325684, "vf_explained_var": -1.0116385062985955e-08, "kl": 0.00015156602603383362, "entropy": 0.9208760857582092, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1428000, "episodes_total": 407, "training_iteration": 51, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-34-04", "timestamp": 1714818844, "time_this_iter_s": 16.624640464782715, "time_total_s": 835.1331024169922, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 835.1331024169922, "timesteps_since_restore": 1428000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 44.047826086956526, "ram_util_percent": 48.408695652173904}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -99.71119366159311, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.460986331061858, "mean_processing_ms": 0.8651679997973482, "mean_inference_ms": 0.5380111367601347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1451008, "num_steps_sampled": 1456000, "sample_time_ms": 13892.461, "load_time_ms": 9.656, "grad_time_ms": 2440.726, "update_time_ms": 3.048, "learner": {"default_policy": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 2.4947962760925293, "policy_loss": -0.0002982397563755512, "vf_loss": 2.4950942993164062, "vf_explained_var": -2.7341579000861316e-10, "kl": 0.00016094115562736988, "entropy": 0.9226324558258057, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1456000, "episodes_total": 415, "training_iteration": 52, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-34-20", "timestamp": 1714818860, "time_this_iter_s": 16.58101797103882, "time_total_s": 851.714120388031, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 851.714120388031, "timesteps_since_restore": 1456000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 42.925000000000004, "ram_util_percent": 48.40416666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -99.92956186578323, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.461672362614686, "mean_processing_ms": 0.8649789218945827, "mean_inference_ms": 0.5382132994328576}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1478912, "num_steps_sampled": 1484000, "sample_time_ms": 13903.962, "load_time_ms": 9.454, "grad_time_ms": 2459.677, "update_time_ms": 3.212, "learner": {"default_policy": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8674097061157227, "policy_loss": 0.00041291856905445457, "vf_loss": 2.8669965267181396, "vf_explained_var": -8.475890211911974e-09, "kl": 4.144424747209996e-05, "entropy": 0.925154447555542, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1484000, "episodes_total": 423, "training_iteration": 53, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-34-37", "timestamp": 1714818877, "time_this_iter_s": 16.479201078414917, "time_total_s": 868.1933214664459, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 868.1933214664459, "timesteps_since_restore": 1484000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 43.229166666666664, "ram_util_percent": 48.46666666666667}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -47.116902194812305, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -99.58263445717544, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4611552894229924, "mean_processing_ms": 0.864606831269165, "mean_inference_ms": 0.5382613596590955}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1506816, "num_steps_sampled": 1512000, "sample_time_ms": 13903.96, "load_time_ms": 9.448, "grad_time_ms": 2453.716, "update_time_ms": 2.959, "learner": {"default_policy": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 2.25345516204834, "policy_loss": -0.000807868258561939, "vf_loss": 2.254263162612915, "vf_explained_var": -9.022721236817688e-09, "kl": 0.00041151573532260954, "entropy": 0.9227908253669739, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1512000, "episodes_total": 431, "training_iteration": 54, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-34-53", "timestamp": 1714818893, "time_this_iter_s": 16.274521827697754, "time_total_s": 884.4678432941437, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 884.4678432941437, "timesteps_since_restore": 1512000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 43.75652173913044, "ram_util_percent": 48.4695652173913}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.522490434403316, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -99.10197607847978, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.460744119335506, "mean_processing_ms": 0.8643377593592255, "mean_inference_ms": 0.5383822630601138}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1534720, "num_steps_sampled": 1540000, "sample_time_ms": 13987.959, "load_time_ms": 9.561, "grad_time_ms": 2444.854, "update_time_ms": 2.888, "learner": {"default_policy": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 2.325363874435425, "policy_loss": -0.00023301001056097448, "vf_loss": 2.325596809387207, "vf_explained_var": -2.1873263200689053e-09, "kl": 3.574400761863217e-05, "entropy": 0.9181534051895142, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1540000, "episodes_total": 439, "training_iteration": 55, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-35-10", "timestamp": 1714818910, "time_this_iter_s": 16.83528709411621, "time_total_s": 901.3031303882599, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 901.3031303882599, "timesteps_since_restore": 1540000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 47.137499999999996, "ram_util_percent": 48.416666666666664}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -48.522490434403316, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -98.75544197465788, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.460414463907038, "mean_processing_ms": 0.8641018329956731, "mean_inference_ms": 0.5385453137395366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1562624, "num_steps_sampled": 1568000, "sample_time_ms": 14034.618, "load_time_ms": 9.437, "grad_time_ms": 2433.146, "update_time_ms": 2.915, "learner": {"default_policy": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 2.4410605430603027, "policy_loss": 0.0003776996163651347, "vf_loss": 2.440682888031006, "vf_explained_var": 2.7341579000861316e-10, "kl": 0.00012082886678399518, "entropy": 0.9148969650268555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1568000, "episodes_total": 447, "training_iteration": 56, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-35-27", "timestamp": 1714818927, "time_this_iter_s": 16.6172354221344, "time_total_s": 917.9203658103943, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 917.9203658103943, "timesteps_since_restore": 1568000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 45.45416666666667, "ram_util_percent": 47.9}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -50.82406531377138, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -99.0739453832376, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.460157200390809, "mean_processing_ms": 0.8639218520405183, "mean_inference_ms": 0.5387157447586342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1590528, "num_steps_sampled": 1596000, "sample_time_ms": 14076.497, "load_time_ms": 9.332, "grad_time_ms": 2462.299, "update_time_ms": 2.98, "learner": {"default_policy": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 3.106520891189575, "policy_loss": -0.0003609547857195139, "vf_loss": 3.106881856918335, "vf_explained_var": -8.202474255369907e-10, "kl": 0.0002420175151200965, "entropy": 0.9099758267402649, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1596000, "episodes_total": 455, "training_iteration": 57, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-35-43", "timestamp": 1714818943, "time_this_iter_s": 16.79845428466797, "time_total_s": 934.7188200950623, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 934.7188200950623, "timesteps_since_restore": 1596000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 43.93333333333334, "ram_util_percent": 47.72083333333333}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -50.82406531377138, "episode_reward_min": -194.80341195870366, "episode_reward_mean": -98.02334098275331, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.459923890722118, "mean_processing_ms": 0.8637688298082751, "mean_inference_ms": 0.5388721814368135}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1618432, "num_steps_sampled": 1624000, "sample_time_ms": 14077.246, "load_time_ms": 9.109, "grad_time_ms": 2437.468, "update_time_ms": 2.958, "learner": {"default_policy": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 3.468825101852417, "policy_loss": -0.0010313632665202022, "vf_loss": 3.4698565006256104, "vf_explained_var": -2.734158011108434e-09, "kl": 0.0005067489692009985, "entropy": 0.9203467965126038, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1624000, "episodes_total": 463, "training_iteration": 58, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-36-00", "timestamp": 1714818960, "time_this_iter_s": 16.294790506362915, "time_total_s": 951.0136106014252, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 951.0136106014252, "timesteps_since_restore": 1624000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 44.14782608695653, "ram_util_percent": 47.47826086956522}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -50.82406531377138, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -100.69966731707432, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.459697192442669, "mean_processing_ms": 0.8636631692019736, "mean_inference_ms": 0.5390382962290918}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1646336, "num_steps_sampled": 1652000, "sample_time_ms": 14089.848, "load_time_ms": 9.217, "grad_time_ms": 2421.62, "update_time_ms": 2.93, "learner": {"default_policy": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 2.967853307723999, "policy_loss": -0.00018621953495312482, "vf_loss": 2.9680395126342773, "vf_explained_var": -1.367079005554217e-09, "kl": 9.594378934707493e-05, "entropy": 0.9164862632751465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1652000, "episodes_total": 471, "training_iteration": 59, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-36-16", "timestamp": 1714818976, "time_this_iter_s": 16.26543092727661, "time_total_s": 967.2790415287018, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 967.2790415287018, "timesteps_since_restore": 1652000, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 44.2695652173913, "ram_util_percent": 47.46521739130434}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -50.82406531377138, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -100.412649252399, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.459453065882823, "mean_processing_ms": 0.8635668655403274, "mean_inference_ms": 0.5391972051061061}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1674240, "num_steps_sampled": 1680000, "sample_time_ms": 14068.371, "load_time_ms": 8.986, "grad_time_ms": 2397.405, "update_time_ms": 2.867, "learner": {"default_policy": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8188791275024414, "policy_loss": 0.00017379388737026602, "vf_loss": 2.8187053203582764, "vf_explained_var": -5.741731978758935e-09, "kl": 1.008832532534143e-05, "entropy": 0.9149615168571472, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1680000, "episodes_total": 479, "training_iteration": 60, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-36-32", "timestamp": 1714818992, "time_this_iter_s": 16.095113277435303, "time_total_s": 983.3741548061371, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 983.3741548061371, "timesteps_since_restore": 1680000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 43.77826086956521, "ram_util_percent": 47.48260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -51.91405183224212, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -100.32254939350321, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4592160235372047, "mean_processing_ms": 0.863487116017943, "mean_inference_ms": 0.5393532408573176}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1702144, "num_steps_sampled": 1708000, "sample_time_ms": 14051.123, "load_time_ms": 8.989, "grad_time_ms": 2363.163, "update_time_ms": 2.815, "learner": {"default_policy": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2778961658477783, "policy_loss": -0.0009248817223124206, "vf_loss": 3.2788209915161133, "vf_explained_var": -3.007573745605896e-09, "kl": 0.00036661684862338006, "entropy": 0.9156883358955383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1708000, "episodes_total": 487, "training_iteration": 61, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-36-48", "timestamp": 1714819008, "time_this_iter_s": 16.10570454597473, "time_total_s": 999.4798593521118, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 999.4798593521118, "timesteps_since_restore": 1708000, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 44.13913043478261, "ram_util_percent": 47.48260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -51.91405183224212, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -101.47978751052037, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.458988973382102, "mean_processing_ms": 0.8633763939768626, "mean_inference_ms": 0.5394981425004058}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1730048, "num_steps_sampled": 1736000, "sample_time_ms": 14039.459, "load_time_ms": 8.956, "grad_time_ms": 2330.278, "update_time_ms": 2.728, "learner": {"default_policy": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 2.4752790927886963, "policy_loss": -0.0008544085430912673, "vf_loss": 2.476133346557617, "vf_explained_var": -1.0116385062985955e-08, "kl": 0.0014232367975637317, "entropy": 0.9134107232093811, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1736000, "episodes_total": 495, "training_iteration": 62, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-37-04", "timestamp": 1714819024, "time_this_iter_s": 16.133179903030396, "time_total_s": 1015.6130392551422, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1015.6130392551422, "timesteps_since_restore": 1736000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 43.59565217391304, "ram_util_percent": 47.48260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -51.91405183224212, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -100.90744049138885, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.458726387225963, "mean_processing_ms": 0.8632778655900529, "mean_inference_ms": 0.5396273575259027}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1757952, "num_steps_sampled": 1764000, "sample_time_ms": 14031.272, "load_time_ms": 8.924, "grad_time_ms": 2299.268, "update_time_ms": 2.668, "learner": {"default_policy": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8995535373687744, "policy_loss": -2.0965524072380504e-06, "vf_loss": 2.8995556831359863, "vf_explained_var": -8.749305280275621e-09, "kl": 0.00029709789669141173, "entropy": 0.9104344248771667, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1764000, "episodes_total": 503, "training_iteration": 63, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-37-20", "timestamp": 1714819040, "time_this_iter_s": 16.086666584014893, "time_total_s": 1031.699705839157, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1031.699705839157, "timesteps_since_restore": 1764000, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 43.73478260869565, "ram_util_percent": 47.47826086956522}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -51.91405183224212, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -100.8885001446183, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4584431234793884, "mean_processing_ms": 0.8631584564797327, "mean_inference_ms": 0.5397465480911023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1785856, "num_steps_sampled": 1792000, "sample_time_ms": 14025.973, "load_time_ms": 8.864, "grad_time_ms": 2290.165, "update_time_ms": 2.678, "learner": {"default_policy": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 2.6147000789642334, "policy_loss": -0.00044625246664509177, "vf_loss": 2.6151461601257324, "vf_explained_var": -1.3123958808591851e-08, "kl": 5.936141678830609e-05, "entropy": 0.90925133228302, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1792000, "episodes_total": 511, "training_iteration": 64, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-37-37", "timestamp": 1714819057, "time_this_iter_s": 16.132861614227295, "time_total_s": 1047.8325674533844, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1047.8325674533844, "timesteps_since_restore": 1792000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 43.70434782608695, "ram_util_percent": 47.49565217391305}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.28861186800939, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -101.39677949439641, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4581669432417526, "mean_processing_ms": 0.8630565955096416, "mean_inference_ms": 0.5398693770413345}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1813760, "num_steps_sampled": 1820000, "sample_time_ms": 13959.541, "load_time_ms": 9.092, "grad_time_ms": 2295.947, "update_time_ms": 2.775, "learner": {"default_policy": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2884554862976074, "policy_loss": 0.0003059056762140244, "vf_loss": 3.28814959526062, "vf_explained_var": -8.749305280275621e-09, "kl": 0.0001120730594266206, "entropy": 0.9063593149185181, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1820000, "episodes_total": 519, "training_iteration": 65, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-37-53", "timestamp": 1714819073, "time_this_iter_s": 16.232964038848877, "time_total_s": 1064.0655314922333, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1064.0655314922333, "timesteps_since_restore": 1820000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 44.24347826086956, "ram_util_percent": 47.486956521739124}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.28861186800939, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -102.27619993137259, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.457895426543155, "mean_processing_ms": 0.8629453495752987, "mean_inference_ms": 0.5399959207051435}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1841664, "num_steps_sampled": 1848000, "sample_time_ms": 13914.545, "load_time_ms": 9.195, "grad_time_ms": 2295.299, "update_time_ms": 2.786, "learner": {"default_policy": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 3.12595272064209, "policy_loss": 0.0010088864946737885, "vf_loss": 3.124943733215332, "vf_explained_var": -1.9139106299803643e-08, "kl": 0.0002739627962000668, "entropy": 0.903655469417572, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1848000, "episodes_total": 527, "training_iteration": 66, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-38-09", "timestamp": 1714819089, "time_this_iter_s": 16.161967039108276, "time_total_s": 1080.2274985313416, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1080.2274985313416, "timesteps_since_restore": 1848000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 43.99999999999999, "ram_util_percent": 47.49130434782609}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.28861186800939, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -102.51997521618418, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.457559959419247, "mean_processing_ms": 0.8628432810666095, "mean_inference_ms": 0.540088162837799}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1869568, "num_steps_sampled": 1876000, "sample_time_ms": 13881.625, "load_time_ms": 9.204, "grad_time_ms": 2254.524, "update_time_ms": 2.694, "learner": {"default_policy": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 2.9450292587280273, "policy_loss": -0.0005603181198239326, "vf_loss": 2.945589780807495, "vf_explained_var": -6.561979404295926e-09, "kl": 0.0006088946829549968, "entropy": 0.9000279307365417, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1876000, "episodes_total": 535, "training_iteration": 67, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-38-25", "timestamp": 1714819105, "time_this_iter_s": 16.062679529190063, "time_total_s": 1096.2901780605316, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1096.2901780605316, "timesteps_since_restore": 1876000, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 43.9, "ram_util_percent": 47.460869565217386}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.28861186800939, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -103.02457433464399, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4571539747748776, "mean_processing_ms": 0.8627052899970249, "mean_inference_ms": 0.54013397212927}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1897472, "num_steps_sampled": 1904000, "sample_time_ms": 13882.559, "load_time_ms": 9.278, "grad_time_ms": 2283.602, "update_time_ms": 2.705, "learner": {"default_policy": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2632369995117188, "policy_loss": -0.0010968645801767707, "vf_loss": 3.264333963394165, "vf_explained_var": -8.202474255369907e-10, "kl": 0.0011163244489580393, "entropy": 0.9011233448982239, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1904000, "episodes_total": 543, "training_iteration": 68, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-38-42", "timestamp": 1714819122, "time_this_iter_s": 16.59673285484314, "time_total_s": 1112.8869109153748, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1112.8869109153748, "timesteps_since_restore": 1904000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.64166666666667, "ram_util_percent": 47.48333333333333}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.223740769035736, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -105.65025314309896, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4567111599648923, "mean_processing_ms": 0.8625838069470282, "mean_inference_ms": 0.540130577910858}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1925376, "num_steps_sampled": 1932000, "sample_time_ms": 13884.063, "load_time_ms": 9.061, "grad_time_ms": 2270.185, "update_time_ms": 2.701, "learner": {"default_policy": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 3.8494105339050293, "policy_loss": -0.00016931327991187572, "vf_loss": 3.8495798110961914, "vf_explained_var": -3.007573745605896e-09, "kl": 0.00037178650381974876, "entropy": 0.9035655856132507, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1932000, "episodes_total": 551, "training_iteration": 69, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-38-58", "timestamp": 1714819138, "time_this_iter_s": 16.141525506973267, "time_total_s": 1129.028436422348, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1129.028436422348, "timesteps_since_restore": 1932000, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 44.09565217391304, "ram_util_percent": 47.49565217391305}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.223740769035736, "episode_reward_min": -236.51382780016965, "episode_reward_mean": -105.78254882072717, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.456223115111549, "mean_processing_ms": 0.862433159745409, "mean_inference_ms": 0.540109174542363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1953280, "num_steps_sampled": 1960000, "sample_time_ms": 13893.211, "load_time_ms": 9.075, "grad_time_ms": 2283.877, "update_time_ms": 2.72, "learner": {"default_policy": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2734196186065674, "policy_loss": -0.0002455834473948926, "vf_loss": 3.273665189743042, "vf_explained_var": -2.734158011108434e-09, "kl": 0.0003498795267660171, "entropy": 0.9033928513526917, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1960000, "episodes_total": 559, "training_iteration": 70, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-39-14", "timestamp": 1714819154, "time_this_iter_s": 16.32399892807007, "time_total_s": 1145.352435350418, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1145.352435350418, "timesteps_since_restore": 1960000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 43.92173913043479, "ram_util_percent": 47.49565217391305}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.223740769035736, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -104.21007660925268, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4557387007715317, "mean_processing_ms": 0.8622938955239594, "mean_inference_ms": 0.5400903540093543}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1981184, "num_steps_sampled": 1988000, "sample_time_ms": 13899.227, "load_time_ms": 9.025, "grad_time_ms": 2303.727, "update_time_ms": 2.811, "learner": {"default_policy": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 2.7689735889434814, "policy_loss": -0.00019734441593755037, "vf_loss": 2.7691705226898193, "vf_explained_var": -1.148346395751787e-08, "kl": 0.0001666992757236585, "entropy": 0.90643310546875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1988000, "episodes_total": 567, "training_iteration": 71, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-39-30", "timestamp": 1714819170, "time_this_iter_s": 16.365804433822632, "time_total_s": 1161.7182397842407, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1161.7182397842407, "timesteps_since_restore": 1988000, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 43.1875, "ram_util_percent": 47.49166666666667}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.223740769035736, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -103.80937948077913, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4552961771228006, "mean_processing_ms": 0.8621360279558917, "mean_inference_ms": 0.5400780098850371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2009088, "num_steps_sampled": 2016000, "sample_time_ms": 13910.378, "load_time_ms": 9.029, "grad_time_ms": 2318.526, "update_time_ms": 2.811, "learner": {"default_policy": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 3.397430658340454, "policy_loss": 4.4309319491731e-05, "vf_loss": 3.3973865509033203, "vf_explained_var": -9.296137193359755e-09, "kl": 7.804681081324816e-05, "entropy": 0.9050372838973999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2016000, "episodes_total": 575, "training_iteration": 72, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-39-47", "timestamp": 1714819187, "time_this_iter_s": 16.39180278778076, "time_total_s": 1178.1100425720215, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1178.1100425720215, "timesteps_since_restore": 2016000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 44.173913043478265, "ram_util_percent": 47.49130434782609}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.53281948443817, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -102.64703717678967, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.454862767024872, "mean_processing_ms": 0.8619842110599589, "mean_inference_ms": 0.540074071567547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2036992, "num_steps_sampled": 2044000, "sample_time_ms": 13909.075, "load_time_ms": 9.047, "grad_time_ms": 2331.589, "update_time_ms": 2.715, "learner": {"default_policy": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 2.531406879425049, "policy_loss": -0.000707652885466814, "vf_loss": 2.532114028930664, "vf_explained_var": -6.561979404295926e-09, "kl": 0.000900549697689712, "entropy": 0.9004698395729065, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2044000, "episodes_total": 583, "training_iteration": 73, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-40-03", "timestamp": 1714819203, "time_this_iter_s": 16.20758080482483, "time_total_s": 1194.3176233768463, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1194.3176233768463, "timesteps_since_restore": 2044000, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 44.03043478260869, "ram_util_percent": 47.48260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -102.92710674031012, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.454469879028374, "mean_processing_ms": 0.8618338628210751, "mean_inference_ms": 0.5400816525969223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2064896, "num_steps_sampled": 2072000, "sample_time_ms": 13939.213, "load_time_ms": 9.191, "grad_time_ms": 2331.15, "update_time_ms": 2.705, "learner": {"default_policy": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 3.428452730178833, "policy_loss": -0.0003082711191382259, "vf_loss": 3.4287607669830322, "vf_explained_var": -5.468315800172263e-10, "kl": 4.681923383031972e-05, "entropy": 0.9020631313323975, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2072000, "episodes_total": 591, "training_iteration": 74, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-40-20", "timestamp": 1714819220, "time_this_iter_s": 16.428848266601562, "time_total_s": 1210.7464716434479, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1210.7464716434479, "timesteps_since_restore": 2072000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 42.62916666666667, "ram_util_percent": 47.49583333333334}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -103.96819346094239, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4541153807105744, "mean_processing_ms": 0.8617170993318544, "mean_inference_ms": 0.5400909674998823}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2092800, "num_steps_sampled": 2100000, "sample_time_ms": 13937.127, "load_time_ms": 8.909, "grad_time_ms": 2338.236, "update_time_ms": 2.624, "learner": {"default_policy": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 3.7171261310577393, "policy_loss": -0.0005109689082019031, "vf_loss": 3.717637062072754, "vf_explained_var": -1.0116385062985955e-08, "kl": 0.00034710977342911065, "entropy": 0.9036845564842224, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2100000, "episodes_total": 599, "training_iteration": 75, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-40-36", "timestamp": 1714819236, "time_this_iter_s": 16.27901291847229, "time_total_s": 1227.0254845619202, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1227.0254845619202, "timesteps_since_restore": 2100000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 44.34347826086957, "ram_util_percent": 47.5391304347826}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -104.23397787874333, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4538082637922085, "mean_processing_ms": 0.861589802467658, "mean_inference_ms": 0.5401124634865971}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2120704, "num_steps_sampled": 2128000, "sample_time_ms": 13935.283, "load_time_ms": 8.828, "grad_time_ms": 2325.61, "update_time_ms": 2.6, "learner": {"default_policy": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 3.1105687618255615, "policy_loss": -9.952360414899886e-06, "vf_loss": 3.1105782985687256, "vf_explained_var": -7.1088108732908495e-09, "kl": 9.720601519802585e-05, "entropy": 0.9082982540130615, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2128000, "episodes_total": 607, "training_iteration": 76, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-40-52", "timestamp": 1714819252, "time_this_iter_s": 16.02024555206299, "time_total_s": 1243.0457301139832, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1243.0457301139832, "timesteps_since_restore": 2128000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 44.00869565217391, "ram_util_percent": 47.560869565217395}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -211.1592811565803, "episode_reward_mean": -104.69459838628019, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.453553258491641, "mean_processing_ms": 0.8614626972390275, "mean_inference_ms": 0.5401561024790487}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2148608, "num_steps_sampled": 2156000, "sample_time_ms": 13958.805, "load_time_ms": 8.825, "grad_time_ms": 2331.821, "update_time_ms": 2.595, "learner": {"default_policy": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 3.7544007301330566, "policy_loss": 0.00013824886991642416, "vf_loss": 3.7542624473571777, "vf_explained_var": 3.827821171142887e-09, "kl": 0.0004994454211555421, "entropy": 0.9055914878845215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2156000, "episodes_total": 615, "training_iteration": 77, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-41-08", "timestamp": 1714819268, "time_this_iter_s": 16.355510711669922, "time_total_s": 1259.401240825653, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1259.401240825653, "timesteps_since_restore": 2156000, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 44.39130434782609, "ram_util_percent": 47.53043478260869}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -107.34758912351005, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.453349098880189, "mean_processing_ms": 0.8613221439681835, "mean_inference_ms": 0.5401996586649678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2176512, "num_steps_sampled": 2184000, "sample_time_ms": 13985.64, "load_time_ms": 8.85, "grad_time_ms": 2305.948, "update_time_ms": 2.602, "learner": {"default_policy": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 4.625533103942871, "policy_loss": -0.00024209929688367993, "vf_loss": 4.625775337219238, "vf_explained_var": -4.648068596679877e-09, "kl": 7.759243453620002e-05, "entropy": 0.9061505794525146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2184000, "episodes_total": 623, "training_iteration": 78, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-41-25", "timestamp": 1714819285, "time_this_iter_s": 16.60402536392212, "time_total_s": 1276.0052661895752, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1276.0052661895752, "timesteps_since_restore": 2184000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 43.15, "ram_util_percent": 47.57500000000001}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -108.38543002553024, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4531904070889015, "mean_processing_ms": 0.8611807537112702, "mean_inference_ms": 0.5402418385508887}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2204416, "num_steps_sampled": 2212000, "sample_time_ms": 13991.213, "load_time_ms": 8.897, "grad_time_ms": 2309.606, "update_time_ms": 2.607, "learner": {"default_policy": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 3.4583981037139893, "policy_loss": -9.528130613034591e-05, "vf_loss": 3.458493232727051, "vf_explained_var": 3.5544054366454247e-09, "kl": 1.988181065826211e-05, "entropy": 0.907137393951416, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2212000, "episodes_total": 631, "training_iteration": 79, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-41-41", "timestamp": 1714819301, "time_this_iter_s": 16.236865758895874, "time_total_s": 1292.242131948471, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1292.242131948471, "timesteps_since_restore": 2212000, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 44.234782608695646, "ram_util_percent": 47.56521739130435}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -106.90917240158382, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.453012805142018, "mean_processing_ms": 0.8610136754771212, "mean_inference_ms": 0.5402638590484612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2232320, "num_steps_sampled": 2240000, "sample_time_ms": 13980.729, "load_time_ms": 8.897, "grad_time_ms": 2295.239, "update_time_ms": 2.813, "learner": {"default_policy": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8372557163238525, "policy_loss": -0.0008824989199638367, "vf_loss": 2.8381378650665283, "vf_explained_var": 8.202474255369907e-09, "kl": 0.000994766829535365, "entropy": 0.9047329425811768, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2240000, "episodes_total": 639, "training_iteration": 80, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-41-57", "timestamp": 1714819317, "time_this_iter_s": 16.07620596885681, "time_total_s": 1308.3183379173279, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1308.3183379173279, "timesteps_since_restore": 2240000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 43.57391304347826, "ram_util_percent": 47.56086956521739}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -107.53046122545351, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4528621687214187, "mean_processing_ms": 0.8608647489290776, "mean_inference_ms": 0.5402835417804798}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2260224, "num_steps_sampled": 2268000, "sample_time_ms": 13994.519, "load_time_ms": 8.883, "grad_time_ms": 2281.715, "update_time_ms": 2.746, "learner": {"default_policy": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 4.141293525695801, "policy_loss": 0.00021772400941699743, "vf_loss": 4.141075611114502, "vf_explained_var": -6.561979404295926e-09, "kl": 2.5515577362966724e-05, "entropy": 0.9052032828330994, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2268000, "episodes_total": 647, "training_iteration": 81, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-42-14", "timestamp": 1714819334, "time_this_iter_s": 16.368749618530273, "time_total_s": 1324.6870875358582, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1324.6870875358582, "timesteps_since_restore": 2268000, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 44.38260869565217, "ram_util_percent": 47.582608695652176}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -107.75352742793001, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4527261509798435, "mean_processing_ms": 0.8607082083451764, "mean_inference_ms": 0.5403037241706228}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2288128, "num_steps_sampled": 2296000, "sample_time_ms": 14001.429, "load_time_ms": 8.882, "grad_time_ms": 2263.737, "update_time_ms": 2.766, "learner": {"default_policy": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 4.014981269836426, "policy_loss": 4.2223739001201466e-05, "vf_loss": 4.014938831329346, "vf_explained_var": -4.1012371276849535e-09, "kl": 3.382767681614496e-05, "entropy": 0.9065284132957458, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2296000, "episodes_total": 655, "training_iteration": 82, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-42-30", "timestamp": 1714819350, "time_this_iter_s": 16.28122639656067, "time_total_s": 1340.9683139324188, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1340.9683139324188, "timesteps_since_restore": 2296000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 43.908695652173904, "ram_util_percent": 47.58695652173913}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -106.87535575564807, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.452587780931418, "mean_processing_ms": 0.8605509979954397, "mean_inference_ms": 0.5403215350054567}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2316032, "num_steps_sampled": 2324000, "sample_time_ms": 14009.999, "load_time_ms": 8.854, "grad_time_ms": 2250.402, "update_time_ms": 2.778, "learner": {"default_policy": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 2.5840201377868652, "policy_loss": -0.0004810160316992551, "vf_loss": 2.584501266479492, "vf_explained_var": -7.655642342285773e-09, "kl": 0.0003283088735770434, "entropy": 0.9119265675544739, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2324000, "episodes_total": 663, "training_iteration": 83, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-42-46", "timestamp": 1714819366, "time_this_iter_s": 16.15473198890686, "time_total_s": 1357.1230459213257, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1357.1230459213257, "timesteps_since_restore": 2324000, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 42.5, "ram_util_percent": 47.5875}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -104.97876272692767, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.452451280468481, "mean_processing_ms": 0.8603714554516373, "mean_inference_ms": 0.5403338948149952}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2343936, "num_steps_sampled": 2352000, "sample_time_ms": 13995.32, "load_time_ms": 8.726, "grad_time_ms": 2255.315, "update_time_ms": 2.767, "learner": {"default_policy": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3.5129871368408203, "policy_loss": -0.0003335362416692078, "vf_loss": 3.5133204460144043, "vf_explained_var": 2.734158011108434e-09, "kl": 0.00013471020793076605, "entropy": 0.9126140475273132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2352000, "episodes_total": 671, "training_iteration": 84, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-43-02", "timestamp": 1714819382, "time_this_iter_s": 16.330352306365967, "time_total_s": 1373.4533982276917, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1373.4533982276917, "timesteps_since_restore": 2352000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 43.80434782608695, "ram_util_percent": 47.58695652173913}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -105.36793200520698, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.452311309354863, "mean_processing_ms": 0.8602148542515384, "mean_inference_ms": 0.5403428001690217}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2371840, "num_steps_sampled": 2380000, "sample_time_ms": 13999.62, "load_time_ms": 8.624, "grad_time_ms": 2243.987, "update_time_ms": 2.754, "learner": {"default_policy": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3.053860902786255, "policy_loss": -0.0005568701890297234, "vf_loss": 3.054417610168457, "vf_explained_var": -1.2030294982423584e-08, "kl": 5.951952334726229e-05, "entropy": 0.9138609170913696, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2380000, "episodes_total": 679, "training_iteration": 85, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-43-19", "timestamp": 1714819399, "time_this_iter_s": 16.205720901489258, "time_total_s": 1389.659119129181, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1389.659119129181, "timesteps_since_restore": 2380000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 44.1, "ram_util_percent": 47.58260869565217}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.19003607159978, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -106.79835687074397, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4521722910366237, "mean_processing_ms": 0.860056616203559, "mean_inference_ms": 0.5403469704292615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2399744, "num_steps_sampled": 2408000, "sample_time_ms": 14016.553, "load_time_ms": 8.794, "grad_time_ms": 2262.4, "update_time_ms": 2.847, "learner": {"default_policy": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3.5035622119903564, "policy_loss": -0.0007145019480958581, "vf_loss": 3.504276990890503, "vf_explained_var": -1.4491037703123766e-08, "kl": 9.961464093066752e-05, "entropy": 0.9205368757247925, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2408000, "episodes_total": 687, "training_iteration": 86, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-43-35", "timestamp": 1714819415, "time_this_iter_s": 16.373817920684814, "time_total_s": 1406.0329370498657, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1406.0329370498657, "timesteps_since_restore": 2408000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 43.83478260869565, "ram_util_percent": 47.58695652173913}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.30411194241006, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -105.73506728260595, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4520311551557485, "mean_processing_ms": 0.859922397286804, "mean_inference_ms": 0.5403558304983225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2427648, "num_steps_sampled": 2436000, "sample_time_ms": 14000.312, "load_time_ms": 8.893, "grad_time_ms": 2296.405, "update_time_ms": 2.869, "learner": {"default_policy": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 3.350945472717285, "policy_loss": -8.425198757322505e-05, "vf_loss": 3.351029634475708, "vf_explained_var": -3.007573745605896e-09, "kl": 1.9903003703802824e-05, "entropy": 0.9185642600059509, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2436000, "episodes_total": 695, "training_iteration": 87, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-43-51", "timestamp": 1714819431, "time_this_iter_s": 16.53627896308899, "time_total_s": 1422.5692160129547, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1422.5692160129547, "timesteps_since_restore": 2436000, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 43.15416666666666, "ram_util_percent": 47.5875}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -55.30411194241006, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -105.57039015919608, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4519043631930417, "mean_processing_ms": 0.8597707139818638, "mean_inference_ms": 0.5403815808592082}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2455552, "num_steps_sampled": 2464000, "sample_time_ms": 13973.579, "load_time_ms": 8.851, "grad_time_ms": 2331.523, "update_time_ms": 2.875, "learner": {"default_policy": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 4.080970764160156, "policy_loss": 7.195182843133807e-05, "vf_loss": 4.080899238586426, "vf_explained_var": -1.0936632044433736e-08, "kl": 1.995518323383294e-05, "entropy": 0.9203144311904907, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2464000, "episodes_total": 703, "training_iteration": 88, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-44-08", "timestamp": 1714819448, "time_this_iter_s": 16.69225788116455, "time_total_s": 1439.2614738941193, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1439.2614738941193, "timesteps_since_restore": 2464000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 43.179166666666674, "ram_util_percent": 47.59583333333334}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.42254723518681, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -106.67169110139983, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.451799047253624, "mean_processing_ms": 0.8596438669565984, "mean_inference_ms": 0.5404053983102081}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2483456, "num_steps_sampled": 2492000, "sample_time_ms": 13968.011, "load_time_ms": 8.839, "grad_time_ms": 2351.192, "update_time_ms": 2.965, "learner": {"default_policy": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 3.6247811317443848, "policy_loss": -0.000821332389023155, "vf_loss": 3.6256024837493896, "vf_explained_var": 6.288563447753859e-09, "kl": 2.1243864466669038e-05, "entropy": 0.9191812872886658, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2492000, "episodes_total": 711, "training_iteration": 89, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-44-25", "timestamp": 1714819465, "time_this_iter_s": 16.377213716506958, "time_total_s": 1455.6386876106262, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1455.6386876106262, "timesteps_since_restore": 2492000, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 44.46521739130434, "ram_util_percent": 47.58695652173913}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.42254723518681, "episode_reward_min": -221.31857376885372, "episode_reward_mean": -105.61750203628522, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.451680904831635, "mean_processing_ms": 0.8594932698426294, "mean_inference_ms": 0.5404214469078835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2511360, "num_steps_sampled": 2520000, "sample_time_ms": 13986.241, "load_time_ms": 8.797, "grad_time_ms": 2343.731, "update_time_ms": 2.803, "learner": {"default_policy": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 3.40079402923584, "policy_loss": -0.00019796329434029758, "vf_loss": 3.400991916656494, "vf_explained_var": -4.3746526401378105e-09, "kl": 0.0003537691954988986, "entropy": 0.918502151966095, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2520000, "episodes_total": 719, "training_iteration": 90, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-44-41", "timestamp": 1714819481, "time_this_iter_s": 16.183103799819946, "time_total_s": 1471.8217914104462, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1471.8217914104462, "timesteps_since_restore": 2520000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 44.03043478260869, "ram_util_percent": 47.59130434782608}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -54.42254723518681, "episode_reward_min": -160.63310539134486, "episode_reward_mean": -102.06973996315017, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.45150593376569, "mean_processing_ms": 0.8593460884381462, "mean_inference_ms": 0.5404289045037155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2539264, "num_steps_sampled": 2548000, "sample_time_ms": 13961.42, "load_time_ms": 8.863, "grad_time_ms": 2357.688, "update_time_ms": 2.97, "learner": {"default_policy": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 2.9768564701080322, "policy_loss": -0.0007475417805835605, "vf_loss": 2.9776039123535156, "vf_explained_var": -9.842969106443888e-09, "kl": 0.001721894252113998, "entropy": 0.9123602509498596, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2548000, "episodes_total": 727, "training_iteration": 91, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-44-57", "timestamp": 1714819497, "time_this_iter_s": 16.25967288017273, "time_total_s": 1488.081464290619, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1488.081464290619, "timesteps_since_restore": 2548000, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 43.79565217391305, "ram_util_percent": 47.591304347826096}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -164.95344756894403, "episode_reward_mean": -101.37133359470785, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4513703779612857, "mean_processing_ms": 0.8591995042351205, "mean_inference_ms": 0.5404461840566885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2567168, "num_steps_sampled": 2576000, "sample_time_ms": 13957.253, "load_time_ms": 8.944, "grad_time_ms": 2390.24, "update_time_ms": 3.154, "learner": {"default_policy": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 3.716949224472046, "policy_loss": -0.0002095803210977465, "vf_loss": 3.7171592712402344, "vf_explained_var": -1.1210048000975803e-08, "kl": 0.0002973234513774514, "entropy": 0.9107383489608765, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2576000, "episodes_total": 735, "training_iteration": 92, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-45-14", "timestamp": 1714819514, "time_this_iter_s": 16.568346738815308, "time_total_s": 1504.6498110294342, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1504.6498110294342, "timesteps_since_restore": 2576000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 43.25416666666666, "ram_util_percent": 47.612500000000004}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -101.69576482566292, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.451245197020582, "mean_processing_ms": 0.8590661317706938, "mean_inference_ms": 0.5404760384054424}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595072, "num_steps_sampled": 2604000, "sample_time_ms": 13961.936, "load_time_ms": 8.973, "grad_time_ms": 2414.304, "update_time_ms": 3.347, "learner": {"default_policy": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3.479620933532715, "policy_loss": 0.0005181643064133823, "vf_loss": 3.4791030883789062, "vf_explained_var": -8.475890211911974e-09, "kl": 5.647618672810495e-05, "entropy": 0.9042075872421265, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2604000, "episodes_total": 743, "training_iteration": 93, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-45-30", "timestamp": 1714819530, "time_this_iter_s": 16.446491241455078, "time_total_s": 1521.0963022708893, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1521.0963022708893, "timesteps_since_restore": 2604000, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 43.208333333333336, "ram_util_percent": 47.583333333333336}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -101.40120863702025, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4511242986239012, "mean_processing_ms": 0.8589035772356813, "mean_inference_ms": 0.5405114669723031}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2622976, "num_steps_sampled": 2632000, "sample_time_ms": 13959.238, "load_time_ms": 9.016, "grad_time_ms": 2432.148, "update_time_ms": 3.375, "learner": {"default_policy": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3.216658115386963, "policy_loss": -0.00011578584962990135, "vf_loss": 3.2167739868164062, "vf_explained_var": -5.741731978758935e-09, "kl": 5.1528240874176845e-05, "entropy": 0.9061958193778992, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2632000, "episodes_total": 751, "training_iteration": 94, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-45-47", "timestamp": 1714819547, "time_this_iter_s": 16.486409664154053, "time_total_s": 1537.5827119350433, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1537.5827119350433, "timesteps_since_restore": 2632000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 44.17826086956521, "ram_util_percent": 47.58695652173913}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -100.86817501768122, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4510243749245877, "mean_processing_ms": 0.8587525161095502, "mean_inference_ms": 0.5405575757169678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2650880, "num_steps_sampled": 2660000, "sample_time_ms": 13966.805, "load_time_ms": 9.236, "grad_time_ms": 2445.692, "update_time_ms": 3.521, "learner": {"default_policy": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3.1517698764801025, "policy_loss": 0.0002012083277804777, "vf_loss": 3.15156888961792, "vf_explained_var": -9.296137193359755e-09, "kl": 0.00012163793871877715, "entropy": 0.9003326892852783, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2660000, "episodes_total": 759, "training_iteration": 95, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-46-03", "timestamp": 1714819563, "time_this_iter_s": 16.421921968460083, "time_total_s": 1554.0046339035034, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1554.0046339035034, "timesteps_since_restore": 2660000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 43.025, "ram_util_percent": 47.5875}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -102.49823541262687, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4509746207872705, "mean_processing_ms": 0.8585886052936971, "mean_inference_ms": 0.5406168332654271}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2678784, "num_steps_sampled": 2688000, "sample_time_ms": 13971.298, "load_time_ms": 9.032, "grad_time_ms": 2462.745, "update_time_ms": 3.416, "learner": {"default_policy": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3.7546958923339844, "policy_loss": -0.001006561447866261, "vf_loss": 3.755702495574951, "vf_explained_var": -7.655642342285773e-09, "kl": 0.0024304657708853483, "entropy": 0.896375298500061, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2688000, "episodes_total": 767, "training_iteration": 96, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-46-20", "timestamp": 1714819580, "time_this_iter_s": 16.585540294647217, "time_total_s": 1570.5901741981506, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1570.5901741981506, "timesteps_since_restore": 2688000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 44.23913043478261, "ram_util_percent": 47.59130434782608}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -102.30196310623519, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4509482896563703, "mean_processing_ms": 0.8584481062171028, "mean_inference_ms": 0.5406900143456537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2706688, "num_steps_sampled": 2716000, "sample_time_ms": 13973.66, "load_time_ms": 9.088, "grad_time_ms": 2462.668, "update_time_ms": 3.424, "learner": {"default_policy": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 3.30055570602417, "policy_loss": 0.0001864526275312528, "vf_loss": 3.3003690242767334, "vf_explained_var": 1.0936631600344526e-09, "kl": 0.00018039859423879534, "entropy": 0.8896445035934448, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2716000, "episodes_total": 775, "training_iteration": 97, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-46-36", "timestamp": 1714819596, "time_this_iter_s": 16.558048963546753, "time_total_s": 1587.1482231616974, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1587.1482231616974, "timesteps_since_restore": 2716000, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 43.520833333333336, "ram_util_percent": 47.59166666666667}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -101.43830883304878, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4509656827507302, "mean_processing_ms": 0.8583169707119189, "mean_inference_ms": 0.5407840824486104}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2734592, "num_steps_sampled": 2744000, "sample_time_ms": 13989.992, "load_time_ms": 9.136, "grad_time_ms": 2437.207, "update_time_ms": 3.405, "learner": {"default_policy": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 3.271406650543213, "policy_loss": 0.00029606776661239564, "vf_loss": 3.2711102962493896, "vf_explained_var": -9.569553149901822e-09, "kl": 0.00019846876966767013, "entropy": 0.8811661005020142, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2744000, "episodes_total": 783, "training_iteration": 98, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-46-53", "timestamp": 1714819613, "time_this_iter_s": 16.600141525268555, "time_total_s": 1603.748364686966, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1603.748364686966, "timesteps_since_restore": 2744000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 45.49583333333334, "ram_util_percent": 47.875}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -102.43114023277214, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4510721834928635, "mean_processing_ms": 0.8581960893439299, "mean_inference_ms": 0.5409260735834177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2762496, "num_steps_sampled": 2772000, "sample_time_ms": 14045.513, "load_time_ms": 9.128, "grad_time_ms": 2448.751, "update_time_ms": 3.369, "learner": {"default_policy": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 3.3069746494293213, "policy_loss": -0.0007395711727440357, "vf_loss": 3.3077139854431152, "vf_explained_var": -2.460742276610972e-09, "kl": 0.0011847098357975483, "entropy": 0.8794460296630859, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2772000, "episodes_total": 791, "training_iteration": 99, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-47-10", "timestamp": 1714819630, "time_this_iter_s": 17.04770565032959, "time_total_s": 1620.7960703372955, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1620.7960703372955, "timesteps_since_restore": 2772000, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 45.97083333333333, "ram_util_percent": 48.675000000000004}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -103.3258904272372, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4512356394837957, "mean_processing_ms": 0.8580567159022918, "mean_inference_ms": 0.5410911780221398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2790400, "num_steps_sampled": 2800000, "sample_time_ms": 14090.461, "load_time_ms": 9.159, "grad_time_ms": 2490.197, "update_time_ms": 3.355, "learner": {"default_policy": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 3.832608461380005, "policy_loss": 0.001017423695884645, "vf_loss": 3.8315911293029785, "vf_explained_var": -1.0936631600344526e-09, "kl": 3.067026409553364e-05, "entropy": 0.8782472014427185, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2800000, "episodes_total": 799, "training_iteration": 100, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-47-27", "timestamp": 1714819647, "time_this_iter_s": 17.04980182647705, "time_total_s": 1637.8458721637726, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1637.8458721637726, "timesteps_since_restore": 2800000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 44.775, "ram_util_percent": 48.11666666666667}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -198.47790519938013, "episode_reward_mean": -102.46368011307595, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.451415093219323, "mean_processing_ms": 0.857914467980919, "mean_inference_ms": 0.5412487985533794}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2818304, "num_steps_sampled": 2828000, "sample_time_ms": 14116.241, "load_time_ms": 9.095, "grad_time_ms": 2502.329, "update_time_ms": 3.191, "learner": {"default_policy": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 4.168698787689209, "policy_loss": -0.000260646193055436, "vf_loss": 4.168959140777588, "vf_explained_var": -1.9139105855714433e-09, "kl": 0.00018377279047854245, "entropy": 0.8767560720443726, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2828000, "episodes_total": 807, "training_iteration": 101, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-47-44", "timestamp": 1714819664, "time_this_iter_s": 16.64087438583374, "time_total_s": 1654.4867465496063, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1654.4867465496063, "timesteps_since_restore": 2828000, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 43.29999999999999, "ram_util_percent": 47.89166666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -105.4529812533101, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4516166104782315, "mean_processing_ms": 0.8577456190175587, "mean_inference_ms": 0.5414042800162344}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2846208, "num_steps_sampled": 2856000, "sample_time_ms": 14143.26, "load_time_ms": 8.984, "grad_time_ms": 2502.01, "update_time_ms": 2.977, "learner": {"default_policy": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 4.5580949783325195, "policy_loss": -0.00023583076836075634, "vf_loss": 4.558330535888672, "vf_explained_var": -5.194900065674801e-09, "kl": 0.0006617734907194972, "entropy": 0.8857101202011108, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2856000, "episodes_total": 815, "training_iteration": 102, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-48-00", "timestamp": 1714819680, "time_this_iter_s": 16.832118272781372, "time_total_s": 1671.3188648223877, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1671.3188648223877, "timesteps_since_restore": 2856000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 42.95416666666667, "ram_util_percent": 47.89166666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -105.31578102656748, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.451836667833382, "mean_processing_ms": 0.8575936823377731, "mean_inference_ms": 0.5415689172441861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2874112, "num_steps_sampled": 2884000, "sample_time_ms": 14153.435, "load_time_ms": 8.935, "grad_time_ms": 2480.9, "update_time_ms": 2.767, "learner": {"default_policy": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 3.352908134460449, "policy_loss": 0.00016890534607227892, "vf_loss": 3.3527393341064453, "vf_explained_var": -4.648068596679877e-09, "kl": 0.0001270002539968118, "entropy": 0.8857685327529907, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2884000, "episodes_total": 823, "training_iteration": 103, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-48-17", "timestamp": 1714819697, "time_this_iter_s": 16.333150148391724, "time_total_s": 1687.6520149707794, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1687.6520149707794, "timesteps_since_restore": 2884000, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 44.369565217391305, "ram_util_percent": 47.94782608695652}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -53.160649860975475, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -105.64136763965342, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4520693286748263, "mean_processing_ms": 0.8574156184916574, "mean_inference_ms": 0.5417339668427448}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2902016, "num_steps_sampled": 2912000, "sample_time_ms": 14162.355, "load_time_ms": 9.329, "grad_time_ms": 2463.571, "update_time_ms": 2.787, "learner": {"default_policy": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 3.3691091537475586, "policy_loss": -0.0002338405029149726, "vf_loss": 3.3693432807922363, "vf_explained_var": -1.6404948510739814e-09, "kl": 6.551369733642787e-05, "entropy": 0.8928186297416687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2912000, "episodes_total": 831, "training_iteration": 104, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-48-33", "timestamp": 1714819713, "time_this_iter_s": 16.40208077430725, "time_total_s": 1704.0540957450867, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1704.0540957450867, "timesteps_since_restore": 2912000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 42.574999999999996, "ram_util_percent": 47.895833333333336}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -56.81013265544257, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -106.1517046830797, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4523271798616944, "mean_processing_ms": 0.8572564261448022, "mean_inference_ms": 0.5418952484563949}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2929920, "num_steps_sampled": 2940000, "sample_time_ms": 14164.927, "load_time_ms": 9.205, "grad_time_ms": 2476.7, "update_time_ms": 2.644, "learner": {"default_policy": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 4.473842620849609, "policy_loss": -0.0005065022269263864, "vf_loss": 4.474349498748779, "vf_explained_var": -8.475890211911974e-09, "kl": 3.639182250481099e-05, "entropy": 0.8970990777015686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2940000, "episodes_total": 839, "training_iteration": 105, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-48-50", "timestamp": 1714819730, "time_this_iter_s": 16.576359033584595, "time_total_s": 1720.6304547786713, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1720.6304547786713, "timesteps_since_restore": 2940000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 44.57826086956521, "ram_util_percent": 47.92173913043477}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -51.16644670688862, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -105.77000758238191, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.452580229917262, "mean_processing_ms": 0.8570862496412165, "mean_inference_ms": 0.5420509090149794}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2957824, "num_steps_sampled": 2968000, "sample_time_ms": 14170.103, "load_time_ms": 9.251, "grad_time_ms": 2455.745, "update_time_ms": 2.66, "learner": {"default_policy": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3.390285015106201, "policy_loss": 0.00031120461062528193, "vf_loss": 3.3899741172790527, "vf_explained_var": -1.1210048000975803e-08, "kl": 0.0003280291857663542, "entropy": 0.8923327922821045, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2968000, "episodes_total": 847, "training_iteration": 106, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-49-06", "timestamp": 1714819746, "time_this_iter_s": 16.428587913513184, "time_total_s": 1737.0590426921844, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1737.0590426921844, "timesteps_since_restore": 2968000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 43.11666666666667, "ram_util_percent": 47.975}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -51.16644670688862, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -106.80106555470712, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.452904515477475, "mean_processing_ms": 0.8569443621544386, "mean_inference_ms": 0.5422394293016377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2985728, "num_steps_sampled": 2996000, "sample_time_ms": 14225.215, "load_time_ms": 9.137, "grad_time_ms": 2412.168, "update_time_ms": 2.664, "learner": {"default_policy": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3.718003034591675, "policy_loss": 0.0003355238295625895, "vf_loss": 3.717667579650879, "vf_explained_var": -3.827821171142887e-09, "kl": 7.982354873092845e-05, "entropy": 0.8958824276924133, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 2996000, "episodes_total": 855, "training_iteration": 107, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-49-23", "timestamp": 1714819763, "time_this_iter_s": 16.672996520996094, "time_total_s": 1753.7320392131805, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1753.7320392131805, "timesteps_since_restore": 2996000, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 45.900000000000006, "ram_util_percent": 48.00416666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -46.67791463438586, "episode_reward_min": -241.1181768635576, "episode_reward_mean": -106.1205626065287, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4532894919308483, "mean_processing_ms": 0.856841628996995, "mean_inference_ms": 0.5424495621960622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3013632, "num_steps_sampled": 3024000, "sample_time_ms": 14263.568, "load_time_ms": 9.37, "grad_time_ms": 2419.758, "update_time_ms": 2.689, "learner": {"default_policy": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 4.287396430969238, "policy_loss": -0.001016549882479012, "vf_loss": 4.288413047790527, "vf_explained_var": -1.4491037703123766e-08, "kl": 0.00010458244651090354, "entropy": 0.9051787257194519, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 3024000, "episodes_total": 863, "training_iteration": 108, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-49-40", "timestamp": 1714819780, "time_this_iter_s": 17.06070637702942, "time_total_s": 1770.79274559021, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1770.79274559021, "timesteps_since_restore": 3024000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 47.512499999999996, "ram_util_percent": 48.31666666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -46.67791463438586, "episode_reward_min": -250.8999456090913, "episode_reward_mean": -107.31910330357678, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4537049934305273, "mean_processing_ms": 0.8567628731140922, "mean_inference_ms": 0.5426747426009588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3041536, "num_steps_sampled": 3052000, "sample_time_ms": 14242.751, "load_time_ms": 9.408, "grad_time_ms": 2422.232, "update_time_ms": 2.792, "learner": {"default_policy": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3.182953119277954, "policy_loss": -3.200988066964783e-05, "vf_loss": 3.1829850673675537, "vf_explained_var": -4.1012371276849535e-09, "kl": 0.00015399249969050288, "entropy": 0.8988218903541565, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 3052000, "episodes_total": 871, "training_iteration": 109, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-49-57", "timestamp": 1714819797, "time_this_iter_s": 16.866279363632202, "time_total_s": 1787.6590249538422, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1787.6590249538422, "timesteps_since_restore": 3052000, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 44.7875, "ram_util_percent": 48.89166666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -46.67791463438586, "episode_reward_min": -250.8999456090913, "episode_reward_mean": -107.24771773945055, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4541157499670208, "mean_processing_ms": 0.8566699654966504, "mean_inference_ms": 0.5429016324163309}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3069440, "num_steps_sampled": 3080000, "sample_time_ms": 14220.348, "load_time_ms": 9.464, "grad_time_ms": 2414.998, "update_time_ms": 2.779, "learner": {"default_policy": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 3.276024580001831, "policy_loss": -1.2926689123560209e-05, "vf_loss": 3.2760369777679443, "vf_explained_var": 1.0936631600344526e-09, "kl": 6.945263157831505e-05, "entropy": 0.8963931202888489, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 3080000, "episodes_total": 879, "training_iteration": 110, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-50-14", "timestamp": 1714819814, "time_this_iter_s": 16.75310730934143, "time_total_s": 1804.4121322631836, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1804.4121322631836, "timesteps_since_restore": 3080000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 44.07083333333333, "ram_util_percent": 48.89166666666666}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -46.67791463438586, "episode_reward_min": -250.8999456090913, "episode_reward_mean": -108.12739756234525, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.454519095303263, "mean_processing_ms": 0.8565764246633468, "mean_inference_ms": 0.5431194606811329}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3097344, "num_steps_sampled": 3108000, "sample_time_ms": 14257.034, "load_time_ms": 9.5, "grad_time_ms": 2405.415, "update_time_ms": 2.916, "learner": {"default_policy": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 4.267744064331055, "policy_loss": 0.0004085743858013302, "vf_loss": 4.267335891723633, "vf_explained_var": 3.827821171142887e-09, "kl": 5.8925419580191374e-05, "entropy": 0.898151695728302, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 3108000, "episodes_total": 887, "training_iteration": 111, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-50-30", "timestamp": 1714819830, "time_this_iter_s": 16.910370588302612, "time_total_s": 1821.3225028514862, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1821.3225028514862, "timesteps_since_restore": 3108000, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 44.258333333333326, "ram_util_percent": 48.32916666666667}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -44.950150977334665, "episode_reward_min": -250.8999456090913, "episode_reward_mean": -109.12889853925799, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4548787930237097, "mean_processing_ms": 0.8564638592119599, "mean_inference_ms": 0.5433021643248084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3125248, "num_steps_sampled": 3136000, "sample_time_ms": 14247.272, "load_time_ms": 9.661, "grad_time_ms": 2398.204, "update_time_ms": 2.92, "learner": {"default_policy": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 4.346808433532715, "policy_loss": -0.00013523036614060402, "vf_loss": 4.346943378448486, "vf_explained_var": 1.367079005554217e-09, "kl": 0.0003759069077204913, "entropy": 0.8986358046531677, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 3136000, "episodes_total": 895, "training_iteration": 112, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-50-47", "timestamp": 1714819847, "time_this_iter_s": 16.664417266845703, "time_total_s": 1837.986920118332, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1837.986920118332, "timesteps_since_restore": 3136000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 43.07500000000001, "ram_util_percent": 48.179166666666674}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
{"episode_reward_max": -44.950150977334665, "episode_reward_min": -250.8999456090913, "episode_reward_mean": -108.96453074055331, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4552979383951588, "mean_processing_ms": 0.8563982398035606, "mean_inference_ms": 0.5435063231563001}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3153152, "num_steps_sampled": 3164000, "sample_time_ms": 14307.967, "load_time_ms": 9.724, "grad_time_ms": 2399.104, "update_time_ms": 2.943, "learner": {"default_policy": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 4.369556903839111, "policy_loss": -0.00020404365204740316, "vf_loss": 4.369760990142822, "vf_explained_var": -1.0389800131349602e-08, "kl": 3.6732933949679136e-05, "entropy": 0.9018312692642212, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 3164000, "episodes_total": 903, "training_iteration": 113, "experiment_id": "3e18ff0c4082488d8f14b917524c5dfe", "date": "2024-05-04_18-51-04", "timestamp": 1714819864, "time_this_iter_s": 16.95098114013672, "time_total_s": 1854.9379012584686, "pid": 147488, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": 30,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 4,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiTrafficLightGridSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1854.9379012584686, "timesteps_since_restore": 3164000, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 47.71666666666667, "ram_util_percent": 48.35833333333333}, "num_healthy_workers": 8, "trial_id": "df0f8a5a", "experiment_tag": "0"}
