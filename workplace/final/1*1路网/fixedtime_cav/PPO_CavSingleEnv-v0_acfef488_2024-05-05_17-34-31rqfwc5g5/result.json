{"episode_reward_max": 282.8510043931728, "episode_reward_min": 10.183847955338589, "episode_reward_mean": 157.86988475967016, "episode_len_mean": 2647.875, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 5.236891013604757, "mean_processing_ms": 1.0292088191399795, "mean_inference_ms": 0.8489254935181325}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27904, "num_steps_sampled": 28000, "sample_time_ms": 27570.172, "load_time_ms": 49.615, "grad_time_ms": 1989.894, "update_time_ms": 534.122, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 3.268380641937256, "policy_loss": -0.003474295139312744, "vf_loss": 3.271052598953247, "vf_explained_var": 0.005374416708946228, "kl": 0.00400985311716795, "entropy": 1.4066243171691895, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 28000, "episodes_total": 8, "training_iteration": 1, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-35-08", "timestamp": 1714901708, "time_this_iter_s": 30.19899320602417, "time_total_s": 30.19899320602417, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30.19899320602417, "timesteps_since_restore": 28000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 74.25681818181818, "ram_util_percent": 88.20454545454547}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8711110126002, "episode_reward_min": 10.183847955338589, "episode_reward_mean": 221.1769515113807, "episode_len_mean": 1957.5, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.9182103824158565, "mean_processing_ms": 1.3778106332730244, "mean_inference_ms": 0.8390802035489622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55808, "num_steps_sampled": 56000, "sample_time_ms": 27161.509, "load_time_ms": 26.846, "grad_time_ms": 1855.215, "update_time_ms": 268.499, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 27.852602005004883, "policy_loss": -0.001856006565503776, "vf_loss": 27.854232788085938, "vf_explained_var": 0.0031345582101494074, "kl": 0.00227562733925879, "entropy": 1.4081591367721558, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 56000, "episodes_total": 26, "training_iteration": 2, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-35-36", "timestamp": 1714901736, "time_this_iter_s": 28.488190174102783, "time_total_s": 58.68718338012695, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 58.68718338012695, "timesteps_since_restore": 56000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 76.14500000000001, "ram_util_percent": 89.92500000000001}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8711110126002, "episode_reward_min": 10.183847955338589, "episode_reward_mean": 234.20489488611946, "episode_len_mean": 1551.826923076923, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.765665124477372, "mean_processing_ms": 1.6308537876270062, "mean_inference_ms": 0.836474325959418}, "off_policy_estimator": {}, "info": {"num_steps_trained": 83712, "num_steps_sampled": 84000, "sample_time_ms": 27948.712, "load_time_ms": 19.929, "grad_time_ms": 1802.866, "update_time_ms": 179.997, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 52.67112350463867, "policy_loss": -0.002015177858993411, "vf_loss": 52.67293930053711, "vf_explained_var": 0.0012224923120811582, "kl": 0.003882169257849455, "entropy": 1.384010910987854, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 84000, "episodes_total": 52, "training_iteration": 3, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-36-07", "timestamp": 1714901767, "time_this_iter_s": 31.2400963306427, "time_total_s": 89.92727971076965, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 89.92727971076965, "timesteps_since_restore": 84000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 75.79111111111112, "ram_util_percent": 89.82000000000002}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8711110126002, "episode_reward_min": 10.183847955338589, "episode_reward_mean": 239.21324332371685, "episode_len_mean": 1305.3058823529411, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.6724653191793815, "mean_processing_ms": 1.861944332718776, "mean_inference_ms": 0.8364100706917387}, "off_policy_estimator": {}, "info": {"num_steps_trained": 111616, "num_steps_sampled": 112000, "sample_time_ms": 28768.314, "load_time_ms": 16.803, "grad_time_ms": 1770.804, "update_time_ms": 135.728, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 83.74598693847656, "policy_loss": -0.00041588893509469926, "vf_loss": 83.74638366699219, "vf_explained_var": 0.0005179632571525872, "kl": 0.0014181954320520163, "entropy": 1.394944190979004, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 112000, "episodes_total": 85, "training_iteration": 4, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-36-40", "timestamp": 1714901800, "time_this_iter_s": 32.922356843948364, "time_total_s": 122.84963655471802, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 122.84963655471802, "timesteps_since_restore": 112000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 76.50212765957448, "ram_util_percent": 89.8872340425532}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8761580929222, "episode_reward_min": 205.76806330537366, "episode_reward_mean": 246.01962729248007, "episode_len_mean": 1017.39, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.552395180311469, "mean_processing_ms": 2.1295143548536215, "mean_inference_ms": 0.8352462640178437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139520, "num_steps_sampled": 140000, "sample_time_ms": 28835.522, "load_time_ms": 14.318, "grad_time_ms": 1762.779, "update_time_ms": 109.358, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 95.43897247314453, "policy_loss": -0.0006656262557953596, "vf_loss": 95.43962860107422, "vf_explained_var": 0.0002584263274911791, "kl": 0.0005972575163468719, "entropy": 1.4127386808395386, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 140000, "episodes_total": 117, "training_iteration": 5, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-37-11", "timestamp": 1714901831, "time_this_iter_s": 30.850575923919678, "time_total_s": 153.7002124786377, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 153.7002124786377, "timesteps_since_restore": 140000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 77.58181818181818, "ram_util_percent": 90.06136363636362}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8761580929222, "episode_reward_min": 205.76806330537366, "episode_reward_mean": 247.28665338177004, "episode_len_mean": 855.39, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.474047944462055, "mean_processing_ms": 2.3909199448803666, "mean_inference_ms": 0.8346117549969532}, "off_policy_estimator": {}, "info": {"num_steps_trained": 167424, "num_steps_sampled": 168000, "sample_time_ms": 29228.14, "load_time_ms": 12.821, "grad_time_ms": 1752.261, "update_time_ms": 91.554, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 101.3791275024414, "policy_loss": -0.00015116120630409569, "vf_loss": 101.37928009033203, "vf_explained_var": 0.00011572378571145236, "kl": 0.00053618528181687, "entropy": 1.409336805343628, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 168000, "episodes_total": 151, "training_iteration": 6, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-37-44", "timestamp": 1714901864, "time_this_iter_s": 32.90842366218567, "time_total_s": 186.60863614082336, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 186.60863614082336, "timesteps_since_restore": 168000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 74.68085106382979, "ram_util_percent": 90.09361702127659}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8761580929222, "episode_reward_min": 205.77593116943638, "episode_reward_mean": 247.29143159877714, "episode_len_mean": 801.33, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.424072741631496, "mean_processing_ms": 2.5535658035413933, "mean_inference_ms": 0.8325080647264762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 195328, "num_steps_sampled": 196000, "sample_time_ms": 29449.643, "load_time_ms": 11.598, "grad_time_ms": 1754.259, "update_time_ms": 78.913, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 120.57971954345703, "policy_loss": -0.00046333097270689905, "vf_loss": 120.58018493652344, "vf_explained_var": 5.4026688303565606e-05, "kl": 0.0008206483907997608, "entropy": 1.4036084413528442, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 196000, "episodes_total": 187, "training_iteration": 7, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-38-17", "timestamp": 1714901897, "time_this_iter_s": 32.56013107299805, "time_total_s": 219.1687672138214, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 219.1687672138214, "timesteps_since_restore": 196000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.21739130434781, "ram_util_percent": 90.10652173913043}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7030229032233, "episode_reward_min": 205.6124540774629, "episode_reward_mean": 246.17245498980407, "episode_len_mean": 767.26, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.384825891870892, "mean_processing_ms": 2.7093560231929588, "mean_inference_ms": 0.8324767583878503}, "off_policy_estimator": {}, "info": {"num_steps_trained": 223232, "num_steps_sampled": 224000, "sample_time_ms": 29963.727, "load_time_ms": 11.17, "grad_time_ms": 1754.126, "update_time_ms": 69.442, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 123.1937026977539, "policy_loss": -0.0017180092399939895, "vf_loss": 123.19540405273438, "vf_explained_var": 2.576834594947286e-05, "kl": 0.003929642029106617, "entropy": 1.405463457107544, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 224000, "episodes_total": 227, "training_iteration": 8, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-38-52", "timestamp": 1714901932, "time_this_iter_s": 35.33518028259277, "time_total_s": 254.50394749641418, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 254.50394749641418, "timesteps_since_restore": 224000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 76.75882352941177, "ram_util_percent": 90.14901960784314}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.82775415167595, "episode_reward_min": 205.6124540774629, "episode_reward_mean": 244.45110144883242, "episode_len_mean": 722.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.360117154627534, "mean_processing_ms": 2.8663676517733028, "mean_inference_ms": 0.8350523213671229}, "off_policy_estimator": {}, "info": {"num_steps_trained": 251136, "num_steps_sampled": 252000, "sample_time_ms": 30270.462, "load_time_ms": 10.509, "grad_time_ms": 1759.061, "update_time_ms": 62.069, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 149.28292846679688, "policy_loss": -9.955055429600179e-05, "vf_loss": 149.2830352783203, "vf_explained_var": 1.1353044101269916e-05, "kl": 0.0009387095924466848, "entropy": 1.4266670942306519, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 252000, "episodes_total": 267, "training_iteration": 9, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-39-27", "timestamp": 1714901967, "time_this_iter_s": 34.539971351623535, "time_total_s": 289.0439188480377, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 289.0439188480377, "timesteps_since_restore": 252000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 78.31020408163266, "ram_util_percent": 90.21632653061224}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.82775415167595, "episode_reward_min": 205.5928335004873, "episode_reward_mean": 243.88666767957463, "episode_len_mean": 680.23, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.334365540751507, "mean_processing_ms": 2.992103696710805, "mean_inference_ms": 0.836233310632164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279040, "num_steps_sampled": 280000, "sample_time_ms": 30466.468, "load_time_ms": 9.991, "grad_time_ms": 1758.764, "update_time_ms": 56.169, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 152.7294464111328, "policy_loss": -0.0004379505990073085, "vf_loss": 152.72988891601562, "vf_explained_var": 4.973160230292706e-06, "kl": 0.0010141934035345912, "entropy": 1.451150894165039, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 280000, "episodes_total": 309, "training_iteration": 10, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-40-01", "timestamp": 1714902001, "time_this_iter_s": 34.00326704978943, "time_total_s": 323.04718589782715, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 323.04718589782715, "timesteps_since_restore": 280000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.44897959183673, "ram_util_percent": 90.26938775510203}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8440816506587, "episode_reward_min": 205.4738245100899, "episode_reward_mean": 243.34731571360277, "episode_len_mean": 656.53, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.308474367392865, "mean_processing_ms": 3.1084993816103315, "mean_inference_ms": 0.8350716397226406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 306944, "num_steps_sampled": 308000, "sample_time_ms": 31014.681, "load_time_ms": 5.713, "grad_time_ms": 1735.443, "update_time_ms": 3.075, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 164.4466094970703, "policy_loss": -0.0002903146669268608, "vf_loss": 164.44688415527344, "vf_explained_var": 2.241189349660999e-06, "kl": 0.0004984295810572803, "entropy": 1.451909065246582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 308000, "episodes_total": 353, "training_iteration": 11, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-40-36", "timestamp": 1714902036, "time_this_iter_s": 34.82833671569824, "time_total_s": 357.8755226135254, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 357.8755226135254, "timesteps_since_restore": 308000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 75.28571428571429, "ram_util_percent": 90.29795918367346}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8440816506587, "episode_reward_min": 205.45887294231403, "episode_reward_mean": 243.14800831782418, "episode_len_mean": 647.97, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.28517948863903, "mean_processing_ms": 3.194492879959229, "mean_inference_ms": 0.8332617466642498}, "off_policy_estimator": {}, "info": {"num_steps_trained": 334848, "num_steps_sampled": 336000, "sample_time_ms": 31574.012, "load_time_ms": 6.031, "grad_time_ms": 1765.129, "update_time_ms": 3.085, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 162.2997283935547, "policy_loss": -0.0018135199788957834, "vf_loss": 162.30157470703125, "vf_explained_var": 1.0920226714006276e-06, "kl": 0.003399862674996257, "entropy": 1.422334909439087, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 336000, "episodes_total": 395, "training_iteration": 12, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-41-10", "timestamp": 1714902070, "time_this_iter_s": 34.38652038574219, "time_total_s": 392.2620429992676, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 392.2620429992676, "timesteps_since_restore": 336000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.4857142857143, "ram_util_percent": 90.29795918367347}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.76375073896463, "episode_reward_min": 205.45887294231403, "episode_reward_mean": 245.2368374587703, "episode_len_mean": 630.37, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.28454486574552, "mean_processing_ms": 3.2887836788801548, "mean_inference_ms": 0.8361221536806223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 362752, "num_steps_sampled": 364000, "sample_time_ms": 32222.752, "load_time_ms": 6.034, "grad_time_ms": 1779.32, "update_time_ms": 3.192, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 191.546630859375, "policy_loss": -0.0015896024415269494, "vf_loss": 191.5482177734375, "vf_explained_var": 4.2543499034763954e-07, "kl": 0.0031224703416228294, "entropy": 1.384611964225769, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 364000, "episodes_total": 443, "training_iteration": 13, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-41-48", "timestamp": 1714902108, "time_this_iter_s": 37.87008881568909, "time_total_s": 430.13213181495667, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 430.13213181495667, "timesteps_since_restore": 364000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 82.55740740740738, "ram_util_percent": 90.0425925925926}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7341874149449, "episode_reward_min": 205.49955448528283, "episode_reward_mean": 246.5223478740284, "episode_len_mean": 605.0, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.295328118528073, "mean_processing_ms": 3.374874926925752, "mean_inference_ms": 0.842178835518921}, "off_policy_estimator": {}, "info": {"num_steps_trained": 390656, "num_steps_sampled": 392000, "sample_time_ms": 32585.505, "load_time_ms": 5.912, "grad_time_ms": 1791.277, "update_time_ms": 3.291, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 196.97584533691406, "policy_loss": -0.000467554695205763, "vf_loss": 196.97634887695312, "vf_explained_var": 1.894771486377067e-07, "kl": 0.000662887585349381, "entropy": 1.379642128944397, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 392000, "episodes_total": 489, "training_iteration": 14, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-42-24", "timestamp": 1714902144, "time_this_iter_s": 36.66672730445862, "time_total_s": 466.7988591194153, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 466.7988591194153, "timesteps_since_restore": 392000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 78.60000000000001, "ram_util_percent": 90.45849056603774}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.82676253530695, "episode_reward_min": 205.49955448528283, "episode_reward_mean": 246.8298222172217, "episode_len_mean": 589.37, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.2944355484472485, "mean_processing_ms": 3.454337020469659, "mean_inference_ms": 0.8460441224681391}, "off_policy_estimator": {}, "info": {"num_steps_trained": 418560, "num_steps_sampled": 420000, "sample_time_ms": 33156.518, "load_time_ms": 5.932, "grad_time_ms": 1799.204, "update_time_ms": 3.19, "learner": {"default_policy": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 196.86865234375, "policy_loss": 3.587051105569117e-05, "vf_loss": 196.86862182617188, "vf_explained_var": 8.25715744667832e-08, "kl": 0.0007061659125611186, "entropy": 1.3583093881607056, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 420000, "episodes_total": 537, "training_iteration": 15, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-43-01", "timestamp": 1714902181, "time_this_iter_s": 36.64144206047058, "time_total_s": 503.44030117988586, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 503.44030117988586, "timesteps_since_restore": 420000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 77.10769230769232, "ram_util_percent": 91.08846153846153}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.82676253530695, "episode_reward_min": 205.49357582262923, "episode_reward_mean": 247.39693940407358, "episode_len_mean": 583.26, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.284615986033333, "mean_processing_ms": 3.5286319024168593, "mean_inference_ms": 0.8480490698646578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 446464, "num_steps_sampled": 448000, "sample_time_ms": 33629.711, "load_time_ms": 5.968, "grad_time_ms": 1806.929, "update_time_ms": 3.268, "learner": {"default_policy": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 206.11192321777344, "policy_loss": -0.0007325681508518755, "vf_loss": 206.11264038085938, "vf_explained_var": 3.964528971778236e-08, "kl": 0.0013962230877950788, "entropy": 1.3206924200057983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 448000, "episodes_total": 586, "training_iteration": 16, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-43-39", "timestamp": 1714902219, "time_this_iter_s": 37.717689990997314, "time_total_s": 541.1579911708832, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 541.1579911708832, "timesteps_since_restore": 448000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 77.67222222222225, "ram_util_percent": 90.35185185185185}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.6847269354997, "episode_reward_min": 205.42984004866253, "episode_reward_mean": 247.35804281343323, "episode_len_mean": 579.95, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.277328900494086, "mean_processing_ms": 3.594320465170331, "mean_inference_ms": 0.8488737986505788}, "off_policy_estimator": {}, "info": {"num_steps_trained": 474368, "num_steps_sampled": 476000, "sample_time_ms": 34081.761, "load_time_ms": 6.2, "grad_time_ms": 1826.15, "update_time_ms": 3.271, "learner": {"default_policy": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 203.72792053222656, "policy_loss": -0.00048726797103881836, "vf_loss": 203.7283935546875, "vf_explained_var": 2.7614996511715617e-08, "kl": 0.001863438868895173, "entropy": 1.3238590955734253, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 476000, "episodes_total": 634, "training_iteration": 17, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-44-16", "timestamp": 1714902256, "time_this_iter_s": 37.27776789665222, "time_total_s": 578.4357590675354, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 578.4357590675354, "timesteps_since_restore": 476000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 76.47735849056602, "ram_util_percent": 90.6622641509434}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8601292125677, "episode_reward_min": 205.39255916094098, "episode_reward_mean": 247.27998000394754, "episode_len_mean": 572.1, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.272019080550694, "mean_processing_ms": 3.6580244804523954, "mean_inference_ms": 0.8500511027066175}, "off_policy_estimator": {}, "info": {"num_steps_trained": 502272, "num_steps_sampled": 504000, "sample_time_ms": 34363.934, "load_time_ms": 5.934, "grad_time_ms": 1837.094, "update_time_ms": 3.346, "learner": {"default_policy": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 210.49623107910156, "policy_loss": 0.00037649928708560765, "vf_loss": 210.49586486816406, "vf_explained_var": -1.066321608789167e-08, "kl": 0.0004034043522551656, "entropy": 1.3424937725067139, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 504000, "episodes_total": 684, "training_iteration": 18, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-44-54", "timestamp": 1714902294, "time_this_iter_s": 38.26412343978882, "time_total_s": 616.6998825073242, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 616.6998825073242, "timesteps_since_restore": 504000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 78.76181818181817, "ram_util_percent": 90.33454545454545}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8601292125677, "episode_reward_min": 205.39255916094098, "episode_reward_mean": 246.97365348389533, "episode_len_mean": 563.29, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.267915270631924, "mean_processing_ms": 3.718046467687751, "mean_inference_ms": 0.8515295147132356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 530176, "num_steps_sampled": 532000, "sample_time_ms": 34674.86, "load_time_ms": 5.938, "grad_time_ms": 1840.538, "update_time_ms": 3.344, "learner": {"default_policy": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 214.19863891601562, "policy_loss": -0.001365687814541161, "vf_loss": 214.20001220703125, "vf_explained_var": -1.0389800131349602e-08, "kl": 0.0020930483005940914, "entropy": 1.2981895208358765, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 532000, "episodes_total": 733, "training_iteration": 19, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-45-32", "timestamp": 1714902332, "time_this_iter_s": 37.684147357940674, "time_total_s": 654.3840298652649, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 654.3840298652649, "timesteps_since_restore": 532000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 78.13584905660379, "ram_util_percent": 90.07358490566038}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8245478434981, "episode_reward_min": 205.38883905138687, "episode_reward_mean": 247.08515624824827, "episode_len_mean": 562.94, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.262109584143732, "mean_processing_ms": 3.768434136709045, "mean_inference_ms": 0.8518438925785686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 558080, "num_steps_sampled": 560000, "sample_time_ms": 35012.525, "load_time_ms": 6.148, "grad_time_ms": 1849.995, "update_time_ms": 3.404, "learner": {"default_policy": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 215.80413818359375, "policy_loss": -0.000393370573874563, "vf_loss": 215.80450439453125, "vf_explained_var": -6.015147491211792e-09, "kl": 0.0025316965766251087, "entropy": 1.3005071878433228, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 560000, "episodes_total": 783, "training_iteration": 20, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-46-10", "timestamp": 1714902370, "time_this_iter_s": 37.47689390182495, "time_total_s": 691.8609237670898, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 691.8609237670898, "timesteps_since_restore": 560000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 75.74074074074075, "ram_util_percent": 89.80000000000003}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8245478434981, "episode_reward_min": 205.38883905138687, "episode_reward_mean": 247.05316858435904, "episode_len_mean": 558.74, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.2569235166227095, "mean_processing_ms": 3.8176705596104377, "mean_inference_ms": 0.8515490280975493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 585984, "num_steps_sampled": 588000, "sample_time_ms": 35342.659, "load_time_ms": 6.352, "grad_time_ms": 1846.59, "update_time_ms": 3.404, "learner": {"default_policy": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 226.01727294921875, "policy_loss": -0.0005626765778288245, "vf_loss": 226.01785278320312, "vf_explained_var": -8.749305280275621e-09, "kl": 0.0006393757648766041, "entropy": 1.3262522220611572, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 588000, "episodes_total": 834, "training_iteration": 21, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-46-48", "timestamp": 1714902408, "time_this_iter_s": 38.09798741340637, "time_total_s": 729.9589111804962, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 729.9589111804962, "timesteps_since_restore": 588000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 75.93703703703704, "ram_util_percent": 89.42777777777779}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.80236836140995, "episode_reward_min": 205.3524664851333, "episode_reward_mean": 247.0293377359108, "episode_len_mean": 551.81, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.252106666431439, "mean_processing_ms": 3.861792087602728, "mean_inference_ms": 0.8519922933141975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 613888, "num_steps_sampled": 616000, "sample_time_ms": 35715.688, "load_time_ms": 6.157, "grad_time_ms": 1828.007, "update_time_ms": 3.45, "learner": {"default_policy": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 217.0992889404297, "policy_loss": -2.7764690457843244e-05, "vf_loss": 217.09930419921875, "vf_explained_var": -4.648068596679877e-09, "kl": 0.0018165281508117914, "entropy": 1.3155004978179932, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 616000, "episodes_total": 884, "training_iteration": 22, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-47-26", "timestamp": 1714902446, "time_this_iter_s": 37.925848960876465, "time_total_s": 767.8847601413727, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 767.8847601413727, "timesteps_since_restore": 616000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 75.35555555555554, "ram_util_percent": 89.22222222222224}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.82461450431776, "episode_reward_min": 205.3524664851333, "episode_reward_mean": 246.99268320833352, "episode_len_mean": 545.61, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.246976392816764, "mean_processing_ms": 3.9011075908017094, "mean_inference_ms": 0.8522554913760644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 641792, "num_steps_sampled": 644000, "sample_time_ms": 35720.251, "load_time_ms": 6.255, "grad_time_ms": 1828.373, "update_time_ms": 3.455, "learner": {"default_policy": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 236.8853759765625, "policy_loss": 0.00026663346216082573, "vf_loss": 236.88510131835938, "vf_explained_var": 5.468315800172263e-10, "kl": 2.1451778593473136e-05, "entropy": 1.3202685117721558, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 644000, "episodes_total": 935, "training_iteration": 23, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-48-04", "timestamp": 1714902484, "time_this_iter_s": 37.92022347450256, "time_total_s": 805.8049836158752, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 805.8049836158752, "timesteps_since_restore": 644000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 75.20740740740742, "ram_util_percent": 89.27407407407406}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.82461450431776, "episode_reward_min": 205.33317603031136, "episode_reward_mean": 247.50850841009435, "episode_len_mean": 544.72, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.2424711766334635, "mean_processing_ms": 3.938346857349258, "mean_inference_ms": 0.8517121524174647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 669696, "num_steps_sampled": 672000, "sample_time_ms": 35828.084, "load_time_ms": 6.288, "grad_time_ms": 1824.09, "update_time_ms": 3.338, "learner": {"default_policy": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 221.37684631347656, "policy_loss": -8.342169167008251e-05, "vf_loss": 221.37693786621094, "vf_explained_var": 1.9685938212887777e-08, "kl": 0.0002824307593982667, "entropy": 1.3093127012252808, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 672000, "episodes_total": 987, "training_iteration": 24, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-48-41", "timestamp": 1714902521, "time_this_iter_s": 37.702472448349, "time_total_s": 843.5074560642242, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 843.5074560642242, "timesteps_since_restore": 672000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 75.91851851851851, "ram_util_percent": 89.35}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7182618871668, "episode_reward_min": 205.33317603031136, "episode_reward_mean": 247.53052228144833, "episode_len_mean": 543.56, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.236601874710256, "mean_processing_ms": 3.9746817654849536, "mean_inference_ms": 0.8510129855238499}, "off_policy_estimator": {}, "info": {"num_steps_trained": 697600, "num_steps_sampled": 700000, "sample_time_ms": 35851.837, "load_time_ms": 6.327, "grad_time_ms": 1817.7, "update_time_ms": 3.524, "learner": {"default_policy": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 232.31350708007812, "policy_loss": -0.000522100308444351, "vf_loss": 232.3140411376953, "vf_explained_var": 1.8865689455083157e-08, "kl": 0.0018852194771170616, "entropy": 1.316054344177246, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 700000, "episodes_total": 1038, "training_iteration": 25, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-49-18", "timestamp": 1714902558, "time_this_iter_s": 36.81588649749756, "time_total_s": 880.3233425617218, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 880.3233425617218, "timesteps_since_restore": 700000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 75.83018867924527, "ram_util_percent": 89.54339622641511}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7182618871668, "episode_reward_min": 205.37896979725548, "episode_reward_mean": 247.39359138786693, "episode_len_mean": 537.34, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.231827509094777, "mean_processing_ms": 4.012906923009468, "mean_inference_ms": 0.849712269231464}, "off_policy_estimator": {}, "info": {"num_steps_trained": 725504, "num_steps_sampled": 728000, "sample_time_ms": 35870.718, "load_time_ms": 6.258, "grad_time_ms": 1816.913, "update_time_ms": 3.553, "learner": {"default_policy": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 234.90589904785156, "policy_loss": -2.5182072931784205e-05, "vf_loss": 234.9059295654297, "vf_explained_var": 2.023277012597191e-08, "kl": 0.00013586114801000804, "entropy": 1.316818118095398, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 728000, "episodes_total": 1092, "training_iteration": 26, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-49-56", "timestamp": 1714902596, "time_this_iter_s": 37.89946746826172, "time_total_s": 918.2228100299835, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 918.2228100299835, "timesteps_since_restore": 728000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 74.25185185185185, "ram_util_percent": 89.5777777777778}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8536466059392, "episode_reward_min": 205.37896979725548, "episode_reward_mean": 248.03269895076886, "episode_len_mean": 536.07, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.225845770008463, "mean_processing_ms": 4.039919837495269, "mean_inference_ms": 0.8485459856374559}, "off_policy_estimator": {}, "info": {"num_steps_trained": 753408, "num_steps_sampled": 756000, "sample_time_ms": 35935.666, "load_time_ms": 6.08, "grad_time_ms": 1797.223, "update_time_ms": 3.542, "learner": {"default_policy": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 229.8942108154297, "policy_loss": -0.0012206832179799676, "vf_loss": 229.8954315185547, "vf_explained_var": 3.1442816350590874e-08, "kl": 0.0033146007917821407, "entropy": 1.297574520111084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 756000, "episodes_total": 1143, "training_iteration": 27, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-50-34", "timestamp": 1714902634, "time_this_iter_s": 37.72713804244995, "time_total_s": 955.9499480724335, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 955.9499480724335, "timesteps_since_restore": 756000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 74.40185185185186, "ram_util_percent": 89.5814814814815}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8536466059392, "episode_reward_min": 205.36102679149488, "episode_reward_mean": 247.52220671138596, "episode_len_mean": 531.41, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.222470714621694, "mean_processing_ms": 4.075919550591931, "mean_inference_ms": 0.848854925281154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 781312, "num_steps_sampled": 784000, "sample_time_ms": 35903.485, "load_time_ms": 6.242, "grad_time_ms": 1787.615, "update_time_ms": 3.499, "learner": {"default_policy": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 236.10044860839844, "policy_loss": -0.00023403011437039822, "vf_loss": 236.10067749023438, "vf_explained_var": 1.777202740527173e-08, "kl": 0.001442820648662746, "entropy": 1.2684986591339111, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 784000, "episodes_total": 1195, "training_iteration": 28, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-51-12", "timestamp": 1714902672, "time_this_iter_s": 37.85089945793152, "time_total_s": 993.800847530365, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 993.800847530365, "timesteps_since_restore": 784000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 78.4351851851852, "ram_util_percent": 89.63518518518516}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8214136327131, "episode_reward_min": 205.36102679149488, "episode_reward_mean": 247.13606573287726, "episode_len_mean": 523.29, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.222768026181763, "mean_processing_ms": 4.117640200033727, "mean_inference_ms": 0.8493678461644245}, "off_policy_estimator": {}, "info": {"num_steps_trained": 809216, "num_steps_sampled": 812000, "sample_time_ms": 36100.057, "load_time_ms": 6.32, "grad_time_ms": 1785.138, "update_time_ms": 3.554, "learner": {"default_policy": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 247.8010711669922, "policy_loss": -0.00015434007218573242, "vf_loss": 247.80120849609375, "vf_explained_var": 2.132643217578334e-08, "kl": 0.0005096690729260445, "entropy": 1.283962368965149, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 812000, "episodes_total": 1252, "training_iteration": 29, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-51-51", "timestamp": 1714902711, "time_this_iter_s": 39.6256046295166, "time_total_s": 1033.4264521598816, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1033.4264521598816, "timesteps_since_restore": 812000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 75.79464285714286, "ram_util_percent": 89.6267857142857}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8214136327131, "episode_reward_min": 205.37043420228576, "episode_reward_mean": 247.15861296362402, "episode_len_mean": 518.83, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.219758982532049, "mean_processing_ms": 4.148624586509608, "mean_inference_ms": 0.8492723017834777}, "off_policy_estimator": {}, "info": {"num_steps_trained": 837120, "num_steps_sampled": 840000, "sample_time_ms": 36123.803, "load_time_ms": 6.168, "grad_time_ms": 1785.647, "update_time_ms": 3.502, "learner": {"default_policy": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 244.86253356933594, "policy_loss": 0.0004012045974377543, "vf_loss": 244.8621368408203, "vf_explained_var": 1.7498610560551242e-08, "kl": 0.000363545143045485, "entropy": 1.3032114505767822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 840000, "episodes_total": 1304, "training_iteration": 30, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-52-29", "timestamp": 1714902749, "time_this_iter_s": 37.71913194656372, "time_total_s": 1071.1455841064453, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1071.1455841064453, "timesteps_since_restore": 840000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 74.98518518518519, "ram_util_percent": 89.49259259259257}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.78965535460327, "episode_reward_min": 205.31470102312255, "episode_reward_mean": 247.832799352211, "episode_len_mean": 518.12, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.218683087382084, "mean_processing_ms": 4.1741732955236905, "mean_inference_ms": 0.849631615119132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 865024, "num_steps_sampled": 868000, "sample_time_ms": 36151.366, "load_time_ms": 5.87, "grad_time_ms": 1790.689, "update_time_ms": 3.551, "learner": {"default_policy": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 249.073486328125, "policy_loss": -0.000638239027466625, "vf_loss": 249.07411193847656, "vf_explained_var": 2.6247917617183703e-08, "kl": 0.001868830993771553, "entropy": 1.2860313653945923, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 868000, "episodes_total": 1359, "training_iteration": 31, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-53-07", "timestamp": 1714902787, "time_this_iter_s": 38.42103052139282, "time_total_s": 1109.5666146278381, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1109.5666146278381, "timesteps_since_restore": 868000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 76.38727272727272, "ram_util_percent": 89.37272727272729}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.83955313900344, "episode_reward_min": 205.31470102312255, "episode_reward_mean": 248.32657996941035, "episode_len_mean": 517.64, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.217968529283408, "mean_processing_ms": 4.197557139407409, "mean_inference_ms": 0.8496213432802671}, "off_policy_estimator": {}, "info": {"num_steps_trained": 892928, "num_steps_sampled": 896000, "sample_time_ms": 36203.234, "load_time_ms": 6.046, "grad_time_ms": 1793.881, "update_time_ms": 3.493, "learner": {"default_policy": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 243.61781311035156, "policy_loss": -0.0008238597074523568, "vf_loss": 243.61862182617188, "vf_explained_var": 2.4334006809567654e-08, "kl": 0.0026190548669546843, "entropy": 1.261304259300232, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 896000, "episodes_total": 1411, "training_iteration": 32, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-53-46", "timestamp": 1714902826, "time_this_iter_s": 38.47856020927429, "time_total_s": 1148.0451748371124, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1148.0451748371124, "timesteps_since_restore": 896000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 75.49272727272728, "ram_util_percent": 89.46727272727274}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.83955313900344, "episode_reward_min": 205.33565207429976, "episode_reward_mean": 247.6891624896686, "episode_len_mean": 510.47, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.2136514794420075, "mean_processing_ms": 4.231435712083282, "mean_inference_ms": 0.8486268107948531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 920832, "num_steps_sampled": 924000, "sample_time_ms": 36321.882, "load_time_ms": 5.933, "grad_time_ms": 1788.922, "update_time_ms": 3.412, "learner": {"default_policy": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 257.07781982421875, "policy_loss": -0.0003428794152569026, "vf_loss": 257.0781555175781, "vf_explained_var": 2.8708658561527045e-08, "kl": 0.0013874408323317766, "entropy": 1.2399661540985107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 924000, "episodes_total": 1468, "training_iteration": 33, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-54-25", "timestamp": 1714902865, "time_this_iter_s": 39.05429267883301, "time_total_s": 1187.0994675159454, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1187.0994675159454, "timesteps_since_restore": 924000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 74.68928571428572, "ram_util_percent": 89.8267857142857}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7885968807311, "episode_reward_min": 205.33565207429976, "episode_reward_mean": 246.9817876576163, "episode_len_mean": 509.03, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.212701148357789, "mean_processing_ms": 4.267961539738561, "mean_inference_ms": 0.84877055308997}, "off_policy_estimator": {}, "info": {"num_steps_trained": 948736, "num_steps_sampled": 952000, "sample_time_ms": 36551.258, "load_time_ms": 5.872, "grad_time_ms": 1793.904, "update_time_ms": 3.433, "learner": {"default_policy": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 253.031494140625, "policy_loss": -0.0011567597975954413, "vf_loss": 253.03268432617188, "vf_explained_var": 2.46074218779313e-08, "kl": 0.003098052926361561, "entropy": 1.2296663522720337, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 952000, "episodes_total": 1524, "training_iteration": 34, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-55-05", "timestamp": 1714902905, "time_this_iter_s": 40.045095920562744, "time_total_s": 1227.1445634365082, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1227.1445634365082, "timesteps_since_restore": 952000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 77.44035087719298, "ram_util_percent": 90.13684210526316}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.79779401500446, "episode_reward_min": 205.32996217015048, "episode_reward_mean": 246.90985941784004, "episode_len_mean": 506.73, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.212159044118767, "mean_processing_ms": 4.296767194296484, "mean_inference_ms": 0.8498493075656549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 976640, "num_steps_sampled": 980000, "sample_time_ms": 36822.432, "load_time_ms": 6.216, "grad_time_ms": 1795.45, "update_time_ms": 3.251, "learner": {"default_policy": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 262.9385070800781, "policy_loss": -0.0006296738283708692, "vf_loss": 262.9391174316406, "vf_explained_var": 3.00757392324158e-08, "kl": 0.0012773405760526657, "entropy": 1.2487807273864746, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 980000, "episodes_total": 1580, "training_iteration": 35, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-55-45", "timestamp": 1714902945, "time_this_iter_s": 39.54559326171875, "time_total_s": 1266.690156698227, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1266.690156698227, "timesteps_since_restore": 980000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 75.50535714285714, "ram_util_percent": 89.73214285714286}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.79779401500446, "episode_reward_min": 205.32996217015048, "episode_reward_mean": 246.90375116705815, "episode_len_mean": 503.69, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.2117236120858275, "mean_processing_ms": 4.32039381777388, "mean_inference_ms": 0.8504361575037405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1004544, "num_steps_sampled": 1008000, "sample_time_ms": 36864.111, "load_time_ms": 6.224, "grad_time_ms": 1802.144, "update_time_ms": 3.263, "learner": {"default_policy": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 252.17771911621094, "policy_loss": -0.0010063780937343836, "vf_loss": 252.17872619628906, "vf_explained_var": -3.5544054366454247e-09, "kl": 0.0020468803122639656, "entropy": 1.2232954502105713, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1008000, "episodes_total": 1634, "training_iteration": 36, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-56-23", "timestamp": 1714902983, "time_this_iter_s": 38.381696939468384, "time_total_s": 1305.0718536376953, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1305.0718536376953, "timesteps_since_restore": 1008000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 76.13636363636365, "ram_util_percent": 88.05272727272725}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7927060906305, "episode_reward_min": 205.3465445145416, "episode_reward_mean": 247.70071242410083, "episode_len_mean": 505.42, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.2116573147676, "mean_processing_ms": 4.339806578534437, "mean_inference_ms": 0.8502051563187345}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1032448, "num_steps_sampled": 1036000, "sample_time_ms": 37002.877, "load_time_ms": 6.51, "grad_time_ms": 1807.607, "update_time_ms": 3.374, "learner": {"default_policy": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 252.94334411621094, "policy_loss": -0.0010023321956396103, "vf_loss": 252.94432067871094, "vf_explained_var": -1.066321608789167e-08, "kl": 0.0015912167727947235, "entropy": 1.24623441696167, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1036000, "episodes_total": 1690, "training_iteration": 37, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-57-02", "timestamp": 1714903022, "time_this_iter_s": 39.17481589317322, "time_total_s": 1344.2466695308685, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1344.2466695308685, "timesteps_since_restore": 1036000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 75.69821428571429, "ram_util_percent": 88.10892857142856}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.777243982482, "episode_reward_min": 205.3465445145416, "episode_reward_mean": 247.66760825159818, "episode_len_mean": 507.7, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.208497124084427, "mean_processing_ms": 4.362516692140974, "mean_inference_ms": 0.8500885360063615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1060352, "num_steps_sampled": 1064000, "sample_time_ms": 37103.381, "load_time_ms": 6.36, "grad_time_ms": 1810.503, "update_time_ms": 3.959, "learner": {"default_policy": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 249.34327697753906, "policy_loss": -0.0002467866870574653, "vf_loss": 249.34353637695312, "vf_explained_var": -3.827821171142887e-09, "kl": 0.0024481886066496372, "entropy": 1.240624189376831, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1064000, "episodes_total": 1745, "training_iteration": 38, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-57-41", "timestamp": 1714903061, "time_this_iter_s": 38.88745355606079, "time_total_s": 1383.1341230869293, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1383.1341230869293, "timesteps_since_restore": 1064000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 76.32727272727273, "ram_util_percent": 87.55454545454545}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7846235779482, "episode_reward_min": 205.37134902371264, "episode_reward_mean": 247.66462584180383, "episode_len_mean": 506.16, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.206268892723072, "mean_processing_ms": 4.384099893436967, "mean_inference_ms": 0.8497998401936178}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1088256, "num_steps_sampled": 1092000, "sample_time_ms": 36980.345, "load_time_ms": 6.449, "grad_time_ms": 1814.676, "update_time_ms": 3.903, "learner": {"default_policy": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 262.8248596191406, "policy_loss": -0.0004396586155053228, "vf_loss": 262.8253173828125, "vf_explained_var": -6.288563447753859e-09, "kl": 0.0005338896298781037, "entropy": 1.2250922918319702, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1092000, "episodes_total": 1801, "training_iteration": 39, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-58-19", "timestamp": 1714903099, "time_this_iter_s": 38.43870520591736, "time_total_s": 1421.5728282928467, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1421.5728282928467, "timesteps_since_restore": 1092000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 76.61272727272727, "ram_util_percent": 86.81818181818181}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.80321292990556, "episode_reward_min": 205.36114918727407, "episode_reward_mean": 246.95250536994735, "episode_len_mean": 503.06, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.204299959590626, "mean_processing_ms": 4.409637611187099, "mean_inference_ms": 0.8498376360319588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1116160, "num_steps_sampled": 1120000, "sample_time_ms": 37173.165, "load_time_ms": 6.75, "grad_time_ms": 1823.405, "update_time_ms": 3.925, "learner": {"default_policy": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 256.0302429199219, "policy_loss": -0.000575936574023217, "vf_loss": 256.03082275390625, "vf_explained_var": -6.835394916748783e-09, "kl": 0.0027747477870434523, "entropy": 1.231372356414795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1120000, "episodes_total": 1856, "training_iteration": 40, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-58-59", "timestamp": 1714903139, "time_this_iter_s": 39.73906421661377, "time_total_s": 1461.3118925094604, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1461.3118925094604, "timesteps_since_restore": 1120000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 78.12280701754385, "ram_util_percent": 85.4}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.80321292990556, "episode_reward_min": 205.36114918727407, "episode_reward_mean": 246.23713752147094, "episode_len_mean": 500.85, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.201901865833054, "mean_processing_ms": 4.43508124279113, "mean_inference_ms": 0.8498445286617025}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1144064, "num_steps_sampled": 1148000, "sample_time_ms": 37218.615, "load_time_ms": 6.664, "grad_time_ms": 1826.178, "update_time_ms": 3.927, "learner": {"default_policy": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 251.80738830566406, "policy_loss": -0.00045293732546269894, "vf_loss": 251.80784606933594, "vf_explained_var": -8.749305280275621e-09, "kl": 0.00021728807769250125, "entropy": 1.2329826354980469, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1148000, "episodes_total": 1913, "training_iteration": 41, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_17-59-38", "timestamp": 1714903178, "time_this_iter_s": 38.901240825653076, "time_total_s": 1500.2131333351135, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1500.2131333351135, "timesteps_since_restore": 1148000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 75.53090909090909, "ram_util_percent": 85.23272727272726}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.75140266967304, "episode_reward_min": 205.3753127453236, "episode_reward_mean": 246.94720073451276, "episode_len_mean": 501.68, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.200459090961821, "mean_processing_ms": 4.4466057772631515, "mean_inference_ms": 0.8493086898815091}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1171968, "num_steps_sampled": 1176000, "sample_time_ms": 37202.579, "load_time_ms": 6.614, "grad_time_ms": 1813.422, "update_time_ms": 3.934, "learner": {"default_policy": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 256.57867431640625, "policy_loss": -0.0007313138339668512, "vf_loss": 256.5793762207031, "vf_explained_var": -6.288563447753859e-09, "kl": 0.0011829803697764874, "entropy": 1.2480735778808594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1176000, "episodes_total": 1967, "training_iteration": 42, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-00-16", "timestamp": 1714903216, "time_this_iter_s": 38.18956923484802, "time_total_s": 1538.4027025699615, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1538.4027025699615, "timesteps_since_restore": 1176000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 72.86181818181818, "ram_util_percent": 85.28545454545456}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7870815405012, "episode_reward_min": 205.33984102239077, "episode_reward_mean": 246.9274984956992, "episode_len_mean": 501.25, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.19685961984007, "mean_processing_ms": 4.464189231648388, "mean_inference_ms": 0.8483616155052449}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1199872, "num_steps_sampled": 1204000, "sample_time_ms": 37097.901, "load_time_ms": 6.524, "grad_time_ms": 1814.016, "update_time_ms": 3.957, "learner": {"default_policy": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 250.7872314453125, "policy_loss": 0.00027730868896469474, "vf_loss": 250.7869415283203, "vf_explained_var": -7.382226829832916e-09, "kl": 0.0006981277256272733, "entropy": 1.2498897314071655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1204000, "episodes_total": 2024, "training_iteration": 43, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-00-54", "timestamp": 1714903254, "time_this_iter_s": 38.01313853263855, "time_total_s": 1576.4158411026, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1576.4158411026, "timesteps_since_restore": 1204000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 75.05740740740742, "ram_util_percent": 85.28888888888886}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.84633842732774, "episode_reward_min": 205.32849223555598, "episode_reward_mean": 246.3558324997553, "episode_len_mean": 497.36, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.1921208527827165, "mean_processing_ms": 4.487578082264419, "mean_inference_ms": 0.8470301363695205}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1227776, "num_steps_sampled": 1232000, "sample_time_ms": 36978.992, "load_time_ms": 6.392, "grad_time_ms": 1806.807, "update_time_ms": 4.011, "learner": {"default_policy": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 263.1432800292969, "policy_loss": 8.624244946986437e-05, "vf_loss": 263.1431579589844, "vf_explained_var": -8.202474255369907e-09, "kl": 0.00061773945344612, "entropy": 1.2738066911697388, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1232000, "episodes_total": 2081, "training_iteration": 44, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-01-33", "timestamp": 1714903293, "time_this_iter_s": 38.7849555015564, "time_total_s": 1615.2007966041565, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1615.2007966041565, "timesteps_since_restore": 1232000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 73.4981818181818, "ram_util_percent": 85.30727272727272}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.84633842732774, "episode_reward_min": 205.30617637007634, "episode_reward_mean": 246.94735996726595, "episode_len_mean": 495.39, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.192590653121466, "mean_processing_ms": 4.49999283974431, "mean_inference_ms": 0.8476216439226331}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1255680, "num_steps_sampled": 1260000, "sample_time_ms": 36998.457, "load_time_ms": 6.094, "grad_time_ms": 1806.979, "update_time_ms": 4.143, "learner": {"default_policy": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 256.70819091796875, "policy_loss": 0.00023991412308532745, "vf_loss": 256.7079162597656, "vf_explained_var": 0.0, "kl": 0.00025873284903354943, "entropy": 1.2595634460449219, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1260000, "episodes_total": 2135, "training_iteration": 45, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-02-13", "timestamp": 1714903333, "time_this_iter_s": 39.73945450782776, "time_total_s": 1654.9402511119843, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1654.9402511119843, "timesteps_since_restore": 1260000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 80.97543859649123, "ram_util_percent": 85.06491228070175}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7894819884489, "episode_reward_min": 205.30617637007634, "episode_reward_mean": 246.9266491765798, "episode_len_mean": 497.26, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.193221774968326, "mean_processing_ms": 4.517640429857866, "mean_inference_ms": 0.8480327443667613}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1283584, "num_steps_sampled": 1288000, "sample_time_ms": 37059.583, "load_time_ms": 6.073, "grad_time_ms": 1808.763, "update_time_ms": 4.044, "learner": {"default_policy": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 260.1335754394531, "policy_loss": 0.00019260146655142307, "vf_loss": 260.13336181640625, "vf_explained_var": -4.3746526401378105e-09, "kl": 6.29295755061321e-05, "entropy": 1.2596491575241089, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1288000, "episodes_total": 2192, "training_iteration": 46, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-02-52", "timestamp": 1714903372, "time_this_iter_s": 39.01010704040527, "time_total_s": 1693.9503581523895, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1693.9503581523895, "timesteps_since_restore": 1288000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 76.05892857142858, "ram_util_percent": 84.72321428571429}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.83465171868534, "episode_reward_min": 205.33887675349345, "episode_reward_mean": 246.54324700422728, "episode_len_mean": 495.42, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.194560249173898, "mean_processing_ms": 4.539682571152051, "mean_inference_ms": 0.8483054437763597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1311488, "num_steps_sampled": 1316000, "sample_time_ms": 37247.659, "load_time_ms": 5.864, "grad_time_ms": 1822.211, "update_time_ms": 3.998, "learner": {"default_policy": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 260.3956604003906, "policy_loss": -8.310856355819851e-05, "vf_loss": 260.395751953125, "vf_explained_var": -5.194900065674801e-09, "kl": 0.00027961668092757463, "entropy": 1.2480318546295166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1316000, "episodes_total": 2249, "training_iteration": 47, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-03-33", "timestamp": 1714903413, "time_this_iter_s": 41.1877977848053, "time_total_s": 1735.1381559371948, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1735.1381559371948, "timesteps_since_restore": 1316000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 78.75593220338983, "ram_util_percent": 84.38983050847459}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.83465171868534, "episode_reward_min": 205.30531933951642, "episode_reward_mean": 246.5132022116044, "episode_len_mean": 495.53, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.195937544412407, "mean_processing_ms": 4.559176628424674, "mean_inference_ms": 0.8492524517221759}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1339392, "num_steps_sampled": 1344000, "sample_time_ms": 37389.389, "load_time_ms": 5.71, "grad_time_ms": 1819.753, "update_time_ms": 3.383, "learner": {"default_policy": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 257.3037109375, "policy_loss": -0.0004922657390125096, "vf_loss": 257.3042297363281, "vf_explained_var": -9.296137193359755e-09, "kl": 0.0008311023120768368, "entropy": 1.274106740951538, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1344000, "episodes_total": 2306, "training_iteration": 48, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-04-13", "timestamp": 1714903453, "time_this_iter_s": 40.27206468582153, "time_total_s": 1775.4102206230164, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1775.4102206230164, "timesteps_since_restore": 1344000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 77.93333333333334, "ram_util_percent": 83.81754385964913}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.8279082917339, "episode_reward_min": 205.30531933951642, "episode_reward_mean": 246.97558707391607, "episode_len_mean": 498.58, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.194190150767021, "mean_processing_ms": 4.569907134527052, "mean_inference_ms": 0.8493438136853328}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1367296, "num_steps_sampled": 1372000, "sample_time_ms": 37392.566, "load_time_ms": 5.446, "grad_time_ms": 1809.914, "update_time_ms": 3.493, "learner": {"default_policy": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 258.28985595703125, "policy_loss": -0.0016385754570364952, "vf_loss": 258.29150390625, "vf_explained_var": -3.827821171142887e-09, "kl": 0.0036505642347037792, "entropy": 1.2569676637649536, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1372000, "episodes_total": 2361, "training_iteration": 49, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-04-52", "timestamp": 1714903492, "time_this_iter_s": 38.36927890777588, "time_total_s": 1813.7794995307922, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1813.7794995307922, "timesteps_since_restore": 1372000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 73.56909090909092, "ram_util_percent": 83.90363636363634}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
{"episode_reward_max": 282.7267149037178, "episode_reward_min": 205.31422633340196, "episode_reward_mean": 246.47794390336924, "episode_len_mean": 494.68, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.192622331350545, "mean_processing_ms": 4.587846879962703, "mean_inference_ms": 0.8490209682381658}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1395200, "num_steps_sampled": 1400000, "sample_time_ms": 37434.044, "load_time_ms": 5.153, "grad_time_ms": 1791.216, "update_time_ms": 3.562, "learner": {"default_policy": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 257.3955078125, "policy_loss": -0.0008590915822423995, "vf_loss": 257.3963623046875, "vf_explained_var": -2.7341579000861316e-10, "kl": 0.00039864220889285207, "entropy": 1.2648382186889648, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1400000, "episodes_total": 2419, "training_iteration": 50, "experiment_id": "a6d5343032974c3e81fa98e04c3bdc3f", "date": "2024-05-05_18-05-32", "timestamp": 1714903532, "time_this_iter_s": 39.96182084083557, "time_total_s": 1853.7413203716278, "pid": 25435, "hostname": "g-System-Product-Name", "node_ip": "192.168.43.189", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"sort_vehicles\": false,\n            \"target_velocity\": 30\n        },\n        \"clip_actions\": false,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.test.CavSingleEnv\",\n    \"exp_tag\": \"fixedtime_cav\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {\n            \"center0\": {\n                \"id\": \"center0\",\n                \"phases\": [\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GGGrrrGrrrrrGGGrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GyyrrrGrrrrrGyyrrrGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrGGGGrrrrrGrrGGGGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrryyyGrrrrrGrryyyGrrrrr\"\n                    },\n                    {\n                        \"duration\": \"31\",\n                        \"maxDur\": \"45\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGGGrrrGrrrrrGGGrrr\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGyyrrrGrrrrrGyyrrr\"\n                    },\n                    {\n                        \"duration\": \"20\",\n                        \"maxDur\": \"25\",\n                        \"minDur\": \"8\",\n                        \"state\": \"GrrrrrGrrGGGGrrrrrGrrGGG\"\n                    },\n                    {\n                        \"duration\": \"6\",\n                        \"maxDur\": \"6\",\n                        \"minDur\": \"3\",\n                        \"state\": \"GrrrrrGrryyyGrrrrrGrryyy\"\n                    }\n                ],\n                \"programID\": \"1\",\n                \"type\": \"static\"\n            }\n        },\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CavSingleEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1853.7413203716278, "timesteps_since_restore": 1400000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 76.47719298245613, "ram_util_percent": 83.93859649122807}, "num_healthy_workers": 8, "trial_id": "acfef488", "experiment_tag": "0"}
