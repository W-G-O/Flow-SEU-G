{"episode_reward_max": -24.905781389000722, "episode_reward_min": -34.24600492281837, "episode_reward_mean": -29.46036054822608, "episode_len_mean": 3500.0, "episodes_this_iter": 4, "policy_reward_min": {"cav": 2.6925689796327363, "tl": -34.24600492281837}, "policy_reward_max": {"cav": 4.988906359134042, "tl": -29.894687748134665}, "policy_reward_mean": {"cav": 3.840737669383389, "tl": -31.38072938291775}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.776445600000629, "mean_processing_ms": 0.793727296354108, "mean_inference_ms": 0.6300886449996579}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34, "num_steps_sampled": 28000, "sample_time_ms": 19048.478, "load_time_ms": 183.764, "grad_time_ms": 2427.647, "update_time_ms": 1958.587, "learner": {"tl": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01738162152469158, "policy_loss": -0.003015613416209817, "vf_loss": 0.019973300397396088, "vf_explained_var": 0.004839674569666386, "kl": 0.0021196682937443256, "entropy": 1.38423752784729, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 12.900615692138672, "policy_loss": -0.000196386783500202, "vf_loss": 12.900812149047852, "vf_explained_var": -3.24249267578125e-05, "kl": 1.4673261148345773e-06, "entropy": 1.4177732467651367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 28000, "episodes_total": 4, "training_iteration": 1, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-11-56", "timestamp": 1714831916, "time_this_iter_s": 23.787163257598877, "time_total_s": 23.787163257598877, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4ec20>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23.787163257598877, "timesteps_since_restore": 28000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.27142857142857, "ram_util_percent": 78.43714285714285}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": -16.11600541307722, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -28.071351255332484, "episode_len_mean": 3500.0, "episodes_this_iter": 9, "policy_reward_min": {"cav": 0.8906997548553336, "tl": -34.67034051517793}, "policy_reward_max": {"cav": 9.91881186296568, "tl": -26.034817276042574}, "policy_reward_mean": {"cav": 5.270319301059475, "tl": -30.90921549436446}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.572683492419505, "mean_processing_ms": 0.7624571118399378, "mean_inference_ms": 0.6174659274435208}, "off_policy_estimator": {}, "info": {"num_steps_trained": 62, "num_steps_sampled": 56000, "sample_time_ms": 18962.361, "load_time_ms": 96.931, "grad_time_ms": 2236.507, "update_time_ms": 981.212, "learner": {"tl": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 0.011739077046513557, "policy_loss": -0.006031439173966646, "vf_loss": 0.017103716731071472, "vf_explained_var": 0.02283250167965889, "kl": 0.006667982321232557, "entropy": 1.36971116065979, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 33.78089141845703, "policy_loss": -0.0004907590919174254, "vf_loss": 33.7813835144043, "vf_explained_var": 1.6927719116210938e-05, "kl": 1.6135828673213837e-06, "entropy": 1.416530966758728, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 56000, "episodes_total": 13, "training_iteration": 2, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-12-17", "timestamp": 1714831937, "time_this_iter_s": 20.94324040412903, "time_total_s": 44.730403661727905, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44.730403661727905, "timesteps_since_restore": 56000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.46, "ram_util_percent": 80.20333333333335}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": -4.892779873585269, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -25.613762036518704, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -22.094293879686244, "cav": 19.249449815752314}, "policy_reward_mean": {"tl": -29.11497300829656, "cav": 7.3525430407336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.492568586306117, "mean_processing_ms": 0.7741618908013337, "mean_inference_ms": 0.6137311562546348}, "off_policy_estimator": {}, "info": {"num_steps_trained": 108, "num_steps_sampled": 84000, "sample_time_ms": 18215.441, "load_time_ms": 67.997, "grad_time_ms": 2182.206, "update_time_ms": 655.519, "learner": {"tl": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 0.010422255843877792, "policy_loss": -0.005289790686219931, "vf_loss": 0.015370156615972519, "vf_explained_var": 0.030364355072379112, "kl": 0.00683776568621397, "entropy": 1.3407312631607056, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 47.72402572631836, "policy_loss": 5.339021299732849e-05, "vf_loss": 47.723968505859375, "vf_explained_var": 2.1338462829589844e-05, "kl": 5.830889104885273e-09, "entropy": 1.4163204431533813, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 84000, "episodes_total": 21, "training_iteration": 3, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-12-35", "timestamp": 1714831955, "time_this_iter_s": 18.816792249679565, "time_total_s": 63.54719591140747, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939b70e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 63.54719591140747, "timesteps_since_restore": 84000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.588888888888896, "ram_util_percent": 80.21481481481482}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": -4.892779873585269, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -24.045040136419928, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -17.580446354661934, "cav": 19.249449815752314}, "policy_reward_mean": {"tl": -27.087031805780033, "cav": 7.3514798676203235}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.435835593614986, "mean_processing_ms": 0.7884854215883783, "mean_inference_ms": 0.6109810132342911}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110, "num_steps_sampled": 112000, "sample_time_ms": 17747.206, "load_time_ms": 53.719, "grad_time_ms": 2219.192, "update_time_ms": 492.7, "learner": {"tl": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 0.007458215579390526, "policy_loss": -0.006231886334717274, "vf_loss": 0.01348926592618227, "vf_explained_var": 0.03585461899638176, "kl": 0.008033543825149536, "entropy": 1.2959468364715576, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 0.4115380346775055, "policy_loss": -0.0012485682964324951, "vf_loss": 0.412786602973938, "vf_explained_var": 9.5367431640625e-07, "kl": 1.043081283569336e-06, "entropy": 1.4157711267471313, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 112000, "episodes_total": 29, "training_iteration": 4, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-12-54", "timestamp": 1714831974, "time_this_iter_s": 18.695863246917725, "time_total_s": 82.2430591583252, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a215f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 82.2430591583252, "timesteps_since_restore": 112000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.888888888888886, "ram_util_percent": 59.21481481481481}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 1.645968264306322, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -21.826142828617353, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.8906997548553336, "tl": -34.67034051517793}, "policy_reward_max": {"cav": 19.249449815752314, "tl": -13.534202632879108}, "policy_reward_mean": {"cav": 7.072182691593365, "tl": -24.884383992549587}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.388730655871004, "mean_processing_ms": 0.7992237853770657, "mean_inference_ms": 0.6075346034691691}, "off_policy_estimator": {}, "info": {"num_steps_trained": 188, "num_steps_sampled": 140000, "sample_time_ms": 17386.057, "load_time_ms": 45.137, "grad_time_ms": 2237.078, "update_time_ms": 394.89, "learner": {"tl": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 0.007492467761039734, "policy_loss": -0.004254676401615143, "vf_loss": 0.011679627932608128, "vf_explained_var": 0.03057478927075863, "kl": 0.00540126021951437, "entropy": 1.2476378679275513, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 65.61495208740234, "policy_loss": -0.00018673065642360598, "vf_loss": 65.61514282226562, "vf_explained_var": 9.417533874511719e-06, "kl": 1.1141484037580085e-06, "entropy": 1.4145745038986206, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 140000, "episodes_total": 37, "training_iteration": 5, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-13-12", "timestamp": 1714831992, "time_this_iter_s": 18.272285223007202, "time_total_s": 100.5153443813324, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e8c0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 100.5153443813324, "timesteps_since_restore": 140000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.93846153846154, "ram_util_percent": 53.09615384615385}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -19.71340891090316, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -11.517213416576237, "cav": 20.483834812302202}, "policy_reward_mean": {"tl": -23.115812154223203, "cav": 8.506008108300165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.349022874058776, "mean_processing_ms": 0.8076015759917772, "mean_inference_ms": 0.6041526206098033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 197, "num_steps_sampled": 168000, "sample_time_ms": 17091.217, "load_time_ms": 39.483, "grad_time_ms": 2257.432, "update_time_ms": 329.694, "learner": {"tl": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 0.008481592871248722, "policy_loss": -0.002216577995568514, "vf_loss": 0.010682143270969391, "vf_explained_var": 0.027413150295615196, "kl": 0.0025645827408879995, "entropy": 1.2090842723846436, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 13.937417984008789, "policy_loss": 3.519323217915371e-05, "vf_loss": 13.937382698059082, "vf_explained_var": 2.562999725341797e-06, "kl": 4.635916894812908e-08, "entropy": 1.4145262241363525, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 168000, "episodes_total": 45, "training_iteration": 6, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-13-30", "timestamp": 1714832010, "time_this_iter_s": 17.99881410598755, "time_total_s": 118.51415848731995, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93949200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 118.51415848731995, "timesteps_since_restore": 168000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.92, "ram_util_percent": 53.048}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -18.147244066494963, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.8906997548553336, "tl": -34.67034051517793}, "policy_reward_max": {"cav": 20.483834812302202, "tl": -10.69294326588447}, "policy_reward_mean": {"cav": 8.366301837091154, "tl": -21.462193851002766}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3157669394175624, "mean_processing_ms": 0.8142175552576036, "mean_inference_ms": 0.6013051459523838}, "off_policy_estimator": {}, "info": {"num_steps_trained": 246, "num_steps_sampled": 196000, "sample_time_ms": 16887.031, "load_time_ms": 35.388, "grad_time_ms": 2274.98, "update_time_ms": 283.164, "learner": {"tl": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 0.008211953565478325, "policy_loss": -0.0016009367536753416, "vf_loss": 0.009806846268475056, "vf_explained_var": 0.0337846577167511, "kl": 0.001934264088049531, "entropy": 1.1768423318862915, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 43.7526969909668, "policy_loss": -5.920444164075889e-05, "vf_loss": 43.752750396728516, "vf_explained_var": -2.9802322387695312e-06, "kl": 1.1556002377233199e-08, "entropy": 1.4144643545150757, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 196000, "episodes_total": 53, "training_iteration": 7, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-13-48", "timestamp": 1714832028, "time_this_iter_s": 18.06451392173767, "time_total_s": 136.57867240905762, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9b9f889320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 136.57867240905762, "timesteps_since_restore": 196000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.838461538461544, "ram_util_percent": 53.06153846153845}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -16.849116260370767, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -8.742643420486793, "cav": 20.483834812302202}, "policy_reward_mean": {"tl": -20.162528953805907, "cav": 8.787746708675849}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2872178797936917, "mean_processing_ms": 0.8198792273797549, "mean_inference_ms": 0.5993275100129484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 272, "num_steps_sampled": 224000, "sample_time_ms": 16731.72, "load_time_ms": 32.254, "grad_time_ms": 2285.361, "update_time_ms": 248.262, "learner": {"tl": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 0.007886230945587158, "policy_loss": -0.002000491600483656, "vf_loss": 0.009883468970656395, "vf_explained_var": 0.02397666685283184, "kl": 0.0020825909450650215, "entropy": 1.1437575817108154, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 29.731380462646484, "policy_loss": -5.983389200991951e-05, "vf_loss": 29.73143768310547, "vf_explained_var": 6.735324859619141e-06, "kl": 4.241099560431394e-08, "entropy": 1.4143649339675903, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 224000, "episodes_total": 61, "training_iteration": 8, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-14-07", "timestamp": 1714832047, "time_this_iter_s": 18.025535345077515, "time_total_s": 154.60420775413513, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93949170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 154.60420775413513, "timesteps_since_restore": 224000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.24615384615384, "ram_util_percent": 53.05384615384616}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -15.647883127123238, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.8906997548553336, "tl": -34.67034051517793}, "policy_reward_max": {"cav": 20.483834812302202, "tl": -8.38240876226198}, "policy_reward_mean": {"cav": 8.910432106389095, "tl": -19.005437254168395}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.262488453280041, "mean_processing_ms": 0.8245885029378154, "mean_inference_ms": 0.5974167305683508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 299, "num_steps_sampled": 252000, "sample_time_ms": 16612.808, "load_time_ms": 29.822, "grad_time_ms": 2285.909, "update_time_ms": 221.073, "learner": {"tl": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009732062928378582, "policy_loss": -0.00115596957039088, "vf_loss": 0.010887157171964645, "vf_explained_var": 0.03250718489289284, "kl": 0.0011185690527781844, "entropy": 1.1185402870178223, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 21.006357192993164, "policy_loss": 1.6565676560276188e-05, "vf_loss": 21.00634002685547, "vf_explained_var": -2.5272369384765625e-05, "kl": 2.7594742491032775e-08, "entropy": 1.414515733718872, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 252000, "episodes_total": 69, "training_iteration": 9, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-14-25", "timestamp": 1714832065, "time_this_iter_s": 17.972515106201172, "time_total_s": 172.5767228603363, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939b7290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 172.5767228603363, "timesteps_since_restore": 252000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.43846153846153, "ram_util_percent": 53.076923076923066}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -14.89328867850041, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -7.918231604996597, "cav": 20.483834812302202}, "policy_reward_mean": {"tl": -18.09494917787948, "cav": 8.804566373292472}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.24087368695365, "mean_processing_ms": 0.8287758910522566, "mean_inference_ms": 0.5956287897067186}, "off_policy_estimator": {}, "info": {"num_steps_trained": 305, "num_steps_sampled": 280000, "sample_time_ms": 16511.302, "load_time_ms": 27.865, "grad_time_ms": 2284.786, "update_time_ms": 199.524, "learner": {"tl": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 0.011831691488623619, "policy_loss": -0.0018540795426815748, "vf_loss": 0.013684811070561409, "vf_explained_var": 0.03093874827027321, "kl": 0.002458537695929408, "entropy": 1.089349389076233, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 8.126530647277832, "policy_loss": -0.00023784239601809531, "vf_loss": 8.126768112182617, "vf_explained_var": -2.7418136596679688e-06, "kl": 2.086162567138672e-07, "entropy": 1.4149035215377808, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 280000, "episodes_total": 77, "training_iteration": 10, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-14-42", "timestamp": 1714832082, "time_this_iter_s": 17.89783263206482, "time_total_s": 190.47455549240112, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93949200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 190.47455549240112, "timesteps_since_restore": 280000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.784000000000006, "ram_util_percent": 53.116000000000014}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -14.328565952061828, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -7.918231604996597, "cav": 20.483834812302202}, "policy_reward_mean": {"tl": -17.44272485029401, "cav": 8.538822785475379}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2218094051384623, "mean_processing_ms": 0.83238625160222, "mean_inference_ms": 0.5939865520919904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 361, "num_steps_sampled": 308000, "sample_time_ms": 16182.764, "load_time_ms": 10.694, "grad_time_ms": 2273.24, "update_time_ms": 4.073, "learner": {"tl": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01097060739994049, "policy_loss": -0.0013327694032341242, "vf_loss": 0.012302977964282036, "vf_explained_var": 0.03507963567972183, "kl": 0.002043315675109625, "entropy": 1.0634760856628418, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 39.24346160888672, "policy_loss": 2.3518290618085302e-05, "vf_loss": 39.24343490600586, "vf_explained_var": 3.516674041748047e-06, "kl": 2.0223004071340256e-07, "entropy": 1.4153754711151123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 308000, "episodes_total": 85, "training_iteration": 11, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-15-01", "timestamp": 1714832101, "time_this_iter_s": 18.10325050354004, "time_total_s": 208.57780599594116, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4ed40>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 208.57780599594116, "timesteps_since_restore": 308000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.38461538461539, "ram_util_percent": 53.06538461538461}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 6.251854556575797, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -13.621861604638921, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -34.67034051517793, "cav": 0.8906997548553336}, "policy_reward_max": {"tl": -7.6523305826921, "cav": 20.483834812302202}, "policy_reward_mean": {"tl": -16.802647031788037, "cav": 8.700383668378489}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2047735929454717, "mean_processing_ms": 0.8356251715828469, "mean_inference_ms": 0.5924976273926649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 397, "num_steps_sampled": 336000, "sample_time_ms": 15854.859, "load_time_ms": 10.874, "grad_time_ms": 2335.671, "update_time_ms": 4.063, "learner": {"tl": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01463424600660801, "policy_loss": 0.00043035324779339135, "vf_loss": 0.0142038743942976, "vf_explained_var": 0.02596847526729107, "kl": 0.00019194635387975723, "entropy": 1.0655059814453125, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 104.44357299804688, "policy_loss": -3.546145308064297e-05, "vf_loss": 104.44361114501953, "vf_explained_var": 1.049041748046875e-05, "kl": 2.566311074758687e-08, "entropy": 1.415318250656128, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 336000, "episodes_total": 93, "training_iteration": 12, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-15-19", "timestamp": 1714832119, "time_this_iter_s": 18.290032863616943, "time_total_s": 226.8678388595581, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93949170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 226.8678388595581, "timesteps_since_restore": 336000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.542307692307695, "ram_util_percent": 53.05769230769231}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -34.67034051517793, "episode_reward_mean": -12.677362792963017, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.8906997548553336, "tl": -34.67034051517793}, "policy_reward_max": {"cav": 25.811664356002908, "tl": -7.478235699247165}, "policy_reward_mean": {"cav": 9.331304227413705, "tl": -16.036632314831937}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1840020493217276, "mean_processing_ms": 0.8390191130230862, "mean_inference_ms": 0.5907352285190995}, "off_policy_estimator": {}, "info": {"num_steps_trained": 449, "num_steps_sampled": 364000, "sample_time_ms": 15753.372, "load_time_ms": 11.001, "grad_time_ms": 2381.165, "update_time_ms": 4.03, "learner": {"tl": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.013944100588560104, "policy_loss": 0.0004815747670363635, "vf_loss": 0.013462506234645844, "vf_explained_var": 0.02493368834257126, "kl": 0.0005635698325932026, "entropy": 1.0465384721755981, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 45.57822036743164, "policy_loss": -8.561978029320017e-05, "vf_loss": 45.57830810546875, "vf_explained_var": 1.3709068298339844e-05, "kl": 2.0403128075940913e-07, "entropy": 1.4147241115570068, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 364000, "episodes_total": 101, "training_iteration": 13, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-15-37", "timestamp": 1714832137, "time_this_iter_s": 18.260674953460693, "time_total_s": 245.1285138130188, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e4d0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 245.1285138130188, "timesteps_since_restore": 364000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.642307692307696, "ram_util_percent": 53.06923076923076}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -30.78121140536259, "episode_reward_mean": -10.730352686253852, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -33.98047994307794, "cav": 0.897322197861629}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -14.283438626895078, "cav": 9.869683168447857}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1354427890438155, "mean_processing_ms": 0.8517639397233658, "mean_inference_ms": 0.5874698002858273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 451, "num_steps_sampled": 392000, "sample_time_ms": 15675.042, "load_time_ms": 10.956, "grad_time_ms": 2393.858, "update_time_ms": 3.998, "learner": {"tl": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01794860139489174, "policy_loss": -0.00019332206284161657, "vf_loss": 0.01814192160964012, "vf_explained_var": 0.024555077776312828, "kl": 0.00013161617971491069, "entropy": 1.0441973209381104, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.359825074672699, "policy_loss": -2.205371856689453e-06, "vf_loss": 0.35982728004455566, "vf_explained_var": 1.0788440704345703e-05, "kl": 8.940696716308594e-08, "entropy": 1.4147417545318604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 392000, "episodes_total": 109, "training_iteration": 14, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-15-55", "timestamp": 1714832155, "time_this_iter_s": 18.03933572769165, "time_total_s": 263.16784954071045, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93949050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 263.16784954071045, "timesteps_since_restore": 392000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 44.715384615384615, "ram_util_percent": 53.111538461538466}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -29.237650058728338, "episode_reward_mean": -9.37273299995027, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -29.237650058728338, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -12.812128417985393, "cav": 9.553876161208668}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.101474423540588, "mean_processing_ms": 0.8566920578013311, "mean_inference_ms": 0.5844800206312707}, "off_policy_estimator": {}, "info": {"num_steps_trained": 524, "num_steps_sampled": 420000, "sample_time_ms": 15650.113, "load_time_ms": 10.89, "grad_time_ms": 2408.879, "update_time_ms": 4.04, "learner": {"tl": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.017380187287926674, "policy_loss": 1.9663244529510848e-05, "vf_loss": 0.0173605065792799, "vf_explained_var": 0.04669036343693733, "kl": 0.0014398633502423763, "entropy": 1.0400280952453613, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 67.1032485961914, "policy_loss": -8.467105362797156e-05, "vf_loss": 67.10333251953125, "vf_explained_var": -1.7881393432617188e-06, "kl": 7.430168125210912e-08, "entropy": 1.4142370223999023, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 420000, "episodes_total": 117, "training_iteration": 15, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-16-13", "timestamp": 1714832173, "time_this_iter_s": 18.173917531967163, "time_total_s": 281.3417670726776, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939b77a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 281.3417670726776, "timesteps_since_restore": 420000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.534615384615385, "ram_util_percent": 53.13076923076923}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -23.04859871972612, "episode_reward_mean": -8.107603781352895, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -23.04859871972612, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -11.651752605669449, "cav": 9.844857845323766}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.074645946313795, "mean_processing_ms": 0.8618577043809756, "mean_inference_ms": 0.5818859592222203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 535, "num_steps_sampled": 448000, "sample_time_ms": 15642.345, "load_time_ms": 11.32, "grad_time_ms": 2434.298, "update_time_ms": 4.076, "learner": {"tl": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.015447895042598248, "policy_loss": -2.2251124391914345e-05, "vf_loss": 0.015470147132873535, "vf_explained_var": 0.03924337401986122, "kl": 0.00025953937438316643, "entropy": 1.0343732833862305, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 26.737232208251953, "policy_loss": -0.0001710653305053711, "vf_loss": 26.737403869628906, "vf_explained_var": 3.337860107421875e-06, "kl": 2.871860260711401e-07, "entropy": 1.4144606590270996, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 448000, "episodes_total": 125, "training_iteration": 16, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-16-32", "timestamp": 1714832192, "time_this_iter_s": 18.180516719818115, "time_total_s": 299.5222837924957, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939490e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 299.5222837924957, "timesteps_since_restore": 448000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.63461538461539, "ram_util_percent": 53.11538461538463}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -17.809207897556707, "episode_reward_mean": -7.304904669461236, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -17.809207897556707, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -10.864728639772766, "cav": 10.470070500916263}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0529953892918233, "mean_processing_ms": 0.8653097276778944, "mean_inference_ms": 0.5797552376341981}, "off_policy_estimator": {}, "info": {"num_steps_trained": 586, "num_steps_sampled": 476000, "sample_time_ms": 15657.645, "load_time_ms": 11.375, "grad_time_ms": 2451.021, "update_time_ms": 4.045, "learner": {"tl": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.014710658229887486, "policy_loss": -0.0006656537298113108, "vf_loss": 0.015376310795545578, "vf_explained_var": 0.05906321853399277, "kl": 0.0004277316911611706, "entropy": 1.0268224477767944, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 58.07234191894531, "policy_loss": -2.9648052077391185e-05, "vf_loss": 58.07237243652344, "vf_explained_var": 1.817941665649414e-05, "kl": 2.2673138744266907e-07, "entropy": 1.41472327709198, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 476000, "episodes_total": 133, "training_iteration": 17, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-16-50", "timestamp": 1714832210, "time_this_iter_s": 18.385783433914185, "time_total_s": 317.9080672264099, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 317.9080672264099, "timesteps_since_restore": 476000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.80384615384615, "ram_util_percent": 53.14615384615385}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -16.28659877159885, "episode_reward_mean": -6.778743695863508, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.28659877159885, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -10.439341927891219, "cav": 10.76646538831679}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0358208665050683, "mean_processing_ms": 0.868431475837419, "mean_inference_ms": 0.5782088476659684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 593, "num_steps_sampled": 504000, "sample_time_ms": 15658.76, "load_time_ms": 11.376, "grad_time_ms": 2453.086, "update_time_ms": 4.089, "learner": {"tl": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.016525734215974808, "policy_loss": -0.000248840224230662, "vf_loss": 0.016774576157331467, "vf_explained_var": 0.08601485937833786, "kl": 0.00019467613310553133, "entropy": 1.0171136856079102, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 10.933401107788086, "policy_loss": -0.0007155282073654234, "vf_loss": 10.934114456176758, "vf_explained_var": 1.5854835510253906e-05, "kl": 4.6832221300974197e-07, "entropy": 1.4147306680679321, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 504000, "episodes_total": 141, "training_iteration": 18, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-17-08", "timestamp": 1714832228, "time_this_iter_s": 18.057757139205933, "time_total_s": 335.96582436561584, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939b7e60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 335.96582436561584, "timesteps_since_restore": 504000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.11538461538463, "ram_util_percent": 53.184615384615384}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -14.895154000626253, "episode_reward_mean": -6.756559105167469, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -14.895154000626253, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -10.106586581225509, "cav": 10.151598412297085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.022182524823182, "mean_processing_ms": 0.870999120913422, "mean_inference_ms": 0.5772178544877067}, "off_policy_estimator": {}, "info": {"num_steps_trained": 646, "num_steps_sampled": 532000, "sample_time_ms": 15755.554, "load_time_ms": 11.342, "grad_time_ms": 2450.662, "update_time_ms": 4.166, "learner": {"tl": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.013016809709370136, "policy_loss": -0.0006692945607937872, "vf_loss": 0.013686103746294975, "vf_explained_var": 0.11452143639326096, "kl": 0.0005694536375813186, "entropy": 1.0057531595230103, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 38.13356018066406, "policy_loss": -5.9804828197229654e-05, "vf_loss": 38.13361740112305, "vf_explained_var": 1.3530254364013672e-05, "kl": 6.185387633195205e-07, "entropy": 1.4145820140838623, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 532000, "episodes_total": 149, "training_iteration": 19, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-17-27", "timestamp": 1714832247, "time_this_iter_s": 18.918747901916504, "time_total_s": 354.88457226753235, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939b7170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 354.88457226753235, "timesteps_since_restore": 532000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 48.26666666666668, "ram_util_percent": 53.3962962962963}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -13.17210536921318, "episode_reward_mean": -6.32762406138516, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -13.17210536921318, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -9.86462608873956, "cav": 10.402947139277625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0110314114168206, "mean_processing_ms": 0.8733153736216538, "mean_inference_ms": 0.5764466954525916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 678, "num_steps_sampled": 560000, "sample_time_ms": 15789.152, "load_time_ms": 11.404, "grad_time_ms": 2451.706, "update_time_ms": 3.966, "learner": {"tl": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0177313182502985, "policy_loss": -0.00041947781573981047, "vf_loss": 0.018150797113776207, "vf_explained_var": 0.11165128648281097, "kl": 0.0006636640755459666, "entropy": 0.9948847889900208, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 38.05096435546875, "policy_loss": -0.0001439303159713745, "vf_loss": 38.051109313964844, "vf_explained_var": 1.621246337890625e-05, "kl": 2.9243528842926025e-07, "entropy": 1.414386510848999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 560000, "episodes_total": 157, "training_iteration": 20, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-17-45", "timestamp": 1714832265, "time_this_iter_s": 18.24073576927185, "time_total_s": 373.1253080368042, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4ee60>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 373.1253080368042, "timesteps_since_restore": 560000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 45.95384615384616, "ram_util_percent": 53.17307692307692}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -14.489785704205085, "episode_reward_mean": -6.347949738939186, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -14.489785704205085, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -9.853545754086445, "cav": 10.310576515138983}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.001712473951457, "mean_processing_ms": 0.8753139887460177, "mean_inference_ms": 0.5757494482890252}, "off_policy_estimator": {}, "info": {"num_steps_trained": 722, "num_steps_sampled": 588000, "sample_time_ms": 15798.367, "load_time_ms": 11.223, "grad_time_ms": 2467.709, "update_time_ms": 3.933, "learner": {"tl": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.018613198772072792, "policy_loss": -5.4793894378235564e-05, "vf_loss": 0.01866799034178257, "vf_explained_var": 0.16224652528762817, "kl": 0.0007354426197707653, "entropy": 0.985079824924469, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 25.92938804626465, "policy_loss": 3.073432162636891e-05, "vf_loss": 25.929357528686523, "vf_explained_var": 3.218650817871094e-05, "kl": 1.7610462421657758e-08, "entropy": 1.4142670631408691, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 588000, "episodes_total": 165, "training_iteration": 21, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-18-04", "timestamp": 1714832284, "time_this_iter_s": 18.349849462509155, "time_total_s": 391.47515749931335, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a218c0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 391.47515749931335, "timesteps_since_restore": 588000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 44.550000000000004, "ram_util_percent": 53.138461538461534}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -14.489785704205085, "episode_reward_mean": -6.244041020840507, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -15.000159034578333, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -9.840143925079921, "cav": 10.274579726398308}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9936865891351214, "mean_processing_ms": 0.876989153835556, "mean_inference_ms": 0.5752161835422087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28626, "num_steps_sampled": 616000, "sample_time_ms": 15791.129, "load_time_ms": 11.08, "grad_time_ms": 2450.819, "update_time_ms": 3.976, "learner": {"tl": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.020984699949622154, "policy_loss": 7.888190884841606e-05, "vf_loss": 0.020905818790197372, "vf_explained_var": 0.12973247468471527, "kl": 3.081329487031326e-05, "entropy": 0.9864916205406189, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 616000, "episodes_total": 173, "training_iteration": 22, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-18-22", "timestamp": 1714832302, "time_this_iter_s": 18.048900365829468, "time_total_s": 409.5240578651428, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 409.5240578651428, "timesteps_since_restore": 616000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 44.30384615384616, "ram_util_percent": 53.25769230769232}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -14.489785704205085, "episode_reward_mean": -6.077791809457967, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -15.000159034578333, "cav": 0.0}, "policy_reward_max": {"tl": -6.874111436856734, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -9.771913827605065, "cav": 10.55463433756311}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9868114172768334, "mean_processing_ms": 0.8784799250298215, "mean_inference_ms": 0.5748311169448299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28683, "num_steps_sampled": 644000, "sample_time_ms": 15788.218, "load_time_ms": 11.03, "grad_time_ms": 2447.089, "update_time_ms": 4.042, "learner": {"tl": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01785288192331791, "policy_loss": 6.58951248624362e-05, "vf_loss": 0.017786987125873566, "vf_explained_var": 0.19025340676307678, "kl": 0.0009990554535761476, "entropy": 0.9801546931266785, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 48.84672546386719, "policy_loss": -4.96998181915842e-05, "vf_loss": 48.84677505493164, "vf_explained_var": -6.9141387939453125e-06, "kl": 1.0247816106812024e-07, "entropy": 1.4144926071166992, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 644000, "episodes_total": 181, "training_iteration": 23, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-18-40", "timestamp": 1714832320, "time_this_iter_s": 18.191559314727783, "time_total_s": 427.7156171798706, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c9396dcb0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 427.7156171798706, "timesteps_since_restore": 644000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 44.4423076923077, "ram_util_percent": 53.18846153846154}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -14.757589763750646, "episode_reward_mean": -6.144113468281262, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -15.000159034578333, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -9.725326138141678, "cav": 10.532978440765897}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.980773023385524, "mean_processing_ms": 0.8797396682851469, "mean_inference_ms": 0.5745183553971014}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28695, "num_steps_sampled": 672000, "sample_time_ms": 15779.373, "load_time_ms": 11.215, "grad_time_ms": 2443.091, "update_time_ms": 4.028, "learner": {"tl": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.021616660058498383, "policy_loss": -0.00035677876439876854, "vf_loss": 0.021973438560962677, "vf_explained_var": 0.09993989765644073, "kl": 0.00041863523074425757, "entropy": 0.9742665886878967, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 31.984596252441406, "policy_loss": -0.00017193953681271523, "vf_loss": 31.984766006469727, "vf_explained_var": 8.821487426757812e-06, "kl": 1.4901161193847656e-07, "entropy": 1.4142600297927856, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 672000, "episodes_total": 189, "training_iteration": 24, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-18-58", "timestamp": 1714832338, "time_this_iter_s": 17.91191792488098, "time_total_s": 445.6275351047516, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c9396db00>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 445.6275351047516, "timesteps_since_restore": 672000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 45.38399999999999, "ram_util_percent": 53.2}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 16.05267884079119, "episode_reward_min": -14.757589763750646, "episode_reward_mean": -6.200453269688319, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -15.000159034578333, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 25.811664356002908}, "policy_reward_mean": {"tl": -9.764757563368015, "cav": 10.48324792258733}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9755631585929825, "mean_processing_ms": 0.8808478308803721, "mean_inference_ms": 0.5742620514120034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28769, "num_steps_sampled": 700000, "sample_time_ms": 15776.068, "load_time_ms": 11.234, "grad_time_ms": 2450.274, "update_time_ms": 4.015, "learner": {"tl": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.022111540660262108, "policy_loss": -0.0003173754666931927, "vf_loss": 0.02242891490459442, "vf_explained_var": 0.19394627213478088, "kl": 0.0002014625642914325, "entropy": 0.9714299440383911, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 101.92935943603516, "policy_loss": -0.0001577598013682291, "vf_loss": 101.92951965332031, "vf_explained_var": -5.638599395751953e-05, "kl": 5.549675847760227e-07, "entropy": 1.4136645793914795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 700000, "episodes_total": 197, "training_iteration": 25, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-19-16", "timestamp": 1714832356, "time_this_iter_s": 18.21103310585022, "time_total_s": 463.8385682106018, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 463.8385682106018, "timesteps_since_restore": 700000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.53846153846153, "ram_util_percent": 53.2}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -14.757589763750646, "episode_reward_mean": -6.2662229844750685, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -15.000159034578333}, "policy_reward_max": {"cav": 32.533946229959064, "tl": -5.261582926877203}, "policy_reward_mean": {"cav": 10.705367269549555, "tl": -9.906047856121917}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9709239644298804, "mean_processing_ms": 0.8818436897895503, "mean_inference_ms": 0.5740595230690745}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28788, "num_steps_sampled": 728000, "sample_time_ms": 15787.533, "load_time_ms": 11.008, "grad_time_ms": 2449.253, "update_time_ms": 3.983, "learner": {"tl": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02281535603106022, "policy_loss": 0.00012646560207940638, "vf_loss": 0.022688889876008034, "vf_explained_var": 0.13438357412815094, "kl": 6.18756384938024e-05, "entropy": 0.9662293791770935, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 63.9621696472168, "policy_loss": -0.0003697495849337429, "vf_loss": 63.96254348754883, "vf_explained_var": 3.039836883544922e-05, "kl": 8.909325970307691e-07, "entropy": 1.412534236907959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 728000, "episodes_total": 205, "training_iteration": 26, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-19-34", "timestamp": 1714832374, "time_this_iter_s": 18.281551122665405, "time_total_s": 482.1201193332672, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a213b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 482.1201193332672, "timesteps_since_restore": 728000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 44.573076923076925, "ram_util_percent": 53.21153846153846}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -14.757589763750646, "episode_reward_mean": -6.256226820479002, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.213489170597065, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -9.910107113317348, "cav": 11.418375915119864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9669362044991168, "mean_processing_ms": 0.8826407830908736, "mean_inference_ms": 0.5739634703006157}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28823, "num_steps_sampled": 756000, "sample_time_ms": 15800.676, "load_time_ms": 11.028, "grad_time_ms": 2377.518, "update_time_ms": 3.998, "learner": {"tl": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024134522303938866, "policy_loss": -0.0013872715644538403, "vf_loss": 0.025521794334053993, "vf_explained_var": 0.21777766942977905, "kl": 0.0031269423197954893, "entropy": 0.9587518572807312, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 31.72258949279785, "policy_loss": -0.00047120367526076734, "vf_loss": 31.72305679321289, "vf_explained_var": -1.2636184692382812e-05, "kl": 1.3181141866880353e-06, "entropy": 1.4113147258758545, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 756000, "episodes_total": 213, "training_iteration": 27, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-19-52", "timestamp": 1714832392, "time_this_iter_s": 17.80010461807251, "time_total_s": 499.9202239513397, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c9396ddd0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 499.9202239513397, "timesteps_since_restore": 756000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 46.68076923076922, "ram_util_percent": 53.26153846153845}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -14.757589763750646, "episode_reward_mean": -6.441937172650056, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.213489170597065}, "policy_reward_max": {"cav": 32.533946229959064, "tl": -5.261582926877203}, "policy_reward_mean": {"cav": 10.83852165166867, "tl": -10.0186493177007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.963628588104297, "mean_processing_ms": 0.8834596062968356, "mean_inference_ms": 0.574026115433448}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28858, "num_steps_sampled": 784000, "sample_time_ms": 15848.8, "load_time_ms": 11.042, "grad_time_ms": 2359.207, "update_time_ms": 3.963, "learner": {"tl": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02616460993885994, "policy_loss": -0.00012737431097775698, "vf_loss": 0.0262919832020998, "vf_explained_var": 0.17945396900177002, "kl": 0.00031511703855358064, "entropy": 0.9527016878128052, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 123.1570053100586, "policy_loss": -0.00012455668183974922, "vf_loss": 123.1571273803711, "vf_explained_var": 4.9173831939697266e-05, "kl": 8.668218356433499e-07, "entropy": 1.410517930984497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 784000, "episodes_total": 221, "training_iteration": 28, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-20-11", "timestamp": 1714832411, "time_this_iter_s": 18.355087995529175, "time_total_s": 518.2753119468689, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 518.2753119468689, "timesteps_since_restore": 784000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 47.54615384615384, "ram_util_percent": 53.38461538461539}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -14.757589763750646, "episode_reward_mean": -6.471512480512416, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.213489170597065, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.024515184237744, "cav": 10.766674859773758}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.960747739078402, "mean_processing_ms": 0.884242506883838, "mean_inference_ms": 0.5741524118126676}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28904, "num_steps_sampled": 812000, "sample_time_ms": 15773.03, "load_time_ms": 11.078, "grad_time_ms": 2366.078, "update_time_ms": 3.931, "learner": {"tl": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02435677871108055, "policy_loss": -0.00031765640596859157, "vf_loss": 0.024674437940120697, "vf_explained_var": 0.26962488889694214, "kl": 0.00039171462412923574, "entropy": 0.9503173232078552, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 69.47048950195312, "policy_loss": -3.556842420948669e-05, "vf_loss": 69.47052764892578, "vf_explained_var": -0.00010859966278076172, "kl": 6.349190329046905e-08, "entropy": 1.4101163148880005, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 812000, "episodes_total": 229, "training_iteration": 29, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-20-29", "timestamp": 1714832429, "time_this_iter_s": 18.232643604278564, "time_total_s": 536.5079555511475, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e050>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 536.5079555511475, "timesteps_since_restore": 812000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 45.64999999999999, "ram_util_percent": 53.24615384615385}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -6.516880089701086, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.32791417923493, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.191728265551172, "cav": 11.135903563182113}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.958197209184742, "mean_processing_ms": 0.8849373745100441, "mean_inference_ms": 0.574277651770142}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28935, "num_steps_sampled": 840000, "sample_time_ms": 15743.817, "load_time_ms": 11.114, "grad_time_ms": 2396.826, "update_time_ms": 3.942, "learner": {"tl": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02800729125738144, "policy_loss": 0.0001194326687254943, "vf_loss": 0.0278878603130579, "vf_explained_var": 0.20747193694114685, "kl": 0.000447549537057057, "entropy": 0.9529745578765869, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 87.69735717773438, "policy_loss": -5.6789765949361026e-05, "vf_loss": 87.6974105834961, "vf_explained_var": 5.1915645599365234e-05, "kl": 5.5759183936743284e-08, "entropy": 1.4098777770996094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 840000, "episodes_total": 237, "training_iteration": 30, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-20-47", "timestamp": 1714832447, "time_this_iter_s": 18.25661015510559, "time_total_s": 554.764565706253, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e5f0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 554.764565706253, "timesteps_since_restore": 840000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 44.80384615384616, "ram_util_percent": 53.31538461538462}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -6.375862614390825, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.32791417923493, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.20199572678027, "cav": 11.253332683498414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9555398786542684, "mean_processing_ms": 0.8854572382010517, "mean_inference_ms": 0.5743019728444463}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28981, "num_steps_sampled": 868000, "sample_time_ms": 15721.416, "load_time_ms": 11.177, "grad_time_ms": 2396.634, "update_time_ms": 3.949, "learner": {"tl": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.022582294419407845, "policy_loss": -0.0008324950467795134, "vf_loss": 0.023414790630340576, "vf_explained_var": 0.26793456077575684, "kl": 0.0001118629370466806, "entropy": 0.9444466829299927, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 63.73188400268555, "policy_loss": -7.201277912827209e-05, "vf_loss": 63.731956481933594, "vf_explained_var": 6.496906280517578e-06, "kl": 3.0450198096332315e-07, "entropy": 1.4093849658966064, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 868000, "episodes_total": 245, "training_iteration": 31, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-21-05", "timestamp": 1714832465, "time_this_iter_s": 18.12380290031433, "time_total_s": 572.8883686065674, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 572.8883686065674, "timesteps_since_restore": 868000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 44.35384615384615, "ram_util_percent": 53.361538461538466}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -6.510406493900251, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.32791417923493, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.263494400923653, "cav": 11.37299365764674}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9527578731926525, "mean_processing_ms": 0.885834219710818, "mean_inference_ms": 0.5741841527259612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29004, "num_steps_sampled": 896000, "sample_time_ms": 15718.09, "load_time_ms": 11.176, "grad_time_ms": 2391.769, "update_time_ms": 3.906, "learner": {"tl": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02865704335272312, "policy_loss": 0.00029981383704580367, "vf_loss": 0.02835722640156746, "vf_explained_var": 0.2659446895122528, "kl": 7.287706102943048e-05, "entropy": 0.9434967041015625, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 81.17473602294922, "policy_loss": -9.660099021857604e-05, "vf_loss": 81.17483520507812, "vf_explained_var": 3.0875205993652344e-05, "kl": 2.3064406207140564e-07, "entropy": 1.4088770151138306, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 896000, "episodes_total": 253, "training_iteration": 32, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-21-23", "timestamp": 1714832483, "time_this_iter_s": 17.967446088790894, "time_total_s": 590.8558146953583, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e950>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 590.8558146953583, "timesteps_since_restore": 896000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 44.69230769230769, "ram_util_percent": 53.3423076923077}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -6.631077956441521, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.32791417923493, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.35898934689424, "cav": 11.29670118319011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9501320109541576, "mean_processing_ms": 0.8861701012228563, "mean_inference_ms": 0.5739957974308142}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29060, "num_steps_sampled": 924000, "sample_time_ms": 15724.549, "load_time_ms": 11.206, "grad_time_ms": 2396.236, "update_time_ms": 3.82, "learner": {"tl": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.022733254358172417, "policy_loss": -0.00027523867902345955, "vf_loss": 0.023008495569229126, "vf_explained_var": 0.34907349944114685, "kl": 0.0005764213274233043, "entropy": 0.9405092000961304, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 22.0291748046875, "policy_loss": -0.00010525328980293125, "vf_loss": 22.029279708862305, "vf_explained_var": -4.017353057861328e-05, "kl": 3.0653816907033615e-07, "entropy": 1.4083069562911987, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 924000, "episodes_total": 261, "training_iteration": 33, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-21-42", "timestamp": 1714832502, "time_this_iter_s": 18.30100703239441, "time_total_s": 609.1568217277527, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e7a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 609.1568217277527, "timesteps_since_restore": 924000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 44.48076923076923, "ram_util_percent": 53.31923076923078}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -6.735919336058404, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -16.32791417923493, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.452327483973104, "cav": 10.930612199749195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.947697675880246, "mean_processing_ms": 0.8864438513315112, "mean_inference_ms": 0.5738122049663401}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56964, "num_steps_sampled": 952000, "sample_time_ms": 15717.606, "load_time_ms": 11.009, "grad_time_ms": 2396.47, "update_time_ms": 3.873, "learner": {"tl": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0312251765280962, "policy_loss": -0.0003085716161876917, "vf_loss": 0.03153374791145325, "vf_explained_var": 0.27027013897895813, "kl": 0.0011155776446685195, "entropy": 0.9488099813461304, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 952000, "episodes_total": 269, "training_iteration": 34, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-21-59", "timestamp": 1714832519, "time_this_iter_s": 17.846264600753784, "time_total_s": 627.0030863285065, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9b9f889440>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 627.0030863285065, "timesteps_since_restore": 952000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 45.56400000000001, "ram_util_percent": 53.316}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -7.031372504573973, "episode_len_mean": 3500.0, "episodes_this_iter": 9, "policy_reward_min": {"tl": -16.743771250535918, "cav": 0.0}, "policy_reward_max": {"tl": -5.261582926877203, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.651335761305203, "cav": 10.969585626458377}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9441775623708293, "mean_processing_ms": 0.8867170968645365, "mean_inference_ms": 0.5736206094974718}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57029, "num_steps_sampled": 980000, "sample_time_ms": 15869.416, "load_time_ms": 11.046, "grad_time_ms": 2388.445, "update_time_ms": 3.853, "learner": {"tl": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03328530117869377, "policy_loss": -8.011875615920871e-05, "vf_loss": 0.03336541727185249, "vf_explained_var": 0.3638235926628113, "kl": 0.0005357170011848211, "entropy": 0.9400368928909302, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 28.657501220703125, "policy_loss": 2.0526922526187263e-05, "vf_loss": 28.657480239868164, "vf_explained_var": -1.5139579772949219e-05, "kl": 4.493273308980861e-08, "entropy": 1.4080218076705933, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 980000, "episodes_total": 278, "training_iteration": 35, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-22-19", "timestamp": 1714832539, "time_this_iter_s": 19.650490283966064, "time_total_s": 646.6535766124725, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4eb90>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 646.6535766124725, "timesteps_since_restore": 980000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 42.028571428571425, "ram_util_percent": 53.33928571428572}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -6.99830071127607, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -16.743771250535918}, "policy_reward_max": {"cav": 32.533946229959064, "tl": -6.166925628837678}, "policy_reward_mean": {"cav": 10.810893520534973, "tl": -10.782113443463274}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9423493507801273, "mean_processing_ms": 0.8871390467649656, "mean_inference_ms": 0.5735148310639344}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57035, "num_steps_sampled": 1008000, "sample_time_ms": 15888.107, "load_time_ms": 10.823, "grad_time_ms": 2382.9, "update_time_ms": 3.839, "learner": {"tl": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02892126329243183, "policy_loss": -0.00038871634751558304, "vf_loss": 0.02930998057126999, "vf_explained_var": 0.3684700131416321, "kl": 0.00021333985205274075, "entropy": 0.9363053441047668, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 5.7113356590271, "policy_loss": -0.0018164118519052863, "vf_loss": 5.713151931762695, "vf_explained_var": 5.793571472167969e-05, "kl": 1.9868214167217957e-06, "entropy": 1.4069786071777344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1008000, "episodes_total": 286, "training_iteration": 36, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-22-37", "timestamp": 1714832557, "time_this_iter_s": 18.41174840927124, "time_total_s": 665.0653250217438, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e3b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 665.0653250217438, "timesteps_since_restore": 1008000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 43.6888888888889, "ram_util_percent": 52.948148148148135}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -16.32791417923493, "episode_reward_mean": -7.007990920582895, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -18.769550110287923, "cav": 0.0}, "policy_reward_max": {"tl": -6.166925628837678, "cav": 32.533946229959064}, "policy_reward_mean": {"tl": -10.828029409358212, "cav": 10.611218024375985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9409078429021935, "mean_processing_ms": 0.8875094988134691, "mean_inference_ms": 0.5735132271058285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57150, "num_steps_sampled": 1036000, "sample_time_ms": 15938.719, "load_time_ms": 10.676, "grad_time_ms": 2460.981, "update_time_ms": 3.852, "learner": {"tl": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029175972566008568, "policy_loss": 0.0002980844583362341, "vf_loss": 0.02887788601219654, "vf_explained_var": 0.41433873772621155, "kl": 0.0003997746389359236, "entropy": 0.9335620999336243, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 76.49197387695312, "policy_loss": -3.453959607213619e-06, "vf_loss": 76.49198150634766, "vf_explained_var": 4.4345855712890625e-05, "kl": 1.991313411053852e-06, "entropy": 1.4055720567703247, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1036000, "episodes_total": 294, "training_iteration": 37, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-22-57", "timestamp": 1714832577, "time_this_iter_s": 19.08606266975403, "time_total_s": 684.1513876914978, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e560>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 684.1513876914978, "timesteps_since_restore": 1036000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 46.75925925925926, "ram_util_percent": 53.481481481481495}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 23.328826525388305, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -6.7384453808890665, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.0, "tl": -19.800268011047343}, "policy_reward_max": {"cav": 32.533946229959064, "tl": -6.166925628837678}, "policy_reward_mean": {"cav": 11.491792412919988, "tl": -10.990408573669415}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9396317868114443, "mean_processing_ms": 0.8878502533321699, "mean_inference_ms": 0.5735107346435532}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57164, "num_steps_sampled": 1064000, "sample_time_ms": 15922.424, "load_time_ms": 10.631, "grad_time_ms": 2504.091, "update_time_ms": 3.83, "learner": {"tl": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03706490248441696, "policy_loss": -0.0006625102832913399, "vf_loss": 0.037727415561676025, "vf_explained_var": 0.4526136815547943, "kl": 0.0003074182022828609, "entropy": 0.9450764060020447, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 27.288707733154297, "policy_loss": -0.0002579007705207914, "vf_loss": 27.288965225219727, "vf_explained_var": 3.7610530853271484e-05, "kl": 7.195131956905243e-07, "entropy": 1.404740571975708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1064000, "episodes_total": 302, "training_iteration": 38, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-23-15", "timestamp": 1714832595, "time_this_iter_s": 18.621931076049805, "time_total_s": 702.7733187675476, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9b9f7a7950>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 702.7733187675476, "timesteps_since_restore": 1064000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 44.357692307692304, "ram_util_percent": 53.830769230769235}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 21.538324765013908, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -7.010679572948003, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -19.800268011047343, "cav": 0.0}, "policy_reward_max": {"tl": -6.166925628837678, "cav": 30.440026213529844}, "policy_reward_mean": {"tl": -11.046752706068764, "cav": 10.621245087160002}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.938389668513099, "mean_processing_ms": 0.888148830956155, "mean_inference_ms": 0.5734629888778046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57210, "num_steps_sampled": 1092000, "sample_time_ms": 15891.597, "load_time_ms": 10.6, "grad_time_ms": 2522.659, "update_time_ms": 3.836, "learner": {"tl": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029069332405924797, "policy_loss": -0.00031838941504247487, "vf_loss": 0.02938772365450859, "vf_explained_var": 0.4775201082229614, "kl": 0.00033453720971010625, "entropy": 0.9375180602073669, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 31.594850540161133, "policy_loss": 7.774518962833099e-06, "vf_loss": 31.594846725463867, "vf_explained_var": 1.1265277862548828e-05, "kl": 2.0732049677008035e-07, "entropy": 1.4043434858322144, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1092000, "episodes_total": 310, "training_iteration": 39, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-23-33", "timestamp": 1714832613, "time_this_iter_s": 18.106094121932983, "time_total_s": 720.8794128894806, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e200>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 720.8794128894806, "timesteps_since_restore": 1092000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 44.34615384615384, "ram_util_percent": 53.77307692307692}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 21.538324765013908, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -7.041378269199137, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -19.800268011047343, "cav": 0.9070951407804436}, "policy_reward_max": {"tl": -6.166925628837678, "cav": 30.440026213529844}, "policy_reward_mean": {"tl": -11.035569865818188, "cav": 10.795112423294848}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9369944125440823, "mean_processing_ms": 0.8883906303066966, "mean_inference_ms": 0.5733334442253611}, "off_policy_estimator": {}, "info": {"num_steps_trained": 85114, "num_steps_sampled": 1120000, "sample_time_ms": 15907.735, "load_time_ms": 10.574, "grad_time_ms": 2524.445, "update_time_ms": 3.83, "learner": {"tl": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02613208070397377, "policy_loss": -0.0001367567019769922, "vf_loss": 0.026268836110830307, "vf_explained_var": 0.3819985091686249, "kl": 0.00014650462253484875, "entropy": 0.9357369542121887, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1120000, "episodes_total": 318, "training_iteration": 40, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-23-52", "timestamp": 1714832632, "time_this_iter_s": 18.43800926208496, "time_total_s": 739.3174221515656, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9b9f8897a0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 739.3174221515656, "timesteps_since_restore": 1120000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 43.06666666666666, "ram_util_percent": 53.822222222222216}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -6.743925690038126, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -19.800268011047343, "cav": 0.9070951407804436}, "policy_reward_max": {"tl": -7.035052157165356, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -11.06704038291337, "cav": 11.684093764527756}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9355321515346007, "mean_processing_ms": 0.8885297193622648, "mean_inference_ms": 0.5731440113171254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 85216, "num_steps_sampled": 1148000, "sample_time_ms": 15913.837, "load_time_ms": 10.54, "grad_time_ms": 2521.95, "update_time_ms": 3.846, "learner": {"tl": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026949692517518997, "policy_loss": -0.00016067663091234863, "vf_loss": 0.027110368013381958, "vf_explained_var": 0.4753744900226593, "kl": 0.00034731742925941944, "entropy": 0.9355775117874146, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 112.81145477294922, "policy_loss": -0.00016409509407822043, "vf_loss": 112.8116226196289, "vf_explained_var": -0.0001544952392578125, "kl": 2.203034483727606e-07, "entropy": 1.4042357206344604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1148000, "episodes_total": 326, "training_iteration": 41, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-24-10", "timestamp": 1714832650, "time_this_iter_s": 18.1613986492157, "time_total_s": 757.4788208007812, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a219e0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 757.4788208007812, "timesteps_since_restore": 1148000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 44.276923076923076, "ram_util_percent": 53.88461538461539}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -6.759295808211553, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.9070951407804436, "tl": -19.800268011047343}, "policy_reward_max": {"cav": 40.805609949168606, "tl": -7.035052157165356}, "policy_reward_mean": {"cav": 11.231095076810401, "tl": -11.027111937399484}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.934099216869613, "mean_processing_ms": 0.8886563011369815, "mean_inference_ms": 0.5729454196764603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113120, "num_steps_sampled": 1176000, "sample_time_ms": 15934.519, "load_time_ms": 10.47, "grad_time_ms": 2533.677, "update_time_ms": 3.849, "learner": {"tl": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029469165951013565, "policy_loss": -0.00031429692171514034, "vf_loss": 0.02978346310555935, "vf_explained_var": 0.4163503646850586, "kl": 0.0013865906512364745, "entropy": 0.9351667165756226, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1176000, "episodes_total": 334, "training_iteration": 42, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-24-28", "timestamp": 1714832668, "time_this_iter_s": 18.291778326034546, "time_total_s": 775.7705991268158, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93981b90>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 775.7705991268158, "timesteps_since_restore": 1176000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 44.36153846153846, "ram_util_percent": 53.911538461538456}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -6.82166343115779, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -19.800268011047343, "cav": 0.9070951407804436}, "policy_reward_max": {"tl": -7.035052157165356, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -11.037389552048717, "cav": 11.094016107607763}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.932769806071489, "mean_processing_ms": 0.8887577871498606, "mean_inference_ms": 0.5727713435522872}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113177, "num_steps_sampled": 1204000, "sample_time_ms": 15944.014, "load_time_ms": 10.872, "grad_time_ms": 2513.039, "update_time_ms": 3.885, "learner": {"tl": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025222280994057655, "policy_loss": -4.9471309466753155e-05, "vf_loss": 0.02527175284922123, "vf_explained_var": 0.5032198429107666, "kl": 0.0005132564110681415, "entropy": 0.9343477487564087, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 47.792030334472656, "policy_loss": -2.773184633042547e-06, "vf_loss": 47.79203414916992, "vf_explained_var": -3.254413604736328e-05, "kl": 1.1188942039552785e-07, "entropy": 1.4036569595336914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1204000, "episodes_total": 342, "training_iteration": 43, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-24-46", "timestamp": 1714832686, "time_this_iter_s": 18.193487644195557, "time_total_s": 793.9640867710114, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9b9f7b9b90>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 793.9640867710114, "timesteps_since_restore": 1204000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 44.51923076923076, "ram_util_percent": 53.9076923076923}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -19.800268011047343, "episode_reward_mean": -7.049111491470233, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -19.800268011047343, "cav": 0.9070951407804436}, "policy_reward_max": {"tl": -6.445355539522498, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -11.020684118530273, "cav": 10.733980073135305}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9316738554299038, "mean_processing_ms": 0.888889497958572, "mean_inference_ms": 0.5726158737191063}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113249, "num_steps_sampled": 1232000, "sample_time_ms": 16023.407, "load_time_ms": 10.902, "grad_time_ms": 2519.884, "update_time_ms": 3.87, "learner": {"tl": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03653010353446007, "policy_loss": 0.00036874605575576425, "vf_loss": 0.036161355674266815, "vf_explained_var": 0.5362813472747803, "kl": 8.862055256031454e-05, "entropy": 0.9354455471038818, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 91.14187622070312, "policy_loss": -5.285110819386318e-05, "vf_loss": 91.14193725585938, "vf_explained_var": 4.0531158447265625e-05, "kl": 1.5480651427424164e-07, "entropy": 1.403343915939331, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1232000, "episodes_total": 350, "training_iteration": 44, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-25-05", "timestamp": 1714832705, "time_this_iter_s": 18.704800128936768, "time_total_s": 812.6688868999481, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c939813b0>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 812.6688868999481, "timesteps_since_restore": 1232000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 46.77692307692309, "ram_util_percent": 53.89999999999999}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -6.795509964645914, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -20.03743465426954, "cav": 0.8987204756813015}, "policy_reward_max": {"tl": -6.150134981213541, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -11.04431850538812, "cav": 11.181075107216401}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9307765519027953, "mean_processing_ms": 0.8890246179405565, "mean_inference_ms": 0.5725270799664528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113268, "num_steps_sampled": 1260000, "sample_time_ms": 15908.101, "load_time_ms": 10.876, "grad_time_ms": 2509.559, "update_time_ms": 3.874, "learner": {"tl": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024238700047135353, "policy_loss": -0.0008009240264073014, "vf_loss": 0.02503962256014347, "vf_explained_var": 0.4765854477882385, "kl": 0.0009207595721818507, "entropy": 0.9287687540054321, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 18.082059860229492, "policy_loss": 1.1792308214353397e-05, "vf_loss": 18.082048416137695, "vf_explained_var": -8.738040924072266e-05, "kl": -6.274173180997877e-09, "entropy": 1.4030624628067017, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1260000, "episodes_total": 358, "training_iteration": 45, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-25-24", "timestamp": 1714832724, "time_this_iter_s": 18.394376039505005, "time_total_s": 831.0632629394531, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93a4e290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 831.0632629394531, "timesteps_since_restore": 1260000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 46.67777777777778, "ram_util_percent": 53.214814814814815}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -7.046016092927866, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -20.03743465426954, "cav": 0.8987204756813015}, "policy_reward_max": {"tl": -6.150134981213541, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -11.107108283729826, "cav": 11.280811641116657}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9300882533225856, "mean_processing_ms": 0.8891983575667015, "mean_inference_ms": 0.572507587640241}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141172, "num_steps_sampled": 1288000, "sample_time_ms": 15934.146, "load_time_ms": 10.78, "grad_time_ms": 2445.454, "update_time_ms": 3.988, "learner": {"tl": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025395769625902176, "policy_loss": -0.0003765597357414663, "vf_loss": 0.025772329419851303, "vf_explained_var": 0.4757736325263977, "kl": 0.0005099038244225085, "entropy": 0.9258415699005127, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1288000, "episodes_total": 366, "training_iteration": 46, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-25-42", "timestamp": 1714832742, "time_this_iter_s": 18.03161072731018, "time_total_s": 849.0948736667633, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93981830>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 849.0948736667633, "timesteps_since_restore": 1288000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 48.052, "ram_util_percent": 53.2}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -6.739637078423474, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -20.03743465426954, "cav": 0.8987204756813015}, "policy_reward_max": {"tl": -6.150134981213541, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -10.903649499237572, "cav": 11.566701168928136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.929502230454783, "mean_processing_ms": 0.8893143500611973, "mean_inference_ms": 0.5725210877632975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141248, "num_steps_sampled": 1316000, "sample_time_ms": 15890.478, "load_time_ms": 10.933, "grad_time_ms": 2426.521, "update_time_ms": 3.987, "learner": {"tl": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03420257195830345, "policy_loss": -0.0005594100803136826, "vf_loss": 0.03476198390126228, "vf_explained_var": 0.5243011713027954, "kl": 0.0001819359022192657, "entropy": 0.9226231575012207, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 47.64594650268555, "policy_loss": -1.5567791706416756e-05, "vf_loss": 47.64596176147461, "vf_explained_var": -4.649162292480469e-06, "kl": -3.9213582381236733e-10, "entropy": 1.4030357599258423, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1316000, "episodes_total": 374, "training_iteration": 47, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-26-00", "timestamp": 1714832760, "time_this_iter_s": 18.459892511367798, "time_total_s": 867.5547661781311, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93912320>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 867.5547661781311, "timesteps_since_restore": 1316000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 44.662962962962965, "ram_util_percent": 53.29999999999999}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -6.593164173775379, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"cav": 0.8987204756813015, "tl": -20.03743465426954}, "policy_reward_max": {"cav": 40.805609949168606, "tl": -6.150134981213541}, "policy_reward_mean": {"cav": 11.95794109574616, "tl": -10.778443557286504}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.930116660555932, "mean_processing_ms": 0.8895706735657256, "mean_inference_ms": 0.5726043406813004}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169152, "num_steps_sampled": 1344000, "sample_time_ms": 15897.05, "load_time_ms": 11.223, "grad_time_ms": 2393.408, "update_time_ms": 3.97, "learner": {"tl": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02744900807738304, "policy_loss": -0.00019549558055587113, "vf_loss": 0.027644505724310875, "vf_explained_var": 0.5375890731811523, "kl": 0.00033232232090085745, "entropy": 0.9142037630081177, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1344000, "episodes_total": 382, "training_iteration": 48, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-26-19", "timestamp": 1714832779, "time_this_iter_s": 18.360938549041748, "time_total_s": 885.9157047271729, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c9391d170>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 885.9157047271729, "timesteps_since_restore": 1344000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 46.01538461538462, "ram_util_percent": 53.21153846153846}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -6.67791526883602, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -20.03743465426954, "cav": 0.8987204756813015}, "policy_reward_max": {"tl": -6.150134981213541, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -10.711864957155226, "cav": 12.224089964603726}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9296371160471684, "mean_processing_ms": 0.8895990164301507, "mean_inference_ms": 0.5726833225183929}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169230, "num_steps_sampled": 1372000, "sample_time_ms": 15959.914, "load_time_ms": 11.258, "grad_time_ms": 2368.674, "update_time_ms": 3.919, "learner": {"tl": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02971452660858631, "policy_loss": -0.00046766625018790364, "vf_loss": 0.03018219582736492, "vf_explained_var": 0.6048681735992432, "kl": 0.0003082164330407977, "entropy": 0.9118133187294006, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 105.4129638671875, "policy_loss": -3.7917725421721116e-05, "vf_loss": 105.41300964355469, "vf_explained_var": 3.427267074584961e-05, "kl": 3.094856637630983e-08, "entropy": 1.403289794921875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1372000, "episodes_total": 390, "training_iteration": 49, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-26-37", "timestamp": 1714832797, "time_this_iter_s": 18.487347841262817, "time_total_s": 904.4030525684357, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9b9f888680>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 904.4030525684357, "timesteps_since_restore": 1372000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 47.41153846153846, "ram_util_percent": 53.25384615384616}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -6.475318305757663, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -20.03743465426954, "cav": 0.0}, "policy_reward_max": {"tl": -6.150134981213541, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -10.773753502610063, "cav": 13.025561202583132}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.929182412306019, "mean_processing_ms": 0.8896966616886504, "mean_inference_ms": 0.572768441148994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169262, "num_steps_sampled": 1400000, "sample_time_ms": 15990.347, "load_time_ms": 11.279, "grad_time_ms": 2340.229, "update_time_ms": 3.94, "learner": {"tl": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03407054394483566, "policy_loss": -0.0004243970906827599, "vf_loss": 0.03449494019150734, "vf_explained_var": 0.6226751804351807, "kl": 0.00021635391749441624, "entropy": 0.9121429920196533, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 61.68555450439453, "policy_loss": -3.742799162864685e-05, "vf_loss": 61.68558883666992, "vf_explained_var": 0.00011831521987915039, "kl": 1.434236764907837e-07, "entropy": 1.4036250114440918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1400000, "episodes_total": 398, "training_iteration": 50, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-26-55", "timestamp": 1714832815, "time_this_iter_s": 18.4557101726532, "time_total_s": 922.8587627410889, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c9391d290>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 922.8587627410889, "timesteps_since_restore": 1400000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 45.155555555555566, "ram_util_percent": 53.614814814814814}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
{"episode_reward_max": 30.679966754883857, "episode_reward_min": -20.03743465426954, "episode_reward_mean": -7.063529799546537, "episode_len_mean": 3500.0, "episodes_this_iter": 8, "policy_reward_min": {"tl": -20.03743465426954, "cav": 0.0}, "policy_reward_max": {"tl": -6.150134981213541, "cav": 40.805609949168606}, "policy_reward_mean": {"tl": -10.960378653242977, "cav": 12.17765266780144}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.92883924384598, "mean_processing_ms": 0.8897806408678116, "mean_inference_ms": 0.5728973042261496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169310, "num_steps_sampled": 1428000, "sample_time_ms": 16018.46, "load_time_ms": 11.283, "grad_time_ms": 2330.794, "update_time_ms": 3.953, "learner": {"tl": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.037138570100069046, "policy_loss": -0.0005887841107323766, "vf_loss": 0.03772735968232155, "vf_explained_var": 0.6743124723434448, "kl": 0.0010731830261647701, "entropy": 0.9127271175384521, "entropy_coeff": 0.0}, "cav": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 37.4196891784668, "policy_loss": -9.278456673200708e-06, "vf_loss": 37.41969680786133, "vf_explained_var": -3.814697265625e-06, "kl": 3.104408463627806e-08, "entropy": 1.4035910367965698, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 28000, "done": false, "timesteps_total": 1428000, "episodes_total": 406, "training_iteration": 51, "experiment_id": "d6a61fb5d01c449cb2f1679016d45dea", "date": "2024-05-04_22-27-14", "timestamp": 1714832834, "time_this_iter_s": 18.346380472183228, "time_total_s": 941.2051432132721, "pid": 182113, "hostname": "g-System-Product-Name", "node_ip": "127.0.1.1", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 28000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [3, 3], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": true,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"n_cavs\": 1,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3.0,\n            \"target_velocity\": 30,\n            \"tl_type\": \"controlled\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 500\n    },\n    \"env_name\": \"flow.envs.multiagent.coopenv.CustomSEUPressEnv\",\n    \"exp_tag\": \"grid_0_1x1_i200_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 1,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 500,\n                \"long_length\": 700,\n                \"row_num\": 1,\n                \"short_length\": 500\n            },\n            \"horizontal_lanes\": 3,\n            \"speed_limit\": {\n                \"horizontal\": 30,\n                \"vertical\": 30\n            },\n            \"traffic_lights\": true,\n            \"vertical_lanes\": 3\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.SingleIntersectionNet\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"data\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRecycleRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 1\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ExpTravelTimeRouter\",\n                {}\n            ],\n            \"veh_id\": \"cav\"\n        }\n    ]\n}", "run": "PPO"}, "env": "CustomSEUPressEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"cav": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(6,)", "Box(1,)", {}], "tl": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(68,)", "Discrete(4)", {}]}, "policy_mapping_fn": "<function setup_exps.<locals>.<lambda> at 0x7f9c93981830>", "policies_to_train": ["cav", "tl"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 100, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 941.2051432132721, "timesteps_since_restore": 1428000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 45.68076923076923, "ram_util_percent": 52.80384615384616}, "num_healthy_workers": 8, "trial_id": "307034ce", "experiment_tag": "0"}
